(window.webpackChunk=window.webpackChunk||[]).push([[721],{39318:(e,t,i)=>{var s=i(66020),a="chrome-extension://__MSG_@@extension_id__/",n="moz-extension://__MSG_@@extension_id__/",r=window.GR_RESOURCE_ROOT||a,o=window.GR_RESOURCE_ROOT||n;e.exports={__css:s.toString().replace(new RegExp(a,"g"),r).replace(new RegExp(n,"g"),o),...s.locals}},26479:(e,t,i)=>{var s=i(66740),a="chrome-extension://__MSG_@@extension_id__/",n="moz-extension://__MSG_@@extension_id__/",r=window.GR_RESOURCE_ROOT||a,o=window.GR_RESOURCE_ROOT||n;e.exports={__css:s.toString().replace(new RegExp(a,"g"),r).replace(new RegExp(n,"g"),o),...s.locals}},83765:(e,t,i)=>{var s=i(55271),a="chrome-extension://__MSG_@@extension_id__/",n="moz-extension://__MSG_@@extension_id__/",r=window.GR_RESOURCE_ROOT||a,o=window.GR_RESOURCE_ROOT||n;e.exports={__css:s.toString().replace(new RegExp(a,"g"),r).replace(new RegExp(n,"g"),o),...s.locals}},65669:(e,t,i)=>{var s=i(20532),a="chrome-extension://__MSG_@@extension_id__/",n="moz-extension://__MSG_@@extension_id__/",r=window.GR_RESOURCE_ROOT||a,o=window.GR_RESOURCE_ROOT||n;e.exports={__css:s.toString().replace(new RegExp(a,"g"),r).replace(new RegExp(n,"g"),o),...s.locals}},20271:(e,t,i)=>{"use strict";i.d(t,{O:()=>s,I:()=>c});var s,a=i(27378),n=i(79844),r=i(57175),o=i(87088),l=i(35407);!function(e){e.Context=a.createContext(r.S.invariantContent("AssistantTextResources")),e.holder=o.VF((()=>({setGoalsTooltip:"Set goals to get tailored writing suggestions",proofitTooltip:"Expert writing help"})))}(s||(s={}));const c=l.Pj(l.GG({denali:n.m.holder,assistant:s.holder}))((()=>({denali:{}})))},76829:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AssistantController:()=>cr,AssistantControllerInjectedParams:()=>s.AssistantControllerInjectedParams,AssistantService:()=>Yr,AssistantServiceInjectedParams:()=>a.AssistantServiceInjectedParams,LocalAssistantHighlightCollection:()=>r,getAssistantRPCClient:()=>Qr});var s={};i.r(s),i.d(s,{e:()=>cr});var a={};i.r(a),i.d(a,{e:()=>Yr});var n=i(41186);class r{constructor(e,t){this._textObserver=e,this._highlights=t}addHighlight(e,t,i){return this._highlights.addHighlight(e,t,this._textObserver.getCurrentTextMap(),i)}updateHighlight(e,t,i){return this._highlights.updateHighlight(e,t,this._textObserver.getCurrentTextMap(),i)}removeHighlight(e){return this._highlights.removeHighlight(e)}recalculateHighlight(e){return this._highlights.recalculateHighlight(e)}recalculateAllHighlights(){return this._highlights.recalculateAllHighlights()}maintainConsistency(e,t=(e=>e),i=!1){return this._highlights.maintainConsistency(e,this._textObserver.getCurrentTextMap(),t,i)}hasHighlight(e){return this._highlights.hasHighlight(e)}getSelectedHighlightsTracker(e){return(0,n.H)({...e,highlights:this._highlights,textObserver:this._textObserver})}getGeometryByAlertId(e){return this._highlights.geometry.get().get(e)}}var o=i(73805),l=i(27378),c=i(32952),d=i(76974),p=i(49708),u=i(66310),h=i(93508),m=i(41398),g=i(77176),f=i(2768),v=i(2834),_=i(16118),w=i(85985),y=i(74850),E=i(46861),C=i(79921),S=i(19217);const b=({message:e,emoji:t,icon:i})=>l.createElement("div",{className:S.insight},t&&l.createElement("div",{className:S.insight__inline_icon},l.createElement(C.dy,{unicodeHexArray:null,unicodeLiteral:t})),i&&l.createElement("div",{className:S.insight__inline_icon},i),l.createElement("div",{className:S.insight__inline_text},e));var k=i(53112);const x=()=>l.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:k.Z.green50}),l.createElement("path",{d:"M5.03033 8.46967C4.73744 8.17678 4.26256 8.17678 3.96967 8.46967C3.67678 8.76256 3.67678 9.23744 3.96967 9.53033L5.03033 8.46967ZM7 11.5L6.46967 12.0303L7 12.5607L7.53033 12.0303L7 11.5ZM13.0303 6.53033C13.3232 6.23744 13.3232 5.76256 13.0303 5.46967C12.7374 5.17678 12.2626 5.17678 11.9697 5.46967L13.0303 6.53033ZM3.96967 9.53033L6.46967 12.0303L7.53033 10.9697L5.03033 8.46967L3.96967 9.53033ZM7.53033 12.0303L13.0303 6.53033L11.9697 5.46967L6.46967 10.9697L7.53033 12.0303Z",fill:k.Z.neutral0})),M=()=>l.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:k.Z.red50}),l.createElement("path",{d:"M8.94827 4H7.05196L7.22242 10.1108H8.78208L8.94827 4ZM8.00225 12.8381C8.5477 12.8381 9.02071 12.3821 9.02498 11.8153C9.02071 11.2571 8.5477 10.8011 8.00225 10.8011C7.43975 10.8011 6.97526 11.2571 6.97952 11.8153C6.97526 12.3821 7.43975 12.8381 8.00225 12.8381Z",fill:k.Z.neutral0}));var A,L=i(67584),R=i(88326),I=i(45836),T=i(51465),V=i(18208),F=i(42726),P=i(98029);!function(e){e.hidden="hidden",e.zero="zero",e.visible="visible"}(A||(A={}));const O=({predictionsVM:e})=>T.UI.mount(Z,e.previewFlow),H=T.UI.Grid.make((({slots:e})=>l.createElement("div",{className:P.predictions},l.createElement("div",{className:P.predictions__header},"Predictions"),e.children))),N=({children:e,count:t,countFormatter:i=(e=>String(e)),dataPartGrammarly:s})=>l.createElement(F.F.div,{className:P.predictions__card,"data-grammarly-part":s},e,t>0&&l.createElement("div",{className:P.counterContainer},l.createElement(I.CL,null,i(t)))),U=T.UI.Node.make((({state:e,notify:t})=>l.createElement(R.M,{clickHandler:t("select")},l.createElement(F.F.Fragment,null,e.pipe(g.U((e=>l.createElement(N,{count:e.alertsCount,countFormatter:e=>`+${e} more`,dataPartGrammarly:"emogenie-prediction-card"},l.createElement(b,{key:"tone",message:"Sounds "+e.emotion.name,emoji:e.emotion.emoji}),e.brandToneOffImageUrl?l.createElement("div",{className:P.predictions__emogenie_pulsing},l.createElement(L.e,{pulsing:F.hg.create(!0)})):null)))))))),D=T.UI.Node.make((({state:e,notify:t})=>l.createElement(R.M,{clickHandler:t("select")},l.createElement(F.F.Fragment,null,e.pipe(g.U((e=>l.createElement(N,{count:e.alertsCount,dataPartGrammarly:"readers-attention-prediction-card"},l.createElement(b,{key:"readersAttention",message:V.kC(e.message),icon:e.easyToRead?l.createElement(x,null):l.createElement(M,null)}))))))))),B=T.UI.Group.make({tone:q(U),readersAttention:q(D)}),Z=T.UI.Union.make("kind",{[A.hidden]:T.UI.Node.empty,[A.zero]:T.UI.Node.empty,[A.visible]:T.UI.Composite.make(H,B)});function q(e){return{tag:"_tag",members:{Some:(0,o.pipe)(e,T.UI.contramapState((e=>e.value))),None:T.UI.Node.empty}}}var G,z=i(89881),K=i(62712),W=i(38524),j=i(55415);!function(e){function t(e,t,i){return W.nL.Items.mapper((e=>e.kind),{[z.h.alertCard]:e,[z.h.priorityToggle]:t,[z.h.bulkAccept]:i})}e.checksFeedItemsMapper=t,e.viewState=function(){return({isLastCard:e})=>t((t=>({view:t,isLastCard:e,kind:"alertCard"})),(e=>({view:e,kind:"priorityToggle"})),(e=>({view:e,kind:"bulkAccept"})))},e.changePosition=function(e){return i=>t((t=>e.changePosition(t,i)),(e=>j.Vx(e,{positionState:i})),(e=>K.J.changePosition(e)(i)))}}(G||(G={}));var X=i(32275),Y=i(67521),Q=i(42688),$=i(24713),J=i(16782),ee=i(95300),te=i(2844),ie=i(28043),se=i(55721),ae=i(39719),ne=i(67434),re=i(38194),oe=i(51655),le=i(29758),ce=i(90361);const de={translate:{x:0,y:0},lastTranslate:{x:0,y:0},dragging:!1,dragStart:!1,dragEnd:!1};function pe(e,t){const i=l.useRef(null),s=l.useRef(new ee.X(null)),a=l.useRef((0,te.aj)(e,s.current,((e,t)=>i=>t&&e?function(e,t,i){const s=function(e,t){if(e.width>t.width||e.height>t.height)return e;const i=e.left<t.left?t.left:e.left+e.width>t.left+t.width?t.left+t.width-e.width:e.left,s=e.top<t.top?t.top:e.top+e.height>t.top+t.height?t.top+t.height-e.height:e.top;return{...e,left:i,top:s}}({left:t.left+e.x,top:t.top+e.y,width:t.width,height:t.height},i);return{x:s.left-t.left,y:s.top-t.top}}(i,t,e):i))),[n,r]=function(e=(0,d.of)((e=>e))){const t=l.useRef(new J.t(1)),i=l.useRef(t.current.pipe((0,w.h)(ce.fQ),(0,ie.x)(),(0,u.w)((t=>(0,p.R)(t,"mousedown").pipe((0,w.h)((e=>!e.button)),(0,v.b)((e=>e.preventDefault())),(0,g.U)((e=>({element:t,startPos:{x:e.clientX,y:e.clientY}}))),(0,u.w)((t=>(0,p.R)((0,oe.Jj)(t.element),"mousemove").pipe((0,f.R)((0,p.R)((0,oe.Jj)(t.element),"mouseup")),(0,se.p)(10),(0,g.U)((({clientX:e,clientY:i})=>({...t,delta:{x:e-t.startPos.x,y:i-t.startPos.y}}))),(0,m.M)(e),(0,g.U)((([e,t])=>({...e,delta:t(e.delta)}))),(0,ae.l)("dragDone"))))))),(0,ne.R)(((e,t)=>{if("dragDone"===t)return{...e,dragging:!1,lastTranslate:e.translate,dragStart:!1,dragEnd:e.dragging};{const{x:i,y:s}=t.delta;return{...e,dragging:!0,dragStart:!e.dragging,dragEnd:!1,translate:{x:i+e.lastTranslate.x,y:s+e.lastTranslate.y}}}}),{...de}),(0,re.B)())),s=l.useCallback((e=>t.current.next(e)),[t.current]);return[i.current,s]}(a.current);(0,Y.A)(n.pipe((0,w.h)((e=>e.dragStart)),(0,v.b)((()=>o())))),l.useEffect((()=>{var e;return t.current&&(null===(e=i.current)||void 0===e||e.disconnect(),i.current=le.N.getResizeObserver(o),i.current.observe(t.current)),()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.disconnect()}}),[t.current]);const o=()=>{t.current&&s.current.next(t.current.getBoundingClientRect())};return[n,r]}const ue=l.createContext({state:d.of(de),onMount:()=>{}}),he=l.forwardRef((({children:e,hasDragHandle:t,bounds:i},s)=>{const a=l.useRef(null),n=(0,X.K)(i),[r,o]=pe(n,a),[c,d]=l.useState(de),p=l.useRef({state:r,onMount:o});(0,Y.A)(r.pipe((0,v.b)(d)));const u={ref:(0,Q.l)([s,a,...(0,Q.O)(e)?[e.ref]:[]],t?void 0:o)};return l.createElement(ue.Provider,{value:p.current},l.cloneElement(e(c),u))}));function me(){const e=l.useContext(ue).state,[t,i]=l.useState(de);return(0,Y.A)(e.pipe((0,v.b)((e=>i(e))))),t}var ge=i(35439),fe=i(81766),ve=i(66265),_e=i(16528),we=i(52479),ye=i(99391),Ee=i(24209),Ce=i(18625),Se=i(40151),be=i(95093),ke=i(17343),xe=i(32917),Me=i(71517),Ae=i(13338),Le=i(90600),Re=i(19962),Ie=i(64909),Te=i(92932),Ve=i(47476);const Fe=T.UI.Grid.make((({slots:e,view:t})=>l.createElement(F.F.div,{className:t("isBundle").pipe(g.U((e=>e?Ve.bundleCardWrapper:Ve.cardWrapper)))},e.children))),Pe=l.forwardRef((({state:e,cardsViewModel:t,cardsListScrollManager:i,connectorElements:s,header:a,footer:n,cardsListFlow:r},p)=>{const u=e.view(W.nL.Prism.getLens()),m=(0,o.pipe)(ge.A.CardList(t.actionEvents),T.UI.patch("content","cell","item")((e=>(0,o.pipe)(T.UI.Knot.make(Fe,{children:e.child}),T.UI.squash,T.UI.contramapState((e=>({children:e,root:{isBundle:"alertCard"===e.kind&&Ie.isSome(e.view.meta.bundleInfo)}}))))))),g=r||(0,fe._F)(t,u,new c.xQ,xe.i$(i).pipe(h.O(!1)),G.viewState()),f=l.useContext(ue).state;return l.createElement(Le.d,{className:d.of(""),name:"cardlist",stateSyncListener:He(i,s,f),height:Oe(e,i),isMaster:!0},l.createElement(l.Fragment,null,a?l.createElement(F.F.div,{className:Ve.cardWrapper,mount:e=>s.lens("title").set(Ie.fromNullable(e))},a):null,l.createElement("div",{ref:p},T.UI.mount(m,g)),n?l.createElement(F.F.div,{className:Ve.cardWrapper},n):null))})),Oe=(e,t)=>{const i=(0,Ae.Sd)(e.view(W.nL.mapper((({currentLens:e,alertSource:t})=>Ie.some({currentLens:e,alertSource:t})))));return te.aj([i.pipe(ve.oA,g.U((({currentLens:e})=>e.cardsHeight)),h.O(0)),t.paddingTop]).pipe(g.U((([e,t])=>e+t)))},He=(e,t,i)=>{const s=Te.C8.Logging.getLogger("view_models");return Ee.T(Ce.P((()=>{e.paddingTop.set(0)})),t.view("viewport").pipe(u.w(Ie.fold(Se.c,(e=>_e.YC(e).pipe(v.b((()=>s.debug("update card list viewport due to viewport resize event"))),be.T(i.pipe($.j("dragging"),w.h((e=>!e)),u.w(we.b2.rafScheduler),v.b((()=>s.debug("update card list viewport due to drag end event"))))),g.U((()=>e.getBoundingClientRect())),g.U((e=>({top:Me.r.FromWindowTop.ISO.wrap(e.top),height:e.height}))))))),v.b(we.wW(e.viewport))),t.view("scrollProvider").pipe(u.w(Ie.fold(Se.c,(t=>p.R(t,"scroll").pipe(g.U((()=>t.scrollTop)),h.O(t.scrollTop),v.b(we.wW(e.scrollTop)),ke.h(we.PU)))))),t.view("title").pipe(u.w(Ie.fold((()=>d.of(Re.UL.empty)),(e=>_e.YC(e)))),g.U((e=>e.height)),ye.shareReplay({bufferSize:1,refCount:!0}),v.b(we.wW(e.paddingTop))),t.view("scrollConsumer").pipe(u.w(Ie.fold(Se.c,(t=>e.scrollOffset.pipe(v.b((e=>{t.scrollTop+=e})))))))).pipe(ke.h(void 0))};var Ne,Ue=i(45980),De=i(65421),Be=i(39354),Ze=i(10002),qe=i(17753),Ge=i(69551),ze=i(76779),Ke=i(8125),We=i(95574),je=i(65772);!function(e){let t;!function(e){e.gdocsSidebarCardList="gdocsSidebarCardList",e.gdocsSidebarSuccessView="gdocsSidebarSuccessView",e.gdocsGoals="gdocsGoals",e.assistantCardList="assistantCardList",e.extensionSettingsAssistant="extensionSettingsAssistant"}(t=e.Place||(e.Place={}))}(Ne||(Ne={}));class Xe{constructor(e,t,i){this._alertsList=e,this._lensPreviewVM=t,this._maxAlertCategories=i,this._log=Te.C8.Logging.getLogger("UpgradeViewModel"),this.advancedAlerts=this._lensPreviewVM.getLens(Ze.R.SpecialId.Premium).view("count").view((e=>e>0?(0,o.pipe)(Ie.some({count:e,alerts:()=>this._formatLiteAlerts(this.getAdvancedGroupedLiteAlerts())})):Ie.none)),this._formatLiteAlerts=e=>{const t=e.slice(0,this._maxAlertCategories),i=e.slice(this._maxAlertCategories).map((e=>e.count)).reduce(Ke.Sm,0);return i>0?[...t,{group:"",category:"",categoryHuman:"more...",count:i}]:t},this.getAdvancedGroupedLiteAlerts=()=>this._getGroupedLiteAlerts(qe.bZ.isPremium),this._getAdvancedLiteAlerts=()=>(0,o.pipe)(this._alertsList.state.get(),ze.p.reduce([],((e,{alert:t})=>(qe.bZ.isRegistered(t)&&e.push(t),e)))).filter(qe.bZ.isPremium).map((e=>(0,De.fe)(this._toRawAlertWithPossibleWrongId(e),"sidebar"))),this._toRawAlertWithPossibleWrongId=e=>({...e.toRawAlert(),id:(0,o.pipe)(e.rawId,Ie.getOrElse((()=>e.id)))})}openUpgradeUrl(e){(0,o.pipe)(We.vM((()=>{(0,Be.P4)().openSubscriptionDialog({currentAlerts:this._getAdvancedLiteAlerts(),isAnonymousUser:!1,showPlanComparison:!0,isFromEmail:!1,forceUtmCampaign:e})})),je.getOrElse((e=>this._log.fatal("unexpected error on open upgrade page",e))))}_getGroupedLiteAlerts(e){return Ge.Q.group((0,o.pipe)(this._alertsList.state.get(),ze.p.reduce([],((e,{alert:t})=>(qe.bZ.isRegistered(t)&&e.push(t),e)))).filter(e).map((e=>e.toLiteAlert())))}}var Ye,Qe=i(45442),$e=i(79126),Je=i(79176),et=i(73510),tt=i(78674),it=i(57091),st=i(50628),at=i(15228);!function(e){let t;!function(e){e.clickOnEmpty="clickOnEmpty",e.clickOnFakeCard="clickOnFakeCard"}(t=e.Type||(e.Type={}))}(Ye||(Ye={}));class nt{constructor(e,t,i,s){this._lensState=e,this._predictionsVM=t,this._upgradeViewModel=i,this._gnar=s,this._subs=new et.w.Keeper,this.successView=F.hg.combine(this._lensState,this._predictionsVM.previewState,((e,t)=>W.nL.isInSuccess(e)?Ie.some(t.kind===A.visible?at.g.SuccessType.applied:at.g.SuccessType.small):Ie.none)),this._premiumAlertsCount=this._upgradeViewModel.advancedAlerts.view((0,Ue.flow)(Ie.map((e=>e.count)),Ie.getOrElse((()=>0)))),this.havePremiumAlerts=this._premiumAlertsCount.view((e=>e>0)),this._upgradeHookExpanded=new ee.X(!1),this.upgradeHookExpanded=(0,o.pipe)(this._upgradeHookExpanded,ie.x()),this.upgradeHookFlow=(0,o.pipe)((0,$e.Q)(this._upgradeViewModel.advancedAlerts),Qe.Z.extendActions(v.b((e=>{e.key===Je.n.State.expanded?"upgrade"===e.action.kind?(this._upgradeViewModel.openUpgradeUrl(Ne.Place.assistantCardList),this._gnar.assistantExpandedUpgradeHookClick(this._premiumAlertsCount.get())):"onUpgradeButtonMount"===e.action.kind&&this._onUpgradeButtonMount.next(e.action.element):e.key===Je.n.State.minimized&&"onClick"===e.action.action&&this._upgradeHookExpandReason.next("click")}))),Qe.Z.patchState(be.T(this._autoOpenUpgradeHook())),Qe.Z.patchState(v.b((e=>this._onUpgradeHookShown.next(function(e){switch(e){case"hidden":return Je.n.State.hidden;case"expanded":return Je.n.State.expanded;case"minimized":return Je.n.State.minimized;default:(0,ce.vE)(e)}}(e.kind))))),Qe.Z.patchState(v.b((e=>this._upgradeHookExpanded.next("expanded"===e.kind))))),this.cardListContext=new ee.X(Ie.none),this.assistantActions=new c.xQ,this.autoFocusEnabled=F.hg.create(!0),this._onUpgradeButtonMount=new J.t,this._upgradeHookExpandReason=new J.t,this._onUpgradeHookShown=new c.xQ,this._unselectActiveAlert=this.assistantActions.pipe(w.h((e=>e.type===Ye.Type.clickOnEmpty||e.type===Ye.Type.clickOnFakeCard)),v.b((()=>this.autoFocusEnabled.set(!1))),g.U((()=>e=>e.patch({currentLens:(0,o.pipe)(W.In.getActiveItem(e.currentLens),Ie.fold((()=>e.currentLens),(t=>e.currentLens.unselect()))),switchOrder:"lensOrder",alertSource:qe.l$.sidebar})))),this.applicatorEffects={id:"assistantCardListViewModel.effects",when:Ze.R.isWithAlertsId,what:W.nL.Effect.Applicator.create(Ee.T(this._unselectActiveAlert))},this._subs.push(this._onUpgradeHookShown.pipe(tt.b(1),ie.x(),w.h((e=>e===Je.n.State.minimized))).subscribe((()=>this._gnar.assistantCollapsedUpgradeHookShow())),this._onUpgradeButtonMount.pipe(ve.oA,it.a(this.cardListContext.pipe(ve.oA,st.P())),u.w((([e,t])=>_e.n(e,{root:t}).pipe(st.P()))),w.h(Ke.Dw),g.U((e=>Math.trunc(100*e[0].intersectionRatio))),m.M(this._upgradeHookExpandReason,this._premiumAlertsCount)).subscribe((([e,t,i])=>this._gnar.assistantExpandedUpgradeHookShow(i,t,e))),this._lensState.pipe(w.h(W.nL.hasCards),g.U((e=>W.In.getActiveItem(e.currentLens))),_.G(),w.h((([e,t])=>Ie.isNone(e)&&Ie.isSome(t)))).subscribe((e=>{this.autoFocusEnabled.set(!0)})))}dispose(){this._subs.dispose()}_autoOpenUpgradeHook(){return this._lensState.pipe(w.h((e=>(0,o.pipe)(e.currentLens.id,(0,Ke.Kg)(Ze.R.isPriority,Ze.R.isAllAlerts)))),g.U(W.nL.isInSuccess),it.a(this.havePremiumAlerts,((e,t)=>e&&t)),ie.x(),v.b((e=>{e&&this._upgradeHookExpandReason.next("alertsAddressed")})),m.M(this._upgradeViewModel.advancedAlerts),g.U((([e,t])=>(0,o.pipe)(t,Ie.fold((()=>({kind:Je.n.State.hidden})),(t=>e?{kind:Je.n.State.expanded,showCloseButton:!0,alertsState:{count:t.count,alerts:t.alerts()}}:{kind:Je.n.State.minimized,alertsCount:t.count}))))))}}var rt=i(75003);class ot{constructor(e,t,i){this._assistantLayoutViewModel=e,this._domain=t,this._gnar=i,this._caller=this._assistantLayoutViewModel.activeView.get()}getDomain(){return this._domain}openFeedback(){this._caller=this._assistantLayoutViewModel.activeView.get(),this._gnar.assistantFeedbackButtonClick(lt(this._caller)),this._assistantLayoutViewModel.pushActiveView({type:rt.aH.Type.feedback})}submitFeedback(e){this._gnar.assistantFeedbackSubmitButtonClick(lt(this._caller),e.score,e.domain,e.text)}}function lt(e){switch(e.type){case rt.aH.Type.readersAttention:return"readers_attention";case rt.aH.Type.settings:return"settings";default:(0,ce.vE)(e.type)}}var ct,dt=i(80900),pt=i(5817),ut=i(79961);!function(e){let t;!function(e){e.HIDE=pt.m9(.15),e.THANK=pt.m9(3)}(t=e.WaitTime||(e.WaitTime={})),e.THANK_YOU_ICON_UNICODE="1f64c",e.defaultState={isExpanded:!1,isHidden:!1,voteValue:null}}(ct||(ct={}));class ht{constructor(e,t){this._model=e,this._gnar=t,this._subs=[],this._state=F.hg.create(ct.defaultState),this._shownLabels=[],this._cardLookedIds=[],this.onCardShow=e=>{this._model.onFeedback(ut.l.Intent.FeedbackType.INTENT_ALERT,e.id),this._gnar.intentShow(e.id,e.label)},this.onCardExpanded=e=>this._gnar.intentCardExpanded(e.id,e.label),this.onMiniCardClick=e=>{this._state.lens("isExpanded").set(!0),this._onCardLook(e.id)},this.onVote=(e,t)=>{this._shownLabels.push(e.label),this._state.lens("voteValue").set(t),t===ut.l.Intent.FeedbackType.INTENT_ACCEPTED?(this._subs.push((0,dt.H)(ct.WaitTime.THANK).subscribe((()=>this.onHide()))),this._gnar.intentYesButtonClick(e.id,e.label)):(this.onHide(!1),this._gnar.intentNoButtonClick(e.id,e.label)),this._onCardLook(e.id),this._model.onFeedback(t,e.id)},this.onHide=(e=!0)=>{this._state.lens("isHidden").set(!0),this.unsubscribe(),this._subs.push((0,dt.H)(ct.WaitTime.HIDE).subscribe((()=>{e?this._model.onHideAllIntent():this._model.onHideTopIntent(),this._state.set(ct.defaultState),this.unsubscribe()})))},this.unsubscribe=()=>{this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}}_onCardLook(e){this._cardLookedIds.includes(e)||(this._cardLookedIds.push(e),this._model.onFeedback(ut.l.Intent.FeedbackType.INTENT_LOOKED,e))}get _intentState(){return this._model.intent.view((e=>{if(!e)return null;const[t]=e.aggregated.filter((e=>!this._shownLabels.includes(e.prediction.label)));return t?{unicode:t.prediction.bundle.title_icon_id,title:t.prediction.bundle.title,label:t.prediction.label,id:t.id}:null}))}get haveIntent(){return this._intentState.view((e=>null!==e))}get state(){return F.hg.combine(this._state,this._intentState,((e,t)=>({...e,intent:t})))}}var mt,gt=i(26001),ft=i(41552),vt=i(93162),_t=i(22232),wt=i(83078);!function(e){e.equals=(e,t)=>"score"in e&&"score"in t?e.score===t.score:e.type===t.type}(mt||(mt={}));class yt{constructor(e,t,i,s,a,n,r,l,c){this._sessionModel=e,this._layoutVM=t,this._predictionsVM=i,this._modalManager=s,this._lensPreviewVM=a,this._currentLensId=n,this._lensChanged=r,this._cardsListScrollManager=l,this._gnar=c,this.score=(0,o.pipe)(this._sessionModel.score.view(Ie.map((e=>e.rank))),g.U((e=>(0,gt.Yt)(Ie.option)({capiScore:e}))),it.a(this._sessionModel.checkingState,((e,t)=>(0,o.pipe)(e,Ie.map((e=>({...e,isLoading:"idle"!==t}))))))),this.summary=this._sessionModel.textInfo.view((0,Ue.flow)(Ie.chain((e=>e.messages)),Ie.map((e=>e.assistantHeader)),Ie.getOrElse((()=>"Looking good so far")),(e=>({content:e})))),this.logoScore=(0,te.aj)([this._cardsListScrollManager.scrollTop,this._layoutVM.activeView,this.score]).pipe(g.U((([e,t,i])=>(0,o.pipe)(i,Ie.fold((()=>({type:"logo"})),(i=>e<66||t.type!==rt.aH.Type.default?{type:"logo"}:{type:"score",score:i}))))),ie.x(mt.equals)),this.visibility=this._layoutVM.activeView.view((e=>e.type===rt.aH.Type.default?"visible":"hidden")),this.lensSwitchFlow=Qe.Z.fromSideEffect((e=>{switch(e.action.action){case vt.n.Actions.switchToAll:this._lensChanged.next({lensId:Ze.R.SpecialId.AllAlerts,focusFirstCard:!0}),this._gnar.assistantPriorityDropdownClick("all");break;case vt.n.Actions.switchToPriority:this._lensChanged.next({lensId:Ze.R.SpecialId.Priority,focusFirstCard:!0}),this._gnar.assistantPriorityDropdownClick("priority");break;case vt.n.Actions.openSetGoals:break;default:(0,_t.vE)(e.action.action)}}),te.aj(this._currentLensId.pipe(w.h((e=>e!==Ze.R.SpecialId.Premium)),g.U((e=>e===Ze.R.SpecialId.Priority?"priority":"all")),ie.x()),this._lensPreviewVM.getLens(Ze.R.SpecialId.AllAlerts).pipe($.j("count"),ie.x()),this._lensPreviewVM.getLens(Ze.R.SpecialId.Priority).pipe($.j("count"),ie.x()),this._predictionsVM.previewState,((e,t,i,s)=>(0,o.pipe)({allAlertsCount:t,priorityAlertsCount:i,selectedLens:e},Ie.fromPredicate((()=>s.kind!==A.hidden)))))),this._subs=new et.w.Keeper,this._trackHeaderMessageChanges()}open(e){switch(e){case"setGoals":this._subs.push(this._modalManager.show(ft.Iy.setGoals("user")).subscribe());break;default:(0,_t.vE)(e)}}_trackHeaderMessageChanges(){const e=this.summary.pipe(_.G()).subscribe((([e,t])=>{var i,s;this._gnar.assistantHeaderMessageUpdate(e.content,t.content,null===(i=(0,o.pipe)(this._sessionModel.textInfo.get(),Ie.toUndefined))||void 0===i?void 0:i.wordsCount,null===(s=(0,o.pipe)(this._sessionModel.score.get(),wt.Fc))||void 0===s?void 0:s.rank)}));this._subs.push(e)}dispose(){this._subs.dispose()}}var Et=i(73008);const Ct=({children:e,layoutVM:t,panelClassName:i,footer:s,onClickBack:a,hideBackButton:n=F.hg.create(!1),dataPartName:r})=>l.createElement("div",{className:Et.viewOverlay,"data-grammarly-part":"assistant-view-overlay"},l.createElement(F.F.Fragment,null,n.view((e=>!e&&l.createElement(R.M,{className:Et.viewOverlayGoBack,clickHandler:()=>a?a():t.popActiveView()},"<- Back")))),l.createElement("div",{className:i||Et.defaultViewOverlayPanel},l.createElement("div",{className:Et.content,"data-grammarly-part":r},e),s&&l.createElement("div",{className:Et.footer},s))),St=()=>l.createElement("svg",{width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M1 2.5h3m0 0V1m0 1.5V4m3-1.5h8m-14 10h7m0 0V11m0 1.5V14m3-1.5h4m0-5h-4m0 0V6m0 1.5V9M8 7.5H1",stroke:k.Z.blue50,strokeLinecap:"round"}));var bt,kt=i(6322),xt=i(39499),Mt=i(32577),At=i(41439),Lt=i(33751),Rt=i(2023);!function(e){let t;!function(e){e.goals="goals",e.role="role",e.emotions="emotions",e.primaryLanguage="primaryLanguage",e.finished="finished"}(t=e.Step||(e.Step={})),e.OpenButton=({personalizationViewModel:e})=>l.createElement(xt.zx.Flat,{name:"personalizationButton",className:Lt.personalization_button,onClick:()=>e.openPersonalization()},l.createElement(St,null),"Personalize Grammarly to get",l.createElement("br",null),"suggestions tailored to your needs."),e.View=({viewModels:t})=>l.createElement(Ct,{dataPartName:"personalization-view-overlay",layoutVM:t.assistantLayoutViewModel},l.createElement("div",{className:Et.gradientViewOverlayContent},l.createElement("div",{className:Et.defaultViewOverlayHeader},"PERSONALIZE GRAMMARLY"),T.UI.mount(e.Content,t.personalizationViewModel.personalizationFlow)));const i=({onClick:e,disabled:t})=>l.createElement(xt.zx.Flat,{name:"continue",className:Rt.continueButton,onClick:e,disabled:t},"Continue"),s=({title:e,description:t,state:s,onClick:a,onContinue:n})=>l.createElement(l.Fragment,null,l.createElement(I.H3,null,e),l.createElement(I.XY,{className:Rt.description},t),l.createElement(F.F.Fragment,null,s.pipe(g.U((({settings:e})=>l.createElement(l.Fragment,null,Array.from(e.entries()).map((([e,t])=>l.createElement(xt.zx.White,{name:e,key:e,className:Rt.contentButton,active:t.active,onClick:()=>a(e)},l.createElement("div",{className:Rt.buttonContent},t.icon,V.kC(e))))),l.createElement(i,{onClick:n,disabled:Array.from(e.values()).every((e=>!1===e.active))})))))));let a,n,r,c;!function(e){e.nextStep="nextStep",e.onClick="onClick"}(a=e.DefaultActionsKind||(e.DefaultActionsKind={})),function(e){e.school="school",e.work="work",e["other projects"]="other projects"}(n=e.RoleKind||(e.RoleKind={})),e.Role=T.UI.Node.make((({state:e,notify:t})=>l.createElement(s,{title:"Most of my writing is for:",description:"Make a selection below",state:e,onClick:e=>t({kind:a.onClick,value:e})(),onContinue:t({kind:a.nextStep})}))),function(e){e["Spelling and grammar"]="Spelling and grammar",e["Sounding fluent"]="Sounding fluent",e["Clear communication"]="Clear communication",e.Plagiarism="Plagiarism",e.Synonyms="Synonyms",e["Tone and delivery"]="Tone and delivery",e.Conciseness="Conciseness",e.Other="Other"}(r=e.GoalsKind||(e.GoalsKind={})),e.Goals=T.UI.Node.make((({state:e,notify:t})=>l.createElement(s,{title:"I want help with:",description:"Select all that apply",state:e,onClick:e=>t({kind:a.onClick,value:e})(),onContinue:t({kind:a.nextStep})}))),function(e){e.Informative="Informative",e.Friendly="Friendly",e.Defensive="Defensive",e.Angry="Angry",e.Forceful="Forceful",e.Neutral="Neutral",e["I’m not sure"]="I’m not sure"}(c=e.EmotionsKind||(e.EmotionsKind={})),e.Emotions=T.UI.Node.make((({state:e,notify:t})=>l.createElement(s,{title:"I want help identifying when I sound:",description:"Select all that apply",state:e,onClick:e=>t({kind:a.onClick,value:e})(),onContinue:t({kind:a.nextStep})}))),e.EmojieIcon=e=>{switch(e){case c.Informative:return l.createElement(d,null,"🤓");case c.Friendly:return l.createElement(d,null,"🤗");case c.Defensive:return l.createElement(d,null,"🛡️");case c.Angry:return l.createElement(d,null,"😡");case c.Forceful:return l.createElement(d,null,"☝️");case c.Neutral:return l.createElement(d,null,"😐");case c["I’m not sure"]:return;default:return(0,ce.vE)(e)}};const d=({children:e})=>l.createElement(C.dy,{className:Rt.emojieIcon,unicodeHexArray:null,unicodeLiteral:e});e.PrimaryLanguage=T.UI.Node.make((({state:e,notify:t})=>l.createElement(F.F.Fragment,null,e.pipe(g.U((({selectedLanguage:e})=>l.createElement(l.Fragment,null,l.createElement(I.H3,null,"My primary language is:"),l.createElement(I.x4,{className:Rt.primaryLanguageText},"We’ll prioritize feedback about issues common among writers with your language background."),l.createElement(Mt.L,{name:"primaryLanguageDropdown",vAlign:"bottom",customPosition:{top:"80%",left:"0"},label:l.createElement(xt.zx.White,{name:"primaryLanguageLabel",className:Rt.dropdownLabel},(0,o.pipe)(e,Ie.fold((()=>"Choose from the list"),Ue.identity)),l.createElement("span",{className:Rt.iconArrow},"▼"))},l.createElement("div",{className:Rt.dropdownOptionsContainer},Object.keys(kt.n5.PrimaryLanguage).map((i=>l.createElement(xt.zx.Flat,{key:"primaryLanguage-"+i,name:"primaryLanguage-"+i,className:Rt.dropdownOption,onClick:()=>t({kind:"selectLanguage",language:i})()},i,(0,o.pipe)(e,Ie.fold((()=>null),(e=>e===i?l.createElement(At.JO.DocumentSettings.Selected,null):null)))))))),l.createElement(I.x4,{className:Rt.primaryLanguageDescription},"While the list above does not currently include all languages, we're working to provide tailored support for writers of all language backgrounds."),l.createElement(i,{onClick:()=>t({kind:a.nextStep,language:wt.MH(e)})(),disabled:Ie.isNone(e)})))))))),e.Finished=T.UI.Node.make((({notify:e})=>l.createElement(l.Fragment,null,l.createElement("div",{className:Rt.successState},l.createElement(At.JO.GreenOk,{width:44,className:Rt.successStateIcon}),l.createElement(I.H3,null,"You’re all set!")),l.createElement(xt.zx.Flat,{name:"done",className:Rt.continueButton,onClick:e("onDone")},"Done")))),e.Content=T.UI.Union.make("kind",{[t.role]:e.Role,[t.goals]:e.Goals,[t.emotions]:e.Emotions,[t.primaryLanguage]:e.PrimaryLanguage,[t.finished]:e.Finished})}(bt||(bt={}));var It=i(4120);class Tt{constructor(e,t,i,s){this._assistantLayoutViewModel=e,this._user=t,this._userActions=i,this._gnar=s,this._log=Te.C8.Logging.getLogger("AssistantPersonalizationViewModel"),this._state=F.hg.create({kind:bt.Step.finished}),this.step=this._state.pipe(g.U((({kind:e})=>e))),this._onOpen=new ee.X(this._state.get()),this.personalizationFlow=(0,Ue.flow)(g.U((e=>{switch(e.key){case bt.Step.role:const t=this._state.get();switch(e.action.kind){case bt.DefaultActionsKind.nextStep:const i=Array.from(t.settings.entries()),s=i.find((([e,t])=>!0===t.active));return void 0!==s&&this._userActions.setUserRole(s[0]).catch((e=>this._log.error("Failed to set user role: "+e))),this._gnar.assistantPersonalizationRoleContinueClick(i.filter((([e,t])=>!0===t.active)).map((([e])=>e))),this._nextStep();case bt.DefaultActionsKind.onClick:const a=e.action.value,n=new Map;return t.settings.forEach(((e,t)=>{t===a?n.set(t,{active:!e.active}):n.set(t,{active:!1})})),{kind:bt.Step.role,settings:n};default:return(0,ce.vE)(e.action)}case bt.Step.goals:const i=this._state.get();switch(e.action.kind){case bt.DefaultActionsKind.nextStep:const t=Array.from(i.settings.entries()),s=void 0!==t.find((([e,t])=>e===bt.GoalsKind["Sounding fluent"]&&!0===t.active));return this._userActions.setSoundFluentGoals(s).catch((e=>this._log.error("Failed to set user goal: "+e))),this._gnar.assistantPersonalizationGoalsContinueClick(t.filter((([e,t])=>!0===t.active)).map((([e])=>e))),this._nextStep();case bt.DefaultActionsKind.onClick:return Vt(bt.Step.goals,e.action.value,i);default:return(0,ce.vE)(e.action)}case bt.Step.emotions:const s=this._state.get();switch(e.action.kind){case bt.DefaultActionsKind.nextStep:return this._gnar.assistantPersonalizationEmotionsContinueClick(Array.from(s.settings.entries()).filter((([e,t])=>!0===t.active)).map((([e])=>e))),this._nextStep();case bt.DefaultActionsKind.onClick:return Vt(bt.Step.emotions,e.action.value,s);default:return(0,ce.vE)(e.action)}case bt.Step.primaryLanguage:switch(e.action.kind){case bt.DefaultActionsKind.nextStep:return this._userActions.setPrimaryLanguage(e.action.language).catch((e=>this._log.error("Failed to set users primary language: "+e))),this._gnar.assistantPersonalizationPrimaryLanguageContinueClick(e.action.language),{kind:bt.Step.finished};case"selectLanguage":return{kind:bt.Step.primaryLanguage,selectedLanguage:Ie.some(e.action.language)};default:return(0,ce.vE)(e.action)}case bt.Step.finished:switch(e.action){case"onDone":return this._assistantLayoutViewModel.popActiveView(),{kind:bt.Step.finished};default:return(0,ce.vE)(e)}default:return(0,ce.vE)(e)}})),be.T(this._onOpen),v.b((e=>this._state.set(e)))),this._unfinishedStepsInOrder=[],this._initSteps()}openPersonalization(){this._assistantLayoutViewModel.pushActiveView({type:rt.aH.Type.personalization}),this._onOpen.next(this._state.get()),this._gnar.assistantPersonalizationOpenClick()}_initSteps(){const e=this._user.get();e.isPremium&&(It.n5.hasRole(e)||this._unfinishedStepsInOrder.push(bt.Step.role),It.n5.hasSoundFluentGoals(e)||this._unfinishedStepsInOrder.push(bt.Step.goals),It.n5.hasRole(e)||this._unfinishedStepsInOrder.push(bt.Step.emotions),It.n5.hasPrimaryLanguage(e)||this._unfinishedStepsInOrder.push(bt.Step.primaryLanguage),this._state.set(this._nextStep()))}_nextStep(){if(0===this._unfinishedStepsInOrder.length)return{kind:bt.Step.finished};const e=this._unfinishedStepsInOrder.shift();if(void 0===e)return{kind:bt.Step.finished};switch(e){case bt.Step.role:return{kind:bt.Step.role,settings:Ft};case bt.Step.goals:return{kind:bt.Step.goals,settings:Pt};case bt.Step.emotions:return{kind:bt.Step.emotions,settings:Ot};case bt.Step.primaryLanguage:return{kind:bt.Step.primaryLanguage,selectedLanguage:Ie.none};case bt.Step.finished:return{kind:bt.Step.finished};default:return(0,ce.vE)(e)}}}function Vt(e,t,i){const s=new Map;return i.settings.forEach(((e,i)=>{i===t?s.set(i,{active:!e.active,icon:e.icon}):s.set(i,e)})),{kind:e,settings:s}}const Ft=new Map([[bt.RoleKind.school,{active:!1}],[bt.RoleKind.work,{active:!1}],[bt.RoleKind["other projects"],{active:!1}]]),Pt=new Map([[bt.GoalsKind["Spelling and grammar"],{active:!1}],[bt.GoalsKind["Sounding fluent"],{active:!1}],[bt.GoalsKind["Clear communication"],{active:!1}],[bt.GoalsKind.Plagiarism,{active:!1}],[bt.GoalsKind.Synonyms,{active:!1}],[bt.GoalsKind["Tone and delivery"],{active:!1}],[bt.GoalsKind.Conciseness,{active:!1}],[bt.GoalsKind.Other,{active:!1}]]),Ot=new Map([[bt.EmotionsKind.Informative,{active:!1,icon:bt.EmojieIcon(bt.EmotionsKind.Informative)}],[bt.EmotionsKind.Friendly,{active:!1,icon:bt.EmojieIcon(bt.EmotionsKind.Friendly)}],[bt.EmotionsKind.Defensive,{active:!1,icon:bt.EmojieIcon(bt.EmotionsKind.Defensive)}],[bt.EmotionsKind.Angry,{active:!1,icon:bt.EmojieIcon(bt.EmotionsKind.Angry)}],[bt.EmotionsKind.Forceful,{active:!1,icon:bt.EmojieIcon(bt.EmotionsKind.Forceful)}],[bt.EmotionsKind.Neutral,{active:!1,icon:bt.EmojieIcon(bt.EmotionsKind.Neutral)}],[bt.EmotionsKind["I’m not sure"],{active:!1}]]);var Ht=i(63919);const Nt=e=>{const t=e.initialPositionOffset.get();return{initialPositionOffset:t,onDrag:i=>{e.updateInitialPositionOffset(Ht.E9.plus(t,function({x:e,y:t}){return Ht.E9.create({top:t,left:e})}(i.translate)))}}};class Ut{constructor(e,t,i,s,a,n){this._lensPreviewVM=e,this._layoutVM=t,this._emogenieService=i,this._session=s,this._readersAttentionPredictionCardVM=a,this._gnar=n,this._subs=new et.w.Keeper,this.previewState=F.hg.create({kind:A.hidden}),this.previewFlow=Qe.Z.fromSideEffect((e=>{switch(e.action.key){case"tone":const t=this._emogenieService.viewState.view("prevalentEmotion").get();return t&&this._gnar.emogeniePredictionButtonClick(t.name),this._layoutVM.pushActiveView({type:rt.aH.Type.emogenie});case"readersAttention":return this._layoutVM.pushActiveView({type:rt.aH.Type.readersAttention,caller:{type:rt.T5.Type.predictionWidget}});default:(0,_t.vE)(e.action)}}),this.previewState),this._readersAttentionState=(0,o.pipe)(this._readersAttentionPredictionCardVM,Ie.map((e=>e.state)),Ie.getOrElse((()=>d.of(wt.cS())))),this._previewState=(0,o.pipe)(te.aj([this._emogenieService.viewState.view((e=>Ie.fromNullable(e.settings.hiddenReport?void 0:e.prevalentEmotion))),this._emogenieService.viewState.view("brandToneOffImageUrl"),this._readersAttentionState,this._session.documentLength,this._lensPreviewVM.getLens(Ze.R.SpecialId.PredictionEmogenie),this._lensPreviewVM.getLens(Ze.R.SpecialId.PredictionTakeaways)]),g.U((([e,t,i,s,a,n])=>(Ie.isSome(e)||Ie.isSome(i))&&s.trimmed>0?{kind:A.visible,tone:(0,o.pipe)(e,Ie.map((e=>({emotion:e,alertsCount:a.count,brandToneOffImageUrl:t})))),readersAttention:(0,o.pipe)(i,Ie.map((e=>({...e,alertsCount:n.count}))))}:s.trimmed>0?{kind:A.zero}:{kind:A.hidden}))),this._subs.push(this._previewState.subscribe(we.wW(this.previewState)))}dispose(){this._subs.dispose()}}var Dt=i(77843),Bt=i(72923);class Zt{constructor(e,t,i,s){this.feature=t,this._closeAssistant=i,this._gnar=s,this._subs=[],this._subs.push(this.feature.requestInfo.view("status").pipe((0,ie.x)(),(0,_.G)(),(0,m.M)(e.activeView)).subscribe((([[t,i],s])=>{t===Bt.u.RequestStatus.REVIEWING&&s.type===rt.aH.Type.proofitReview&&e.popActiveView()}))),this._subs.push(this.feature.layoutCreated.pipe((0,m.M)(e.activeView)).subscribe((([t,i])=>{i.type!==rt.aH.Type.proofitRequest&&i.type!==rt.aH.Type.proofitReview||t||e.popActiveView()})))}onSubmitRequest(e){this.feature.submitRequest(),this._gnar.proofitRequestFormSubmit();const t=this.feature.requestInfo.lens("status").pipe((0,w.h)((e=>e===Bt.u.RequestStatus.ACCEPTED)));(0,Dt.F)(100).pipe((0,f.R)(t)).subscribe({complete:()=>this._closeAssistant(e)})}onCompleteRequest(e){this.feature.resetRequest(),this._gnar.proofitOrderDone(),this._closeAssistant(e)}dispose(){this._subs.forEach((e=>e.unsubscribe()))}}var qt=i(38040);class Gt{constructor(e,t,i){this._contentScriptState=e,this._contentScriptActions=t,this.domain=i,this.state=this._contentScriptState.view((e=>({user:e.user,commonSettings:e.page}))),this.actions={toggleSite:(e,t)=>this._contentScriptActions.toggleSite(e,t,(0,qt.IJ)(this.state.view("user").get())),toggleDefs:this._contentScriptActions.toggleDefs,toggleAutocomplete:this._contentScriptActions.toggleAutocomplete,toggleAutocorrect:this._contentScriptActions.toggleAutocorrect,toggleHotkeys:this._contentScriptActions.toggleHotkeys,changeStrongDialect:this._contentScriptActions.changeStrongDialect,disableLlama:this._contentScriptActions.disableLlama}}}var zt=i(53073),Kt=i(59443),Wt=i(91224),jt=i(83401),Xt=i(598),Yt=i(45429),Qt=i(40644);class $t{constructor(e,t){this._cardPositions=e,this._markPositions=t,this._log=y.Y.create($t.name)}alignCardToMark({id:e,renderOptions:{features:t},activeAlert:i,activeHighlightIndex:s},a){return Ce.P((()=>d.of(this._markPositions.getMarkAlertPosition({alert:i,highlightIndex:s})))).pipe(ve.oA,g.U((i=>(0,o.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e,t.has(Qt.X.RenderOptions.Features.showLabel),Ie.some(i),"cardContentTop"),Ie.fromEither))),ve.oA,u.w((i=>this._cardPositions.setCardPosition(e,t.has(Qt.X.RenderOptions.Features.showLabel),!0,i.top))),ke.h(we.PU),Wt.K((e=>(this._log.error("Cannot align card to mark",e),Se.c()))),re.B())}alignMarkTo(e,t,i,s){return Ce.P((()=>d.of((0,o.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e.id,!!Qt.X.isAlertCard(e)&&e.renderOptions.features.has(Qt.X.RenderOptions.Features.showLabel),Ie.some(i),"cardContentTop"),Ie.fromEither)).pipe(ve.oA))).pipe(u.w((i=>Ee.T(this._markPositions.moveAlertHighlightInViewport(t,Me.r.FromWindowTop.ISO.modify(Me.L.concatC(i.contentOffset))(i.top),Kt.uq.initial),this._cardPositions.setCardPosition(e.id,!!Qt.X.isAlertCard(e)&&e.renderOptions.features.has(Qt.X.RenderOptions.Features.showLabel),!0,i.top)))),ke.h(we.PU),Wt.K((e=>(this._log.error("Cannot align mark to suggested position",e),Se.c()))),re.B())}alignMarkToCard({id:e,renderOptions:{features:t},activeHighlightIndex:i,activeAlert:s},a,n=Ie.none){return Ce.P((()=>d.of((0,o.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e,t.has(Qt.X.RenderOptions.Features.showLabel),n,"cardContentTop"),Ie.fromEither)).pipe(ve.oA))).pipe(u.w((a=>Ee.T(this._markPositions.moveAlertHighlightInViewport({alert:s,highlightIndex:i},Me.r.FromWindowTop.ISO.modify(Me.L.concatC(a.contentOffset))(a.top),Kt.uq.initial),this._cardPositions.setCardPosition(e,t.has(Qt.X.RenderOptions.Features.showLabel),!0,a.top)))),ke.h(we.PU),Wt.K((e=>(this._log.error("Cannot align mark to card",e),Se.c()))),re.B())}alignCardTo(e,t,i){const s=i!==Yt.DV.NO_ANIMATION;return Ce.P((()=>d.of((0,o.pipe)(this._cardPositions.getCardSuggestedPosition(e.id,!!Qt.X.isAlertCard(e)&&e.renderOptions.features.has(Qt.X.RenderOptions.Features.showLabel),Ie.some(t),"cardTop"),Ie.fromEither)).pipe(ve.oA))).pipe(u.w((t=>this._cardPositions.setCardPosition(e.id,!!Qt.X.isAlertCard(e)&&e.renderOptions.features.has(Qt.X.RenderOptions.Features.showLabel),s,t.top))),ke.h(we.PU),Wt.K((e=>(this._log.error("Cannot align card to required top",e),Se.c()))),re.B())}}var Jt;!function(e){e.skip="skip"}(Jt||(Jt={}));const ei=(e,t,i,s=we.b2.rafScheduler)=>{const a=(e,i,s,a)=>{if(s===qe.l$.text)return t.alignCardToMark(e,i?Yt.DV.ANIMATE_ALL:Yt.DV.NO_ANIMATION,!0);if(s===W.h8.forceText)return t.alignCardToMark(e,Yt.DV.NO_ANIMATION,!1);{const n=s===qe.l$.sidebar;return t.alignMarkToCard(e,n?i?Yt.DV.ANIMATE_ALL:Yt.DV.ANIMATE_MARK:Yt.DV.NO_ANIMATION,a)}},n=Ee.T(e.view(W.nL.mapper((({currentLens:e,alertSource:t})=>Ie.some({currentLens:e,alertSource:t})))).pipe(h.O(Ie.none),g.U(Ie.map((e=>e.currentLens.id))),_.G(),w.h((([e,t])=>(0,o.pipe)(wt.vB(((e,t)=>e!==t))(e,t),Ie.exists(Ue.identity)))),ke.h(Ie.none)),e.view(W.nL.mapper((({currentLens:e,alertSource:t})=>Ie.some({currentLens:e,alertSource:t})))).pipe(w.h(Ie.exists((({currentLens:e})=>(0,Ae.Bk)(e)))),g.U(Ie.chain((({currentLens:e,alertSource:t})=>(0,o.pipe)(W.In.getActiveItemWithAlert(e),Ie.filter(Ae.S4),Ie.map((i=>({card:i,source:t,lensId:e.id}))))))))).pipe(ie.x((0,Ue.flow)(wt.vB(((e,t)=>e.lensId===t.lensId&&e.card.activeAlert.id===t.card.activeAlert.id&&e.card.visualState.transition.type===t.card.visualState.transition.type&&e.card.activeHighlightIndex===t.card.activeHighlightIndex)),Ie.exists(Ue.identity))),h.O(Ie.none),_.G(),g.U((([e,t])=>(0,o.pipe)(t,Ie.map((i=>({card:i.card,source:i.source,animate:(0,o.pipe)(e,wt.wo((({lensId:e})=>e===i.lensId))),suggestedPosition:(0,o.pipe)(e,Ie.filter((e=>!e.card.scheduledToDispose)),Ie.chain((e=>(0,o.pipe)(t,Ie.map((t=>[e.card,t.card]))))),Ie.filter((([e,t])=>t.lensId===e.lensId&&t.positionState.absTop>e.positionState.absTop)),Ie.map((([e,t])=>Me.r.FromWindowTop.ISO.wrap(t.positionState.absTop))))})))))),u.w(Ie.fold(Se.c,s)),m.M(i),u.w((([{card:e,source:t,animate:s,suggestedPosition:n},r])=>(0,o.pipe)(r,Ie.fold((()=>a(e,s,t,n)),(t=>(i.set(Ie.none),t===Jt.skip?jt.C:a(e,s,t,n))))))));return{id:"alignmentSideEffect",when:Ze.R.isWithAlertsId,what:W.nL.Effect.Applicator.create(n.pipe(Xt.c(jt.F())))}};var ti=i(91402),ii=i(66910),si=i(26268);function ai(e,t,i,s,a){return{id:"changeAlertEffect",when:Ue.constTrue,what:W.nL.Effect.SwitchAlert.create(e.actionEvents.pipe(u.w((e=>{const n=t.get();if(!W.nL.hasCards(n))return ti._(new _t.ej("Cannot update state without cards"));switch(e.type){case ii.l.Type.alertMinicardButtonClick:return(0,o.pipe)(i.getRegistered(e.alertHighlight.alert.id),Ie.fold((()=>(a.warn("somehow we got click on non registered alert",e.alertHighlight.alert),Se.c())),(()=>d.of(e.alertHighlight))));case ii.l.Type.cardMatchesNavigationButtonClick:const t=e.transitionTo;switch(t.kind){case"anotherAlert":return(0,o.pipe)("right"===e.direction?s.nextAlert(t.card):(0,o.pipe)(s.prevAlert(t.card),wt.vx(s.anyRegisteredAlert(t.card))),Ie.fold(Se.c,(e=>d.of({alert:e,highlightIndex:0}))));case"sameAlert":return(0,o.pipe)(i.getRegistered(t.card.activeAlert.id),Ie.fold(Se.c,(()=>d.of({alert:t.card.activeAlert,highlightIndex:t.highlightIndex}))));default:return(0,_t.vE)(t)}default:return Se.c()}})),g.U((e=>({alertHighlight:e,alertSource:qe.l$.sidebar,options:{order:"lensOrder"}})))))}}function ni(e,t,i){const s=e.pipe(w.h(W.nL.hasCards),tt.b(0),g.U((e=>e)),w.h((e=>e.currentLens.items.size>0&&Ie.isNone(W.In.getActiveItem(e.currentLens))&&i.get())),g.U((e=>(0,o.pipe)(e.currentLens.items.getAt(0),Ie.chain(G.checksFeedItemsMapper((e=>Ie.some(e.activeAlert)),(()=>Ie.none),(()=>Ie.none))),wt.bw((()=>t.set(Ie.some(Jt.skip))))))),ve.oA,w.h((e=>e.state.type===qe.bZ.State.Type.REGISTERED)),ie.x());return{id:"focusFirstCardSideEffect",when:e=>e!==Ze.R.SpecialId.PredictionTakeaways&&e!==Ze.R.SpecialId.PredictionEmogenie,what:W.nL.Effect.SwitchLens.create(s.pipe(m.M(e),g.U((([e,t])=>({lensId:t.currentLens.id,alertSource:qe.l$.text,options:{order:"lensOrder",toFocus:W.nL.Effect.SwitchLens.FocusBehavior.focusAlert({alert:e,highlightIndex:0})}})))))}}function ri(e,t){const i=e.pipe(g.U((e=>i=>e.type===si.tn.Type.AppliedAlertAnimationFinished&&i.currentLens.meta.filter(e.alert)?i.patch({currentLens:(0,o.pipe)(je.tryCatch((()=>i.currentLens.onAnimationFinish([e.alert])),(e=>t.error("could not update lens state on applied animation finish",e))),je.getOrElse((()=>i.currentLens))),alertSource:e.alert.state.source}):i)));return{id:"onAlertApply",when:Ue.constTrue,what:W.nL.Effect.Applicator.create(i)}}function oi(e,t){return{id:"lensChangeEffect",when:Ue.constTrue,what:W.nL.Effect.SwitchLens.create(e.pipe(m.M(t),w.h((([e,t])=>e.lensId!==t)),g.U((([e])=>({lensId:e.lensId,alertSource:qe.l$.sidebar,options:{order:"lensOrder",toFocus:e.focusFirstCard?W.nL.Effect.SwitchLens.FocusBehavior.focusFirst:W.nL.Effect.SwitchLens.FocusBehavior.noFocus}})))))}}const li=(e,t)=>{const i=(0,o.pipe)(e,g.U(W.nL.mapper((({currentLens:e,alertSource:t})=>Ie.some({currentLens:e,alertSource:t})))),ci,u.w(we.b2.rafScheduler),v.b((e=>t.moveCardsBy(e,"freezeActiveCardOnCardsListUpdate"))));return{id:"freezeActiveCardOnCardsListUpdate",when:Ze.R.isWithAlertsId,what:W.nL.Effect.Applicator.create(Ee.T(Ee.T(i).pipe(Xt.c(jt.F()))))}},ci=e=>e.pipe(Ae.Sd,g.U(Ie.map((e=>e.currentLens))),_.G(),w.h((([e,t])=>(0,o.pipe)((0,Ue.tuple)(e,t),(0,Ue.tupled)(wt.vB(((e,t)=>e.id===t.id&&(0,o.pipe)((0,Ue.tuple)(W.In.getActiveItem(e),e.cardIndex,W.In.getActiveItem(t),t.cardIndex),(0,Ue.tupled)((0,gt.gz)(Ie.option)),Ie.map((([e,t,i,s])=>e.id===i.id&&t!==s)),Ie.getOrElse((()=>!1)))))),Ie.getOrElse((()=>!1))))),g.U((0,Ue.flow)(zt.Pd(Ie.chain(W.In.getActiveItem),Ie.chain(W.In.getActiveItem)),(0,Ue.tupled)(wt.vB(((e,t)=>t.positionState.absTop-e.positionState.absTop))),Ie.getOrElse((()=>0)))));var di=i(77394),pi=i(55935);function ui(e,t){return{id:"alertSwitchingByClickSideEffect",when:Ue.constTrue,what:W.nL.Effect.SwitchAlert.create(e.alertClicked.pipe(pi.T(1),u.w(Ie.fold(Se.c,d.of)),m.M(t.pipe(w.h(W.nL.hasCards),g.U((e=>e.currentLens.id))),((e,t)=>({...e,lensId:t}))),g.U((({alert:e,highlightIndex:t,lensId:i})=>({alertHighlight:{alert:e,highlightIndex:t},alertSource:qe.l$.text,options:{lensId:i,order:"textOrder"}})))))}}var hi=i(489),mi=i(93283),gi=i(79932),fi=i(58199),vi=i(65247),_i=i(64510);class wi{constructor(e,t){this._lensesList=e,this._alertsFilterService=t,this.getLens=(0,Ke.HP)((function(e){switch(e){case Ze.R.SpecialId.AllAlerts:return this._lensesList.view(yi(Ze.R.Info.allAlerts,Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(Ze.R.SpecialId.AllAlerts)));case Ze.R.SpecialId.Priority:return this._lensesList.view(yi(Ze.R.Info.priority,Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(Ze.R.SpecialId.Priority)));case Ze.R.SpecialId.PredictionTakeaways:return this._lensesList.view(yi(Ze.R.Info.predictionTakeaways,Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(Ze.R.SpecialId.PredictionTakeaways)));case Ze.R.SpecialId.PredictionEmogenie:return this._lensesList.view(yi(Ze.R.Info.predictionEmogenie,Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(Ze.R.SpecialId.PredictionEmogenie)));case Ze.R.SpecialId.RealTimeProofit:return this._lensesList.view(yi(Ze.R.Info.realTimeProofit,Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(Ze.R.SpecialId.RealTimeProofit)));case Ze.R.SpecialId.Plagiarism:return this._lensesList.view(this._getPlagiarismLens);case Ze.R.SpecialId.Premium:return this._lensesList.view(yi(Ze.R.Info.premium,Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(Ze.R.SpecialId.Premium)));case Ze.R.SpecialId.Correctness:case Ze.R.SpecialId.Clarity:case Ze.R.SpecialId.Engagement:case Ze.R.SpecialId.Delivery:case Ze.R.SpecialId.Vox:return this._lensesList.view(yi(Ze.R.Info.createOutcome(e),Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(e)));case Ze.R.SpecialId.RealTimeProofit:return this._lensesList.view(yi(Ze.R.Info.realTimeProofit,Ze.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(e)));default:return(0,_t.vE)(e)}})),this._outcomes=[Ze.R.SpecialId.Correctness,Ze.R.SpecialId.Clarity,Ze.R.SpecialId.Engagement,Ze.R.SpecialId.Delivery],this._previews=(0,Ke.HP)((()=>mi.uX((0,gi.getFirstSemigroup)(),hi.IX)(this._outcomes,(e=>[e,this._getPreview(e)])))),this._isDocumentEmpty=F.hg.create(!1),this._isFree=F.hg.create(!1),this._outcomeStatusMask=F.hg.combine(this._isDocumentEmpty,this._isFree,((e,t)=>{let i=0;return e&&(i|=vi.x.IsDocumentEmpty),t&&(i|=vi.x.IsFreeUser),i})),this._getPlagiarismLens=(0,Ue.flow)(yi(Ze.R.Info.plagiarism,{...Ze.R.Meta.group.empty,percentile:fi.T.MAX},this._alertsFilterService.getLensesFilter(Ze.R.SpecialId.Plagiarism)),Ze.R.WithAlerts.modifyMeta((e=>({...e,percentile:fi.T.groupSum.concat(fi.T.MAX,fi.T.groupSum.inverse(e.percentile))}))))}findLens(e){return(0,o.pipe)(Ie.fromNullable([this.getLens(Ze.R.SpecialId.AllAlerts),this.getLens(Ze.R.SpecialId.Premium)].find((t=>e(t.get())))),Ie.map((e=>e.get().id)))}_getPreview(e){return{...Ze.R.Info.base,logo:Ie.none,...this._getOutcomeButtonData(e)}}get previews(){return this._previews()}_getOutcomeButtonData(e){const t=this.getLens(e),i=t.get().title,s=this._isFree.view((t=>t&&(e===Ze.R.SpecialId.Engagement||e===Ze.R.SpecialId.Delivery))),a=F.hg.combine(t.view("count").view((e=>0===e)),s,((e,t)=>e&&!t)),{description:n,stateMessage:r}=(0,vi.O)(e),o=F.hg.combine(this._isDocumentEmpty,a,t.view("percentile"),((e,t,i)=>e?fi.T.MIN:t?fi.T.MAX:i)).view(fi.g.fromRatio),l=F.hg.create(!1),c=F.hg.combine(t,o,this._outcomeStatusMask,l,r);return{id:e,title:i,description:n,status:c,progress:o,isUnavailable:s}}get nonEmptyLensId(){return(0,o.pipe)(Ie.fromNullable([this.getLens(Ze.R.SpecialId.AllAlerts),this.getLens(Ze.R.SpecialId.Premium)].find((e=>e.get().count>0))),Ie.map((e=>e.get().id)))}}function yi(e,t,i){return s=>{return new Ze.R.LensImpl(e,(a=e.id,n=t,e=>(0,o.pipe)(_i.P5(Ze.R.Id.ord)(a,e),Ie.getOrElse((()=>n))))(s),i);var a,n}}var Ei,Ci,Si=i(95572),bi=i(95384),ki=i(41120),xi=i(95722),Mi=i(20892),Ai=i(41199),Li=i(92843);!function(e){e.create=(e,t,i,s)=>(a,n)=>bi.sO.Change.getCreateAction({range:a,capiAlertId:e,visualState:n.to.visualState===xi.Bd.highlighted?{type:bi.sO.Change.VisualState.Type.highlighted,source:t()}:{type:bi.sO.Change.VisualState.Type.visible},extensionDisplayType:i,order:s}),e.update=(e,t,i,s)=>(a,n)=>bi.sO.Change.getUpdateAction({range:a,capiAlertId:e,visualState:n.to.visualState===xi.Bd.highlighted?{type:bi.sO.Change.VisualState.Type.highlighted,source:t()}:{type:bi.sO.Change.VisualState.Type.visible},extensionDisplayType:i,order:s}),e.remove=e=>t=>bi.sO.Change.getRemoveAction({range:t,capiAlertId:e})}(Ei||(Ei={}));class Ri{constructor(e,t,i,s,a,n,r,l=d.of(void 0),p=!1){this._alertList=e,this._alertsReader=t,this._positionManager=i,this._alertsService=s,this._ded=a,this._lensState=n,this._alertsFilterService=r,this._readyObs=l,this._emulateAppliedAlertAnimation=p,this._highlightedAlert=Ie.none,this._focusedAlert=Ie.none,this._marksMap=new Map,this._subs=new et.w.Keeper,this.events=new c.xQ,this._alertStateDiff=this._alertList.state.pipe(_.G(),g.U((([e,t])=>ze.p.diff(e,t))),w.h((0,Ke.ff)(Li.v.isEmpty))),this._alertsFilter=F.hg.create(Ue.constFalse),this._filteredAlerts=F.hg.create(Ie.none),this._ready=!1,this._log=Te.C8.Logging.getLogger("marks_view_model"),this.getMarkByAlert=e=>(0,o.pipe)(this._marksMap.get(e.alert.id),Ie.fromNullable,Ie.chain((t=>t.markByIndex(e.highlightIndex)))),this.getAlertByMark=e=>(0,o.pipe)(this._alertsReader.getRegistered(ki.P.fromRangeIdToAlertId(e.id)),Ie.chain((t=>(0,o.pipe)(si.$A.getHighlightIndex(t,e.range()),je.map((e=>({alert:Ai.$.fromModel(t),highlightIndex:e}))),Ie.fromEither)))),this.ensureAlertHighlightInViewport=(e,t,i)=>(0,o.pipe)(this.getMarkByAlert(e),Ie.fold(Se.c,(e=>this._ded.scrollToMark(e,{animate:i,paddingTop:t})))),this._createMA=e=>{const t=wt.MH(e.rawId),{impact:i,cardLayout:{outcome:s}}=e.toRawAlert(),a=Si.DD.createOutcomeType(s),n="critical"===i?Si.Hg.critical:Si.Hg.advanced,r=Si.DD.createExtensionType(n,a),l=Ze.R.getSortOrder(e.lensType),c=new Mi.v((t=>(0,o.pipe)(this._alertsReader.getById(e.id),Ie.alt((()=>(t&&this._log.warn("Could not find alert for provided MarkAlert",{alert:e,source:t}),Ie.some(e)))),Ie.map(Ai.$.fromModel),wt.MH)),this._alertsService,this._alertsService,(e=>this._ded.changeMarks(e)),Ei.create(t,(()=>bi.sO.Change.VisualState.Source.api),r,l),Ei.update(t,(()=>Ci.getAlertSource(e,this._lensState.get())),r,l),Ei.remove(t),(t=>{t.to.visualState===xi.Bd.applied&&(this.events.next({type:si.tn.Type.AppliedAlertAnimationFinished,alert:e}),this._handleRemovedAlerts([e]).forEach((e=>e.apply())))}));return this._marksMap.set(e.id,c),c},this._handleRemovedAlerts=e=>e.map((({id:e})=>{const t=this._marksMap.get(e);return this._marksMap.delete(e),t.scheduleApply(xi.Bd.disposed),t})),this._handleAlertUpdate=e=>e.map((e=>qe.bZ.isRegistered(e)?(0,o.pipe)(Ie.fromNullable(this._marksMap.get(e.id)),Ie.fold((()=>this._alertsFilter.get()(e)?this._createMA(e):null),(e=>(e.scheduleUpdate(),xi.Oe.isOrWillBe(xi.Bd.success)(e)&&e.scheduleApply(xi.Bd.highlighted),e)))):(0,o.pipe)(Ie.fromNullable(this._marksMap.get(e.id)),Ie.fold((()=>{}),(t=>(e.allowUpdate&&qe.bZ.isCapiDone(e)&&qe.bZ.isRated(e)&&xi.Oe.isOrWillBe(xi.Bd.highlighted)(t)?(t.scheduleUpdate(),t.scheduleApply(xi.Bd.success)):(t.scheduleApply(xi.Bd.disposed),this._marksMap.delete(t.alert.id)),t)))))).filter((e=>Boolean(e))),this._subs.push(this._readyObs.subscribe((()=>{this._subs.push(this._listenAlertsUpdates(),this._listenRangesUpdates(),this._listenFilterChange(),this._listenFilteredAlerts()),this._ready=!0})))}focusAlertHighlight(e){return this._ready?(0,o.pipe)(this._marksMap.get(e.alert.id),Ie.fromNullable,Ie.map((t=>{this._focusedAlert=Ie.some(e.alert.id),t.scheduleApply(xi.Bd.highlighted),t.scheduleForceUpdate(),t.apply()})),je.fromOption((()=>new Error("Unknown alert"))),je.map((()=>({dispose:()=>{Ie.exists((t=>t===e.alert.id))(this._focusedAlert)&&(this._highlightedAlert=Ie.none),(0,o.pipe)(this._marksMap.get(e.alert.id),Ie.fromNullable,Ie.filter((()=>!(0,o.pipe)(this._highlightedAlert,Ie.exists((t=>t===e.alert.id))))),Ie.map((e=>{e.scheduleApply(xi.Bd.visible),e.apply()})))}})))):je.left(new Error("marks view model is not ready yet"))}highlightAlertHighlight(e){return this._ready?(0,o.pipe)(this._marksMap.get(e.id),Ie.fromNullable,Ie.map((t=>{this._highlightedAlert=Ie.some(e.id),t.scheduleApply(xi.Bd.highlighted),t.apply()})),je.fromOption((()=>new Error("Unknwn alert"))),je.map((()=>({dispose:()=>{Ie.exists((t=>t===e.id))(this._highlightedAlert)&&(this._highlightedAlert=Ie.none),(0,o.pipe)(this._marksMap.get(e.id),Ie.fromNullable,Ie.filter((()=>!(0,o.pipe)(this._focusedAlert,Ie.exists((t=>t===e.id))))),Ie.map((e=>{e.scheduleApply(xi.Bd.visible),e.apply()})))}})))):je.left(new Error("marks view model is not ready yet"))}moveCursorToHighlight(e,t){return this._ready?(0,o.pipe)(this._marksMap.get(e.alert.id),Ie.fromNullable,Ie.chain((t=>t.markByIndex(e.highlightIndex))),Ie.chain((e=>Ie.fromEither(e.range()))),Ie.fold((()=>je.left(new Error("Cannot find mark for given range"))),(e=>{const{index:i,length:s}=this._ded.getCursor();if(0===s&&(i<e.start||i>e.end)){const i=Math.min(e[t],this._ded.getLastPossibleCursorPosition());return(0,o.pipe)(this._ded.setCursor(i,0),je.orElse(je.left))}return je.right(void 0)}))):je.left(new Error("marks view model is not ready yet"))}dispose(){this._subs.dispose()}_listenAlertsUpdates(){const e=e=>({activeAlerts:[],updatedAlerts:[],removedAlerts:[],acceptedAlerts:[],hiddenMarkAlerts:[],...e});return Ee.T(this._filteredAlerts.pipe(ve.cp((({visible:t,hidden:i})=>d.of(e({activeAlerts:j.qo(t),removedAlerts:j.qo(i)}))))),this._alertStateDiff.pipe(m.M(this._alertsFilter),g.U((([t,i])=>(0,o.pipe)(t,Li.v.reduce(e({}),((e,t)=>(this._marksMap.has(t.alert.id)&&e.removedAlerts.push(t.alert),e)),((e,t,i)=>(qe.bZ.isAccepted(i.alert)?e.acceptedAlerts.push(i.alert):e.updatedAlerts.push(i.alert),e)),((e,t)=>(i(t.alert)&&e.activeAlerts.push(t.alert),e)))))))).pipe(g.U((({activeAlerts:e,removedAlerts:t,updatedAlerts:i,acceptedAlerts:s})=>{let a=[];return a=a.concat(e.filter((0,Ke.W9)((0,Ke.ff)(qe.bZ.isPremium),(e=>Ie.isSome(e.rawId)))).map((e=>{const t=this._marksMap.get(e.id);return void 0!==t?(t.scheduleForceUpdate(),t):this._createMA(e)}))),this._emulateAppliedAlertAnimation&&setTimeout((()=>{s.forEach((e=>{this.events.next({type:si.tn.Type.AppliedAlertAnimationFinished,alert:e})}))}),3*(0,pt.Xd)(20)),a=a.concat(this._handleRemovedAlerts(t.concat(s).filter((e=>this._marksMap.has(e.id))))),a=a.concat(this._handleAlertUpdate(i)),a}))).subscribe((e=>{if(e.length>0){const[t,...i]=e;t.applyWith(i)}}))}_listenRangesUpdates(){return this._positionManager.rangeChanged.pipe($.j("changed"),g.U((e=>e.filter((e=>ki.P.is(e)&&ki.x.isVisible(e)&&this._marksMap.has(e.meta.alertId))))),w.h((e=>e.length>0))).subscribe((e=>{const t=Array.from(e.values()).filter((e=>Ie.isSome(this._alertsReader.getById(e.meta.alertId)))).reduce(((e,t)=>((0,o.pipe)(this._alertsReader.getRegistered(t.meta.alertId),Ie.chain((e=>Ie.fromNullable(this._marksMap.get(e.id)))),Ie.fold(Ke.ZT,(t=>{t.scheduleForceUpdate(),e.push(t)}))),e)),[]);if(t.length>0){const[e,...i]=t;e.applyWith(i)}}))}_listenFilterChange(){return this._lensState.pipe(w.h((e=>e.currentLens.id!==Ze.R.SpecialId.Premium)),ie.x(((e,t)=>!(e.currentLens.id!==t.currentLens.id||W.nL.isWithPriorityList(e)&&W.nL.isWithPriorityList(t)&&e.currentLens.isNonPriorityListOpened!==t.currentLens.isNonPriorityListOpened))),ie.x(),g.U((e=>this._alertsFilterService.alertVisibleInText(e.currentLens.id,W.nL.nonPriorityAlertsVisible(e))))).subscribe(we.wW(this._alertsFilter))}_listenFilteredAlerts(){return this._alertsFilter.pipe(m.M(this._alertList.state),g.U((([e,t])=>(0,o.pipe)(t,ze.p.reduce({visible:{},hidden:{}},((t,i)=>(e(i.alert)&&qe.bZ.isRegistered(i.alert)?t.visible[i.alert.id]=i.alert:t.hidden[i.alert.id]=i.alert,t))),(e=>Ie.some(e)))))).subscribe(we.wW(this._filteredAlerts))}}!function(e){e.toSidebarFluidMarkSource=e=>{switch(e){case qe.l$.text:case W.h8.forceText:return bi.sO.Change.VisualState.Source.text;case qe.l$.sidebar:case W.h8.forceSidebar:return bi.sO.Change.VisualState.Source.sidebar;case qe.l$.api:return bi.sO.Change.VisualState.Source.api;default:return(0,_t.vE)(e)}},e.getAlertSource=(t,i)=>W.nL.hasCards(i)?(0,o.pipe)(W.In.getActiveItemWithAlert(i.currentLens),Ie.fold((()=>bi.sO.Change.VisualState.Source.api),(s=>s.alerts.some((e=>e.id===t.id))?e.toSidebarFluidMarkSource(i.alertSource):bi.sO.Change.VisualState.Source.api))):bi.sO.Change.VisualState.Source.api}(Ci||(Ci={}));var Ii=i(13444),Ti=i(48403),Vi=i(95343),Fi=i(87325);class Pi{constructor(e,t){this._documentModel=e,this._modalOperations=t,this.reportViewModel=Ie.none,this.state=Ce.P((()=>we.GQ((()=>this._documentModel.calculateStats())))).pipe(it.a(this._documentModel.checkingState,((e,t)=>(0,o.pipe)(e,Ie.filter((()=>"idle"===t))))),u.w(Ie.fold((()=>d.of({type:Fi.g.State.Type.LOADING}).pipe(Ii.g(150))),je.fold((e=>(Te.C8.Logging.getLogger("editor.toolbar").error("Error on requesting document stats",e),this.onModalClose(),d.of({type:Fi.g.State.Type.ERROR}))),(e=>F.hg.combine(this._documentModel.score,this._documentModel.counters,this._documentModel.documentLength.view("trimmed"),((t,i,s)=>(0,o.pipe)(t,Ie.fold((()=>({type:Fi.g.State.Type.SHORT_CONTENT})),(t=>({type:Fi.g.State.Type.READY,documentIsEmpty:0===s,score:t,counters:i,stats:e})))))))))),h.O({type:Fi.g.State.Type.EMPTY}),Ti._(1),Vi.x()),this.onModalClose=()=>{this._modalOperations.onClose()}}}var Oi=i(57588),Hi=i(82578),Ni=i(17082),Ui=i(71831),Di=i(51100),Bi=i(20403);class Zi{constructor(e,t,i,s){this._documentModel=e,this._upgradeViewModel=t,this._isPremiumUser=i,this._mutedCategoriesVM=s}load(e){switch(e.type){case ft.dC.SetGoals:return this._loadSetGoals(e.source);case ft.dC.Performance:return this._loadPerformance();case ft.dC.MutedAlerts:return this._loadMutedAlerts();default:return(0,_t.vE)(e)}}_loadSetGoals(e){return Promise.resolve((t=>{const i={demoMode:!1,isRedesign:!1,isFree:!this._isPremiumUser,defaultAudience:"knowledgeable"},s=Hi._.create(this._documentModel.context.get(),(0,o.pipe)(this._documentModel.defaultContext.get(),Ie.fold((()=>Oi.R$.defaultContextFallback),Ue.identity)),i,!1),a=F.hg.combine(s.showSetGoalsLoader,s.localContext,((t,a)=>({blocks:s.blocks,context:a,showOnLoad:t,features:i,source:e}))),n=Qe.Z.fromSideEffect((e=>{switch(e.kind){case Di.R.ActionsKind.open:break;case Di.R.ActionsKind.upgrade:this._upgradeViewModel.openUpgradeUrl(Ne.Place.gdocsGoals);break;case Di.R.ActionsKind.close:t.onClose(),this._documentModel.updateContext(e.context);break;case Di.R.ActionsKind.reset:s.localContext.set(Oi.R$.unset);break;case Di.R.ActionsKind.showOnLoadChanged:s.showSetGoalsLoader.set(e.value);break;default:(0,_t.vE)(e)}}),a);return{instance:{type:ft.dC.SetGoals,source:e},component:T.UI.mount(Di.R.Modal,n)}}))}_loadPerformance(){return Promise.resolve((e=>{const t=new Pi(this._documentModel,e),i=T.UI.Knot.make(Bi.q.ModalView,{downloadButton:T.UI.Node.empty}),s=Qe.Z.fromSideEffect((t=>{switch(t.action.kind){case Bi.q.ActionsKind.close:e.onClose();break;default:(0,_t.vE)(t.action.kind)}}),t.state.pipe(g.U((e=>({root:e})))));return{instance:{type:ft.dC.Performance},component:T.UI.mount(i,s)}}))}_loadMutedAlerts(){return Promise.resolve((e=>(0,o.pipe)(this._mutedCategoriesVM,Ie.fold((()=>{throw new Error("Tried to load Muted Alerts Dialogue, but Muted Alerts Model was absent")}),(t=>{const i=T.UI.mount(Ni.B,(0,Ui.g)(t,e));return{instance:{type:ft.dC.MutedAlerts},component:i}})))))}}var qi=i(926),Gi=i(19787),zi=i(73343),Ki=i(96892),Wi=i(24740),ji=i(78264),Xi=i(50536),Yi=i(41394),Qi=i(10584),$i=i(78792),Ji=i(20490),es=i(55969);const ts=(e,t,i,s,a,n,r,l,p,u,h,m,f,v,_,y,E,C,S,b,k)=>{const x=Te.C8.Logging.getLogger("view_models"),M=F.hg.create(qi.A.defaultState),A=zi.t.create(zi.t.defaultLensFilters,zi.t.defaultTextFilters),L=qi.A.get(e.alertsList.state,e.alertsList.lensesScores,A).subscribe(we.wW(M)),R=new wi(M.view("lenses"),A),I=(0,Wi.$)(t.getContents.bind(t)),T={features:new Set([Xi.IG.Features.showCardLabelInOutcomes]),cardLayoutDensityMode:Qt.X.RenderOptions.Density.minimal,shouldAnimateAlertApply:Xi.IG.Default.shouldAnimateAlertApply,upgradeDemoPremiumNotice:Xi.YH.gray},V=(0,Xi.Ls)(I,e.alertsReader,T,(()=>d.of(Ie.none)),Ie.none,!1,(0,o.pipe)(n,Ie.map((t=>t.takeawaysFeedbackService.getFeedbackReader(e.alertsReader))),Ie.getOrElse((()=>Xi.Nf.mock)))),P=new Ji.o(e.alertsList.state,e.alertsReader,M.view("lenses"),e.positionManager,R,new es.ad(e.alertsReader,V,A,(e=>e.id===Ze.R.SpecialId.Priority),new es.gi(e.alertsReader,V,A)),(0,es.kn)((e=>e===Ze.R.SpecialId.Priority),(0,es.is)(V)),A),O=new ht(a,f),H=i.get(),N=F.hg.create(P.emptyState(H).patch({alertSource:qe.l$.sidebar}));l.next({kind:di.R.ChangeLens,selectedLens:H===Ze.R.SpecialId.Priority?"priority":"all"});const U=ji.P.createAlertByCursorGetter((()=>t.getCursor().index),P),D=new Xe(e.alertsList,R,3),B=new ft.EQ(new Zi(e.sessionModel,D,_.get().isPremium,Ie.none)),Z=new Ki.Xx({flush:()=>t.flushChanges()},new c.xQ,V,e.alertsService,(()=>Promise.resolve()),(()=>Promise.resolve()),Ie.none,Ie.none,Ie.none,(()=>!1),{changePosition:G.changePosition(V)}),q=new Yi.o((()=>je.right(void 0))),z=new Ri(e.alertsList,e.alertsReader,e.positionManager,e.alertsService,t,N,A,p,!0),K=((e,t,i,s,a)=>new $t(Yt.eZ.getSuperScrollMapper(e,s,F.hg.create(16)),Yt.UC.getMapper(t,a,{})))(N,z,F.hg.create(16),q,t),j=new rt.D$(m,f,C,S,k),X=new c.xQ,Y=N.pipe(g.U((e=>e.currentLens.id))),Q=(0,o.pipe)(n,Ie.map((e=>e.createPredictionCardViewModel()))),$=new Ut(R,j,s,e.sessionModel,Q,f),J=new yt(e.sessionModel,j,$,B,R,Y,X,q,f),ee=new nt(N,$,D,f),te=new ot(j,v,f),se=(0,o.pipe)(r,Ie.map((e=>new Zt(j,e,E,f)))),ae=new Gi.m(t,N,z,e.alertsReader),ne=F.hg.create((0,o.pipe)(u,Ie.fold((()=>Jt.skip),(()=>qe.l$.text)),Ie.some)),re=[ui(ae,N),(0,o.pipe)(si.EQ.focusMarkByActiveAlert(N,z,e.alertsReader,x.getLogger("MarksEffects.focusMarkByActiveAlert")),W.nL.Effect.Producer.delayed(p)),si.EQ.highlightMarkByHighlightedCard(Z,N,z,e.alertsReader,x.getLogger("MarksEffects.highlightMarkByHighlightedCard")),ri(z.events,x.getLogger("createOnAlertApplySideEffect")),ai(Z,N,e.alertsReader,V,x),ni(N,ne,ee.autoFocusEnabled),Z.applicatorEffects,ee.applicatorEffects,Qi.R7(N,q,V,G.changePosition(V),Z.actionEvents,{cardsAroundActive:10,cardsBeyondViewport:10}),(0,o.pipe)(ei(N,K,ne),W.nL.Effect.Producer.delayed(p)),li(N,q),oi(X,Y),Ki.dv.createSendActiveAlertFeedbacksEffect(N,e.alertsService,e.alertsReader,x.getLogger("MarksEffects.highlightMarkByHighlightedCard"))],oe=ji.P.selectNextAlertInText(P,U),le=F.hg.create(u),de=new $i.lb(N,P,e.alertsReader,e.alertsService,re,ji.P.getStateTransformer(e.alertsReader,ee.autoFocusEnabled,(pe=ji.P.selectNextAlertByLens((e=>Ze.R.isPriority(e.currentLens.id)),oe),e=>{const t=G.checksFeedItemsMapper(Ie.some,(()=>Ie.none),(()=>Ie.none));return(0,o.pipe)(le.get(),Ie.fold((()=>pe(e)),(i=>(le.set(Ie.none),W.nL.hasCards(e)?(0,o.pipe)(e.currentLens.items.reduce(((e,s)=>(0,o.pipe)(e,Ie.alt((()=>(0,o.pipe)(s,t,Ie.chain((e=>Ie.fromNullable(e.alerts.find((e=>e.id.startsWith(i+"_"))))))))))),Ie.none),Ie.map((t=>({alert:t,highlightIndex:0,lensId:e.currentLens.id})))):Ie.none))))}),(e=>(0,$i.GU)(e)||e.currentLens.items.size>0&&Ie.isNone(W.In.getActiveItem(e.currentLens)))));var pe;const ue=X.pipe(g.U((({lensId:e})=>e)),w.h((e=>e===Ze.R.SpecialId.AllAlerts||e===Ze.R.SpecialId.Priority)),ie.x()).subscribe((e=>{i.set(e),l.next({kind:di.R.ChangeLens,selectedLens:e===Ze.R.SpecialId.Priority?"priority":"all"})})),he=j.activeView.pipe(g.U((e=>{switch(e.type){case rt.aH.Type.default:return i.get();case rt.aH.Type.emogenie:return Ze.R.SpecialId.PredictionEmogenie;case rt.aH.Type.readersAttention:return Ze.R.SpecialId.PredictionTakeaways;case rt.aH.Type.proofitReview:return Ze.R.SpecialId.RealTimeProofit;default:return null}})),w.h(ce.fQ),ie.x(),g.U((e=>[e,e===Ze.R.SpecialId.AllAlerts||e===Ze.R.SpecialId.Priority]))).subscribe((([e,t])=>X.next({lensId:e,focusFirstCard:t}))),me=new Gt(h,m,v),ge=new Tt(j,_,y,f),fe=(0,o.pipe)(n,Ie.map((t=>t.createPanelViewModel(Z.actionEvents,j,N,e.alertsList.state,(t=>e.alertsReader.getById(t)),(()=>ee.assistantActions.next({type:Ye.Type.clickOnFakeCard})))))),ve=(0,o.pipe)(n,Ie.map((t=>t.getCollisionLogger(e.alertsList.state,e.alertsService,e.positionManager)))),_e=Nt(b);return{lensState:N,cardsViewModel:Z,lensPreviewViewModel:R,cardsListScrollManager:q,upgradeViewModel:D,assistantHeaderViewModel:J,assistantLayoutViewModel:j,assistantCardListViewModel:ee,lensChanged:X,predictionsPreviewViewModel:$,assistantFeedbackViewModel:te,assistantSettingsViewModel:me,assistantProofitViewModel:se,readersAttentionViewModel:fe,personalizationViewModel:ge,assistantModalManager:B,goalPredictionViewModel:O,marksViewModel:z,gnar:f,positionViewModel:_e,user:_,dispose:()=>{Z.dispose(),de.dispose(),z.dispose(),$.dispose(),ue.unsubscribe(),L.unsubscribe(),he.unsubscribe(),J.dispose(),ee.dispose(),B.hideAll(),O.unsubscribe(),(0,o.pipe)(se,wt.bw((e=>e.dispose()))),(0,o.pipe)(Q,wt.bw((e=>e.dispose()))),(0,o.pipe)(fe,wt.bw((e=>e.dispose()))),(0,o.pipe)(ve,wt.bw((e=>e.dispose())))}}};var is=i(20271),ss=i(18756),as=i(24394),ns=i(19526),rs=i(68370),os=i(39318),ls=i.n(os);const cs=({kind:e,title:t,className:i})=>l.createElement(ns.j.div,{className:i,"data-grammarly-part":"ui-kit-badge"},l.createElement(rs.b,null,ls().__css),l.createElement("div",Object.assign({},(0,F.Sh)(ls().badge,"primary"===e?ls().badgePrimary:null,"success"===e?ls().badgeSuccess:null,"gold"===e?ls().badgeGold:null)),t));cs.defaultProps={kind:"primary"};const ds=({browser:e,className:t})=>"safari"!==e?l.createElement(cs,{title:"BETA",kind:"success",className:t}):null;var ps=i(1620),us=i(45666),hs=i.n(us);const ms=({intent:e,isExpanded:t,isHidden:i,voteValue:s,goalPredictionVM:a,layoutVM:n})=>{const r=s===ut.l.Intent.FeedbackType.INTENT_ACCEPTED;return l.useEffect((()=>a.onCardShow(e)),[e.id]),l.useEffect((()=>{t&&a.onCardExpanded(e)}),[e.id,t]),l.createElement("div",Object.assign({},(0,F.Sh)(hs().card,i&&hs().hide,r?hs().thank:t&&hs().expand),{onClick:()=>!t&&a.onMiniCardClick(e),role:"intent-card"}),l.createElement("div",{className:hs().content},l.createElement("div",{className:hs().emojiAndTitle},l.createElement(C.dy,{className:hs().emoji,unicodeHexArray:r?[ct.THANK_YOU_ICON_UNICODE]:[e.unicode],unicodeLiteral:null}),l.createElement("div",null,r?l.createElement("div",null,"Thanks for helping us build new suggestions!"):l.createElement(l.Fragment,null,l.createElement("div",null,e.title),t?l.createElement("div",{className:hs().expandedInfo},"Your input helps us develop more tailored suggestions for you."):null))),r?l.createElement("div",{className:hs().betaBadgeAndCloseButton},l.createElement(ps.P,{onClick:()=>a.onHide(),size:"small",containerClassName:hs().closeButton}),l.createElement(ds,{browser:n.browser,className:hs().betaBadge})):l.createElement("div",{className:hs().voteAndBetaBadge},l.createElement(as.A,{ariaLabel:e.title,voteNoAriaLabel:"No",voteYesAriaLabel:"Yes",voteNoTooltipMessage:"No",voteYesTooltipMessage:"Yes",onVote:t=>{t===as.x.YES?a.onVote(e,ut.l.Intent.FeedbackType.INTENT_ACCEPTED):a.onVote(e,ut.l.Intent.FeedbackType.INTENT_IGNORED)}}),t?l.createElement(ds,{browser:n.browser,className:hs().expandedInfo}):null)))},gs=({goalPredictionVM:e,layoutVM:t})=>l.createElement(F.F.Fragment,null,e.state.view((({intent:i,...s})=>i?l.createElement(ms,Object.assign({layoutVM:t,goalPredictionVM:e,intent:i},s)):null)));var fs=i(39742);const vs=({color:e=k.Z.neutral50,size:t=11})=>l.createElement("svg",{width:t,height:t,viewBox:"0 0 11 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("mask",{id:"path-1-inside-1",fill:"white"},l.createElement("path",{d:"M11 5.5C11 8.53757 8.53757 11 5.5 11C2.46243 11 0 8.53757 0 5.5C0 2.46243 2.46243 0 5.5 0C8.53757 0 11 2.46243 11 5.5Z"})),l.createElement("path",{d:"M6 5C6 4.72386 5.77614 4.5 5.5 4.5C5.22386 4.5 5 4.72386 5 5H6ZM5 8C5 8.27614 5.22386 8.5 5.5 8.5C5.77614 8.5 6 8.27614 6 8H5ZM6 2.99C6 2.71386 5.77614 2.49 5.5 2.49C5.22386 2.49 5 2.71386 5 2.99H6ZM5 3C5 3.27614 5.22386 3.5 5.5 3.5C5.77614 3.5 6 3.27614 6 3H5ZM5 5V8H6V5H5ZM5 2.99V3H6V2.99H5ZM10 5.5C10 7.98528 7.98528 10 5.5 10V12C9.08985 12 12 9.08985 12 5.5H10ZM5.5 10C3.01472 10 1 7.98528 1 5.5H-1C-1 9.08985 1.91015 12 5.5 12V10ZM1 5.5C1 3.01472 3.01472 1 5.5 1V-1C1.91015 -1 -1 1.91015 -1 5.5H1ZM5.5 1C7.98528 1 10 3.01472 10 5.5H12C12 1.91015 9.08985 -1 5.5 -1V1Z",fill:e,mask:"url(#path-1-inside-1)"}));var _s=i(90665),ws=i(75039),ys=i(88903),Es=i(35327);const Cs=e=>l.createElement("div",Object.assign({},(0,F.Sh)(Es.summary_wrapper,e.className)),T.UI.mount(xs,Qe.Z.animatingFlow((()=>e.summaryVM.summary),Ss))),Ss=(e,t)=>(0,o.pipe)(e,Ie.filter((e=>e.content!==t.content)),Ie.map((()=>ys.Hk("fadeout","fadein")))),bs=T.UI.Node.make((({view:e})=>l.createElement(F.F.div,{className:Es.summary_heading},e("content")))),ks=T.UI.Transition.make({fadein:Es.summary_fadein},{fadeout:Es.summary_fadeout}),xs=T.UI.Animated.make(ks,bs),Ms=({headerVM:e})=>l.createElement(F.F.div,{style:{visibility:e.visibility}},l.createElement("div",{className:ws.panel},l.createElement(Cs,{summaryVM:e}),l.createElement(F.F.div,{className:ws.score_container,"data-grammarly-part":"assistant-score"},(0,o.pipe)(e.score,g.U(Ie.map((({capiScore:e,isLoading:t})=>l.createElement(l.Fragment,null,l.createElement(_s.B,{generalScore:e,strokeWidth:3,width:38,fontSize:e<100?16:14,isLoading:t,componentStyle:{margin:"-3px -3px 0 0",cursor:"default"}}),l.createElement(fs.u,{message:`Text score: ${e} out of 100. This score represents the quality of writing.`},l.createElement("div",{className:ws.info_icon},l.createElement(vs,{color:k.Z.neutral40,size:9}))))))),g.U(wt.QP)))),l.createElement("div",{className:ws.lens_switch,"data-grammarly-part":"assistant-lens-switch"},T.UI.mount(As,e.lensSwitchFlow))),As=T.UI.Union.asOption(vt.n.Switch);var Ls=i(22168),Rs=i(74880),Is=i(45440),Ts=i(30509);const Vs=({upgradeViewModel:e})=>l.createElement(F.F.div,{className:Ts.premiumLens},T.UI.mount(Is.r,Qe.Z.fromSideEffect((t=>{"upgrade"===t.action.action.action.kind&&e.openUpgradeUrl(Ne.Place.gdocsSidebarSuccessView)}),e.advancedAlerts.pipe(g.U((0,Ue.flow)(Ie.map((e=>({count:e.count,alerts:e.alerts()})))))))));var Fs=i(79844),Ps=i(52268),Os=i(56157),Hs=i(879);const Ns=({successLensViewModel:e})=>{const t=(0,Ps.hM)((0,Ps.wK)(e.successState.view("type"),!1,l.useContext(Fs.m.Context)));return l.createElement(F.F.div,{className:Hs.successLens},T.UI.mount(Os.q,t))},Us=(l.forwardRef((({state:e,cardsViewModel:t,upgradeViewModel:i,cardsListScrollManager:s,...a},n)=>{const r=we.jw((e=>{let t=7;return t=31*t+(0,ss.AC)(e.currentLens.id),t=31*t+(W.nL.isInSuccess(e)?1231:1237),t}),e),c=(0,o.pipe)((0,$e.Q)(i.advancedAlerts),Qe.Z.extendActions(v.b((e=>{e.key===Je.n.State.expanded&&"upgrade"===e.action.kind&&i.openUpgradeUrl(Ne.Place.gdocsSidebarCardList)}))));return l.createElement(Us,{ref:n},(e=>l.createElement(F.F.Fragment,null,r.view((n=>{const r=n.get();return r.currentLens.id===Ze.R.SpecialId.Premium?l.createElement(Vs,{upgradeViewModel:i}):W.nL.isInSuccess(r)?l.createElement(Ns,{successLensViewModel:a.successLensViewModel}):l.createElement("div",null,l.createElement(Pe,{state:n,cardsViewModel:t,cardsListScrollManager:s,connectorElements:e,header:T.UI.mount(Je.n.ToggablePanel,c)}))})))))})),l.forwardRef((({children:e,onClick:t,className:i=Rs.cardList,footer:s},a)=>{const n=Le.d.Elements.create(),r=(0,o.pipe)(n.view("viewport"),ve.oA,g.U(Re.UL.fromEl));return l.createElement("div",{onClick:t,className:i,ref:e=>{"function"==typeof a?a(e):a&&(a.current=e);const t=Ie.fromNullable(e);n.lens("scrollConsumer").set(t),n.lens("scrollProvider").set(t),n.lens("viewport").set(t)}},l.createElement(Ls.l.RootVirtualContainer,{name:"cardListConnector",viewport:r},e(n)),s)})));var Ds=i(62513);const Bs=l.forwardRef((({successView:e},t)=>l.createElement("div",{className:Ds.compactSuccessLens,ref:t},l.createElement("div",{className:Ds.compactSuccessLensContainer},T.UI.mount(Os.q,(0,Ps.hM)((0,Ps.JT)((0,o.pipe)(e,ve.oA)))))))),Zs=l.forwardRef((({viewModels:e},t)=>l.createElement("div",{className:Lt.mainView},l.createElement(Gs,{ref:t,state:e.lensState,cardsViewModel:e.cardsViewModel,upgradeViewModel:e.upgradeViewModel,cardsListScrollManager:e.cardsListScrollManager,assistantCardListViewModel:e.assistantCardListViewModel,predictionsPreviewViewModel:e.predictionsPreviewViewModel,assistantFeedbackViewModel:e.assistantFeedbackViewModel,personalizationViewModel:e.personalizationViewModel,goalPredictionViewModel:e.goalPredictionViewModel,headerViewModel:e.assistantHeaderViewModel,layoutViewModel:e.assistantLayoutViewModel})))),qs=({position:e,isSuccess:t,children:i})=>l.createElement(F.F.Fragment,null,e.pipe(ie.x(((e,t)=>e.offset===t.offset&&e.visible===t.visible)),g.U((e=>e.visible?l.createElement(F.F.div,Object.assign({},(0,F.Sh)(Lt.cardListFooterStatic,e.animationInProgress?Lt.cardListFooterAnimate:void 0,t?void 0:Lt.cardListFooterDynamic),{style:t?{}:{transform:Re.ux.translateY(e.offset)}}),i):null)))),Gs=l.forwardRef((({state:e,assistantCardListViewModel:t,cardsViewModel:i,upgradeViewModel:s,cardsListScrollManager:a,goalPredictionViewModel:n,...r},c)=>{const d=we.jw((e=>{let t=7;return t=31*t+(0,ss.AC)(e.currentLens.id),t=31*t+(W.nL.isInSuccess(e)?1231:1237),t}),e),p=(0,o.pipe)(d,g.U((e=>{const t=e.get();return W.nL.isInSuccess(t)})),it.a(n.haveIntent,((e,t)=>e&&!t))),u=(0,o.pipe)(Oe(e,a),m.M(e),g.U((([e,t])=>({visible:!W.nL.hasCards(t)||Ie.isNone(t.currentLens.items.find((e=>!e.positionState.isHeightValid))),offset:e+6,animationInProgress:!0}))),h.O({visible:!1,offset:0,animationInProgress:!0}));return l.createElement(Us,{className:Lt.cardList,onClick:e=>{e.target.getAttribute("class")===Lt.cardList&&t.assistantActions.next({type:Ye.Type.clickOnEmpty})},footer:l.createElement(F.F.Fragment,null,(0,o.pipe)(p,g.U((e=>l.createElement(qs,{position:u,isSuccess:e},l.createElement(O,{predictionsVM:r.predictionsPreviewViewModel}),l.createElement(F.F.Fragment,null,r.personalizationViewModel.step.pipe(ie.x(),g.U((e=>e!==bt.Step.finished?l.createElement(bt.OpenButton,{personalizationViewModel:r.personalizationViewModel}):null)))))))))},(s=>l.createElement(F.F.Fragment,null,(0,o.pipe)(te.aj(p,t.havePremiumAlerts,n.haveIntent),g.U((([o,d,p])=>o&&!d?l.createElement(l.Fragment,null,l.createElement(Ms,{headerVM:r.headerViewModel}),l.createElement(Bs,{successView:t.successView,ref:c})):l.createElement(Pe,{state:e,cardsViewModel:i,cardsListScrollManager:a,connectorElements:s,ref:c,header:l.createElement(l.Fragment,null,l.createElement(Ms,{headerVM:r.headerViewModel}),d?l.createElement("div",{className:Lt.upgradeHookWrapper,role:"uphook-wrapper"},T.UI.mount(Je.n.ToggablePanel,t.upgradeHookFlow)):p?l.createElement(gs,{goalPredictionVM:n,layoutVM:r.layoutViewModel}):null)})))))))})),zs=l.forwardRef((({viewModels:e,header:t,footer:i},s)=>l.createElement(Us,{ref:s},(s=>l.createElement(l.Fragment,null,l.createElement(Pe,{state:e.lensState,cardsViewModel:e.cardsViewModel,cardsListScrollManager:e.cardsListScrollManager,connectorElements:s,header:t,footer:i}))))));var Ks=i(28288),Ws=i(82457),js=i(92783),Xs=i(40145);const Ys=l.forwardRef((({emogenieService:e,viewModels:t},i)=>l.createElement(Ct,{dataPartName:"emogenie-view-overlay",layoutVM:t.assistantLayoutViewModel,panelClassName:Et.gradientViewOverlayPanel,hideBackButton:t.user.view((e=>e.isAnonymous))},l.createElement(F.F.Fragment,null,t.lensPreviewViewModel.getLens(Ze.R.SpecialId.PredictionEmogenie).pipe(g.U((e=>e.count>0)),ie.x(),g.U((s=>s?l.createElement(zs,{key:"emogeniePredictionCardList",viewModels:t,ref:i,header:l.createElement(l.Fragment,null,l.createElement(Qs,{emogenieService:e}),l.createElement("div",{className:Xs.relatedSuggestionsTitle},"RELATED SUGGESTIONS"))}):l.createElement("div",{className:Et.gradientViewOverlayContent},l.createElement(Qs,{emogenieService:e}))))))))),Qs=({emogenieService:e})=>{var t;const i=e.viewState.get(),s=null===(t=i.report)||void 0===t?void 0:t.institutionLogo,a=i.isBrandTonesEnabled?l.createElement("div",null,s?l.createElement("img",{className:Et.logo,src:s}):null,i.institutionName," Tone detector"):"Tone detector";return l.createElement(l.Fragment,null,l.createElement("div",{className:Et.defaultViewOverlayHeader},a,(0,js.G6)()?null:l.createElement(Ks.m,{secondary:!0})),l.createElement(F.F.Fragment,null,e.viewState.view((({report:t,emotionsPoll:i,settings:s,isBrandTonesEnabled:a})=>t&&Array.isArray(t.emotions)&&l.createElement(l.Fragment,null,l.createElement(Ws.G,{key:"emogenieReportPopup",showBanner:!1,report:t,actions:e.actions,emotionsPoll:i,settings:s,isBrandTonesEnabled:a}))))))};var $s=i(79712);const Js=({feedbackVM:e,layoutVM:t})=>l.createElement(Ct,{dataPartName:"feedback-view-overlay",layoutVM:t,panelClassName:Et.gradientViewOverlayPanel},l.createElement("div",{className:Et.gradientViewOverlayContent},l.createElement("div",{className:Et.defaultViewOverlayHeader},"Product Feedback"),l.createElement($s.q,{domain:e.getDomain(),onSubmit:t=>e.submitFeedback(t),onClose:()=>t.popActiveView(),align:"left",hideLogo:!0,style:{height:"calc(100% - 48px)"},fixSubmitButtonOverflowBottomPadding:!0})));var ea=i(22667),ta=i(78846);const ia=e=>l.createElement("div",{className:ta.logo_score},T.UI.mount(la,Qe.Z.animatingFlow((()=>e.headerVM.logoScore),sa))),sa=(e,t)=>(0,o.pipe)(e,Ie.filter((e=>e.type!==t.type)),Ie.map((()=>ys.Hk("fadeout","fadein")))),aa=T.UI.Node.make((()=>l.createElement(ea.K,{className:ta.grammarly_logo,size:22}))),na=T.UI.Node.make((({view:e})=>l.createElement(F.F.div,{className:ta.score_container,"data-grammarly-part":"assistant-score"},(0,o.pipe)(e("score"),(0,g.U)((({capiScore:e,isLoading:t})=>l.createElement(l.Fragment,null,l.createElement(_s.B,{generalScore:e,strokeWidth:2,width:22,fontSize:e<100?11:9,isLoading:t,componentStyle:{transform:"translate(2px, -2px) rotate(-90deg)",cursor:"default"}})))))))),ra=T.UI.Union.make("type",{logo:aa,score:na}),oa=T.UI.Transition.make({fadein:ta.logoscore_fadein},{fadeout:ta.logoscore_fadeout}),la=T.UI.Animated.make(oa,ra);var ca=i(22679),da=i(3860),pa=i(85708);const ua=({color:e=k.Z.neutral50})=>l.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M15.8256 15.75L21.5 10M21.5 10V7.375M21.5 10H24.1047M23.5 5.5V8.125H26.1047M11.3605 24L12.8462 21.375M12.8462 21.375C13.734 21.8536 14.7483 22.125 15.8256 22.125C16.9028 22.125 17.9172 21.8536 18.805 21.375M12.8462 21.375C10.8548 20.3014 9.5 18.1852 9.5 15.75C9.5 12.2292 12.3321 9.375 15.8256 9.375C16.8052 9.375 17.7327 9.59941 18.5605 10M20.2907 24L18.805 21.375M18.805 21.375C20.7964 20.3014 22.1512 18.1852 22.1512 15.75C22.1512 14.7652 21.9296 13.8326 21.534 13M16.5 12.4435C16.2822 12.3986 16.0566 12.375 15.8256 12.375C13.9761 12.375 12.4767 13.886 12.4767 15.75C12.4767 17.614 13.9761 19.125 15.8256 19.125C17.6751 19.125 19.1744 17.614 19.1744 15.75C19.1744 15.5171 19.151 15.2897 19.1064 15.07",stroke:e,strokeLinecap:"round"})),ha=({color:e=k.Z.neutral50})=>l.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M15.5 9.5V9C15.2239 9 15 9.22386 15 9.5H15.5ZM17.5 9.5H18C18 9.22386 17.7761 9 17.5 9V9.5ZM20.8333 10.8333L21.1869 10.4798C21.0931 10.386 20.9659 10.3333 20.8333 10.3333C20.7007 10.3333 20.5735 10.386 20.4798 10.4798L20.8333 10.8333ZM22.1667 12.1667L22.5202 12.5202C22.7155 12.325 22.7155 12.0084 22.5202 11.8131L22.1667 12.1667ZM23.5 15.5H24C24 15.2239 23.7761 15 23.5 15V15.5ZM23.5 17.5V18C23.7761 18 24 17.7761 24 17.5H23.5ZM22.1667 20.8333L22.5202 21.1869C22.7155 20.9916 22.7155 20.675 22.5202 20.4798L22.1667 20.8333ZM20.8333 22.1667L20.4798 22.5202C20.675 22.7155 20.9916 22.7155 21.1869 22.5202L20.8333 22.1667ZM17.5 23.5V24C17.7761 24 18 23.7761 18 23.5H17.5ZM15.5 23.5H15C15 23.7761 15.2239 24 15.5 24V23.5ZM12.1667 22.1667L11.8131 22.5202C12.0084 22.7155 12.325 22.7155 12.5202 22.5202L12.1667 22.1667ZM10.8333 20.8333L10.4798 20.4798C10.386 20.5735 10.3333 20.7007 10.3333 20.8333C10.3333 20.9659 10.386 21.0931 10.4798 21.1869L10.8333 20.8333ZM9.5 17.5H9C9 17.7761 9.22386 18 9.5 18V17.5ZM9.5 15.5V15C9.22386 15 9 15.2239 9 15.5H9.5ZM10.8333 12.1667L10.4798 11.8131C10.386 11.9069 10.3333 12.0341 10.3333 12.1667C10.3333 12.2993 10.386 12.4265 10.4798 12.5202L10.8333 12.1667ZM12.1667 10.8333L12.5202 10.4798C12.4265 10.386 12.2993 10.3333 12.1667 10.3333C12.0341 10.3333 11.9069 10.386 11.8131 10.4798L12.1667 10.8333ZM12.7686 11.4353L12.4151 11.7888L12.7686 11.4353ZM11.4353 12.7686L11.0817 13.1222L11.4353 12.7686ZM21.5647 20.2314L21.2112 20.5849L21.5647 20.2314ZM21.5647 12.7686L21.2112 12.4151L21.5647 12.7686ZM15.5 10H17.5V9H15.5V10ZM17 9.5V10.3039H18V9.5H17ZM20.5849 11.7888L21.1869 11.1869L20.4798 10.4798L19.8778 11.0817L20.5849 11.7888ZM20.4798 11.1869L21.8131 12.5202L22.5202 11.8131L21.1869 10.4798L20.4798 11.1869ZM21.8131 11.8131L21.2112 12.4151L21.9183 13.1222L22.5202 12.5202L21.8131 11.8131ZM22.6961 16H23.5V15H22.6961V16ZM23 15.5V17.5H24V15.5H23ZM23.5 17H22.6961V18H23.5V17ZM21.2112 20.5849L21.8131 21.1869L22.5202 20.4798L21.9183 19.8778L21.2112 20.5849ZM21.8131 20.4798L20.4798 21.8131L21.1869 22.5202L22.5202 21.1869L21.8131 20.4798ZM21.1869 21.8131L20.5849 21.2112L19.8778 21.9183L20.4798 22.5202L21.1869 21.8131ZM17 22.6961V23.5H18V22.6961H17ZM17.5 23H15.5V24H17.5V23ZM16 23.5V22.6961H15V23.5H16ZM12.4151 21.2112L11.8131 21.8131L12.5202 22.5202L13.1222 21.9183L12.4151 21.2112ZM12.5202 21.8131L11.1869 20.4798L10.4798 21.1869L11.8131 22.5202L12.5202 21.8131ZM11.1869 21.1869L11.7888 20.5849L11.0817 19.8778L10.4798 20.4798L11.1869 21.1869ZM10.3039 17H9.5V18H10.3039V17ZM10 17.5V15.5H9V17.5H10ZM9.5 16H10.3039V15H9.5V16ZM11.7888 12.4151L11.1869 11.8131L10.4798 12.5202L11.0817 13.1222L11.7888 12.4151ZM11.1869 12.5202L12.5202 11.1869L11.8131 10.4798L10.4798 11.8131L11.1869 12.5202ZM11.8131 11.1869L12.4151 11.7888L13.1222 11.0817L12.5202 10.4798L11.8131 11.1869ZM16 10.3039V9.5H15V10.3039H16ZM19.6667 16.5C19.6667 14.7511 18.2489 13.3333 16.5 13.3333V14.3333C17.6966 14.3333 18.6667 15.3034 18.6667 16.5H19.6667ZM16.5 19.6667C18.2489 19.6667 19.6667 18.2489 19.6667 16.5H18.6667C18.6667 17.6966 17.6966 18.6667 16.5 18.6667V19.6667ZM12.4151 11.7888C13.738 13.1118 16 12.1748 16 10.3039H15C15 11.2839 13.8151 11.7747 13.1222 11.0817L12.4151 11.7888ZM10.3039 16C12.1748 16 13.1118 13.738 11.7888 12.4151L11.0817 13.1222C11.7747 13.8151 11.2839 15 10.3039 15V16ZM11.7888 20.5849C13.1118 19.262 12.1748 17 10.3039 17V18C11.2839 18 11.7747 19.1849 11.0817 19.8778L11.7888 20.5849ZM17 10.3039C17 12.1748 19.262 13.1118 20.5849 11.7888L19.8778 11.0817C19.1849 11.7747 18 11.2839 18 10.3039H17ZM13.3333 16.5C13.3333 18.2489 14.7511 19.6667 16.5 19.6667V18.6667C15.3034 18.6667 14.3333 17.6966 14.3333 16.5H13.3333ZM16 22.6961C16 20.8252 13.738 19.8882 12.4151 21.2112L13.1222 21.9183C13.8151 21.2253 15 21.7161 15 22.6961H16ZM20.5849 21.2112C19.262 19.8882 17 20.8252 17 22.6961H18C18 21.7161 19.1849 21.2253 19.8778 21.9183L20.5849 21.2112ZM22.6961 17C20.8252 17 19.8882 19.262 21.2112 20.5849L21.9183 19.8778C21.2253 19.1849 21.7161 18 22.6961 18V17ZM21.2112 12.4151C19.8882 13.738 20.8252 16 22.6961 16V15C21.7161 15 21.2253 13.8151 21.9183 13.1222L21.2112 12.4151ZM14.3333 16.5C14.3333 15.3034 15.3034 14.3333 16.5 14.3333V13.3333C14.7511 13.3333 13.3333 14.7511 13.3333 16.5H14.3333Z",fill:e})),ma=e=>{const t=l.useContext(ue).onMount,[i,s]=l.useState(!1),[a,n]=l.useState(!1),r=e.viewModels.assistantLayoutViewModel,c=e.viewModels.assistantHeaderViewModel,d=e.viewModels.user.view((e=>e.isAnonymous)),p=l.useContext(is.O.Context),u=(0,o.pipe)(e.viewModels.assistantProofitViewModel,Ie.map((e=>e.feature)),Ie.map((e=>l.createElement(F.F.Fragment,null,(0,te.aj)([e.layoutCreated,r.activeView.view((t=>t.type===e.assistantViewType()))]).pipe((0,g.U)((([t,i])=>t?l.createElement(fs.u,{message:p.proofitTooltip,showDelay:ca.gk,disabled:i},l.createElement("div",{"data-grammarly-part":"assistant-header-action-btn-proofit",className:ta.headerActionBtn},l.createElement(da.h,{onClick:()=>i?r.popActiveView():r.pushActiveView({type:e.assistantViewType()})},l.createElement(pa.g,null,l.createElement("div",{className:ta.headerActionBtnProofitIcon}))))):null)))))),Ie.toNullable);return l.createElement(fs.u,{message:"Grab and drag to move panel",showDelay:ca.gk,disabled:i},l.createElement("div",Object.assign({},(0,F.Sh)(ta.header,a&&ta.actions_hovered),{ref:t,onMouseDown:()=>s(!0),onMouseOut:()=>s(!1)}),l.createElement(ia,{headerVM:c}),l.createElement(ga,null),l.createElement("div",{className:ta.headerActions,onMouseOver:()=>n(!0),onMouseOut:()=>n(!1)},u,l.createElement(F.F.Fragment,null,d.view((e=>!e&&l.createElement(fs.u,{message:p.setGoalsTooltip,showDelay:ca.gk},l.createElement("div",{"data-grammarly-part":"assistant-header-action-btn-set-goals",className:ta.headerActionBtn},l.createElement(da.h,{onClick:()=>c.open("setGoals")},l.createElement(ua,null))))))),l.createElement(F.F.Fragment,null,F.hg.combine(r.activeView,d,((e,t)=>{const i=e.type===rt.aH.Type.settings;return!t&&l.createElement(fs.u,{message:"Settings",showDelay:ca.gk,disabled:i},l.createElement("div",{"data-grammarly-part":"assistant-header-action-btn-settings",className:ta.headerActionBtn},l.createElement(da.h,{onClick:()=>i?r.popActiveView():r.pushActiveView({type:rt.aH.Type.settings})},l.createElement(ha,null))))}))),l.createElement(fs.u,{message:"Close panel",showDelay:ca.gk},l.createElement("div",{"data-grammarly-part":"assistant-header-action-btn-close",className:ta.headerActionBtn},l.createElement(ps.P,{onClick:()=>e.close()}))))))},ga=()=>l.createElement("div",{className:ta.draggableWrapper},l.createElement("svg",{className:ta.draggable,width:"20",height:"20",viewBox:"6 6 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 11C14.5523 11 15 10.5523 15 10C15 9.44771 14.5523 9 14 9C13.4477 9 13 9.44771 13 10C13 10.5523 13.4477 11 14 11ZM14 15C14.5523 15 15 14.5523 15 14C15 13.4477 14.5523 13 14 13C13.4477 13 13 13.4477 13 14C13 14.5523 13.4477 15 14 15ZM15 18C15 18.5523 14.5523 19 14 19C13.4477 19 13 18.5523 13 18C13 17.4477 13.4477 17 14 17C14.5523 17 15 17.4477 15 18ZM14 23C14.5523 23 15 22.5523 15 22C15 21.4477 14.5523 21 14 21C13.4477 21 13 21.4477 13 22C13 22.5523 13.4477 23 14 23ZM19 10C19 10.5523 18.5523 11 18 11C17.4477 11 17 10.5523 17 10C17 9.44771 17.4477 9 18 9C18.5523 9 19 9.44771 19 10ZM18 15C18.5523 15 19 14.5523 19 14C19 13.4477 18.5523 13 18 13C17.4477 13 17 13.4477 17 14C17 14.5523 17.4477 15 18 15ZM19 18C19 18.5523 18.5523 19 18 19C17.4477 19 17 18.5523 17 18C17 17.4477 17.4477 17 18 17C18.5523 17 19 17.4477 19 18ZM18 23C18.5523 23 19 22.5523 19 22C19 21.4477 18.5523 21 18 21C17.4477 21 17 21.4477 17 22C17 22.5523 17.4477 23 18 23Z",fill:"#6D758D"})));var fa=i(55364);const va=({layoutVM:e,onClickBack:t,children:i})=>{const[s,a]=l.useState(!1);return l.createElement(Ct,{dataPartName:"proofit-view-overlay",layoutVM:e,panelClassName:fa.proofitViewOverlayPanel,onClickBack:t},l.createElement("div",{className:fa.proofitViewOverlayContent,tabIndex:-1,ref:e=>{null===e||s||(e.focus(),a(!0))}},l.createElement("div",{className:Et.defaultViewOverlayHeader},l.createElement("div",{className:fa.proofitViewOverlayHeader},"Expert Writing Help",l.createElement(ds,{browser:e.browser,className:fa.proofitViewOverlayHeaderBetaBadge}))),i))};var _a=i(24606),wa=i(81108),ya=i(26479),Ea=i.n(ya),Ca=i(83765),Sa=i.n(Ca);const ba=({turnaroundTime:e,freeTrialQuota:t,onSubmit:i,disabledInfo:s,isLoading:a,style:n,onTogglePrivacyInfo:r,showPrivacyInfo:o})=>{const[c,d]=l.useState(null!=o&&o),p=t>0?t:0;return l.useEffect((()=>{null==r||r(c)}),[c]),l.useEffect((()=>{d(null!=o&&o)}),[o]),l.createElement(ns.j.div,{"data-grammarly-part":"proofit-request-form",style:{width:"100%",height:"100%",...n}},l.createElement(rs.b,null,Sa().__css),l.createElement("div",{className:Sa().proofitRequestForm},c?l.createElement(l.Fragment,null,l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoTitle},"How we protect you"),l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoDescription},l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoDescriptionItem},l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoDescriptionItemBulletPoint}),l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoDescriptionItemText},"Our writing experts will see only your current email draft—no prior messages or contact details.")),l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoDescriptionItem},l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoDescriptionItemBulletPoint}),l.createElement("div",{className:Sa().proofitRequestFormPrivacyInfoDescriptionItemText},"We will not sell, rent, or make public any of your personal data."))),l.createElement(_a.z,{kind:"neutral",onClick:()=>d(!1)},"Continue")):l.createElement(l.Fragment,null,l.createElement("div",{className:Sa().proofitRequestFormImg}),l.createElement("div",{className:Sa().proofitRequestFormTitle},"Get instant writing help"),l.createElement("div",{className:Sa().proofitRequestFormDescription},"Our writing experts are standing by to review your email."),l.createElement("div",{className:Sa().proofitRequestFormCostAndTime},l.createElement("div",{className:Sa().proofitRequestFormCost},l.createElement("div",{className:Sa().proofitRequestFormCostAndTimeTitle},p," free ",V._6(p,"review","reviews")),l.createElement("div",{className:Sa().proofitRequestFormCostAndTimeSubtitle},"left this month",l.createElement("sup",null,"*"))),l.createElement("div",{className:Sa().proofitRequestFormTime},l.createElement("div",{className:Sa().proofitRequestFormCostAndTimeTitle},e," seconds"),l.createElement("div",{className:Sa().proofitRequestFormCostAndTimeSubtitle},"average turnaround"))),l.createElement(_a.z,{kind:Boolean(s)?"neutral":"primary",containerClassName:Sa().proofitRequestFormRequestBtn,disabled:Boolean(s||a),onClick:i},a?l.createElement(ns.j.div,null,l.createElement(rs.b,null,Ea().__css),l.createElement("div",{className:Ea().proofitRequestFormBtnLoadingSpinner})):"Request now"),s||a?s?l.createElement("div",{className:Sa().proofitRequestFormUnavailableMsg},l.createElement(wa.Q,{info:s})):null:l.createElement(_a.z,{kind:"link",onClick:()=>d(!0)},"Learn how we protect your privacy"),l.createElement("div",{className:Sa().proofitRequestFormFreeTrialFootnote},l.createElement("span",null,l.createElement("sup",null,"*")," included with your Premium subscription")))))};ba.defaultProps={disabledInfo:null,isLoading:!1};const ka=({layoutVM:e,proofitVM:t})=>{const i=me(),[s,a]=l.useState(!1);return l.createElement(va,{layoutVM:e,onClickBack:()=>{s?a(!1):e.popActiveView()}},l.createElement(F.F.Fragment,null,(0,te.aj)([t.feature.layoutCreated,t.feature.requestInfo,t.feature.turnaroundTime,t.feature.quotaRemaining,t.feature.requestDisabledInfo]).pipe((0,g.U)((([e,n,r,o,c])=>e&&n.status!==Bt.u.RequestStatus.REVIEWING?l.createElement(ba,{turnaroundTime:r,freeTrialQuota:o,onSubmit:()=>t.onSubmitRequest(i),style:{height:"calc(100% - 48px)"},disabledInfo:c,isLoading:n.status===Bt.u.RequestStatus.PREPARING||n.status===Bt.u.RequestStatus.PRE_SUBMIT,showPrivacyInfo:s,onTogglePrivacyInfo:a}):null)))))};var xa=i(65669),Ma=i.n(xa);const Aa=({suggestionsMade:e,onAccept:t})=>l.createElement(ns.j.div,{"data-grammarly-part":"proofit-review-form"},l.createElement(rs.b,null,Ma().__css),l.createElement("div",{className:Ma().proofitReviewForm},l.createElement("div",{className:Ma().proofitReviewFormImg}),l.createElement("div",{className:Ma().proofitReviewFormTitle},"Our experts made ",e," ",V._6(e,"suggestion","suggestions")),l.createElement("div",{className:Ma().proofitReviewFormDescription},"Their changes are highlighted in your email."),l.createElement(_a.z,{onClick:t},"Done"))),La=({layoutVM:e,proofitVM:t})=>{const i=me();return l.createElement(va,{layoutVM:e},l.createElement(F.F.Fragment,null,(0,te.aj)([t.feature.layoutCreated,t.feature.requestInfo]).pipe((0,g.U)((([e,s])=>e&&s.status===Bt.u.RequestStatus.REVIEWING?l.createElement(Aa,{suggestionsMade:s.suggestionsMade,onAccept:()=>t.onCompleteRequest(i)}):null)))))};var Ra=i(47960);const Ia=({feedbackVM:e,className:t})=>l.createElement(fs.u,{showDelay:ca.gk,message:"Leave feedback"},l.createElement("div",Object.assign({},(0,F.Sh)(Lt.feedback_button,t),{onClick:()=>e.openFeedback(),"data-grammarly-part":"assistant-feedback-btn"}),l.createElement(Ra.A,{color:k.Z.blue50}),"Anything we can improve?"));var Ta=i(4432),Va=i(62337),Fa=i(25122),Pa=i(89271),Oa=i(25553),Ha=i(76539),Na=i.n(Ha);const Ua=({message:e})=>{const t=e.view((e=>({content:e}))),[i,s]=function(){const e=l.useRef(new ee.X({highlights:new Map})),t=l.useRef(null);return l.useEffect((()=>{if(!t.current)return;const i=document.createRange();i.selectNodeContents(t.current);const s=t.current.getBoundingClientRect(),a=Da(i,{top:-s.top,left:-s.left},[1,.2]);e.current.next({highlights:a})}),[t.current]),[t,e]}();return l.createElement(l.Fragment,null,l.createElement(Cs,{summaryVM:{summary:t},className:Na().summaryWrapper}),l.createElement("div",{className:Na().message},l.createElement(Pa.S,{className:Na().heatmap,heatmap:s.current}),l.createElement("div",{ref:i},"Highlighted areas are what someone is most likely to read."),l.createElement("div",{className:Na().secondLine},"If your main points are not highlighted, readers might miss them.")))};function Da(e,t,i){return(0,Oa.X)(new Map([[Fa.f.Range.Id.create(),{rects:Array.from(Ta.R.collateRects(Array.from(e.getClientRects()),Va.Wm.create)).map((e=>Va.Wm.create({top:e.top+t.top,left:e.left+t.left,width:e.width,height:e.height}))),meta:{intensity:i,range:{start:0,end:0},isLocal:!1}}]]))}var Ba=i(36145);const Za=()=>l.createElement("svg",{width:"5",height:"5",viewBox:"0 0 5 5",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",fill:k.Z.neutral90}));class qa extends l.Component{render(){return this._idSuffix=this._idSuffix||"clipboard_"+qa._nextIdSuffix++,l.createElement("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("g",{clipPath:`url(#clip0_${this._idSuffix})`},l.createElement("path",{d:"M13.5 14.6001C13.5 15.1498 13.0677 15.6001 12.54 15.6001H3.46C2.93225 15.6001 2.5 15.1498 2.5 14.6001V2.85059C2.5 2.30084 2.93225 1.85059 3.46 1.85059H12.54C13.0677 1.85059 13.5 2.30084 13.5 2.85059V14.6001Z",fill:"#B47D56"}),l.createElement("path",{d:"M13.0661 15.35H3.43408V13.4585L12.6803 6.31396L13.0661 15.35Z",fill:`url(#paint0_linear_${this._idSuffix})`}),l.createElement("path",{d:"M3.32324 2.97559C3.32324 2.97559 3.40224 8.82509 3.25049 14.9751H12.75C12.664 8.82509 12.6772 2.97559 12.6772 2.97559H3.32324Z",fill:"white"}),l.createElement("path",{d:"M11.5 5.3501H6.5V5.6001H11.5V5.3501Z",fill:"#6E8189"}),l.createElement("path",{d:"M11.5 7.8501H6.5V8.1001H11.5V7.8501Z",fill:"#6E8189"}),l.createElement("path",{d:"M11.5 10.3501H6.5V10.6001H11.5V10.3501Z",fill:"#6E8189"}),l.createElement("path",{d:"M11.5 12.8501H6.5V13.1001H11.5V12.8501Z",fill:"#6E8189"}),l.createElement("path",{d:"M5.81201 2.87137C5.81201 2.87137 5.82276 2.39812 6.11126 2.29287C6.26901 2.23537 7.28751 1.91162 7.28751 1.91162C7.28751 1.91162 7.35926 2.85137 5.81201 2.87137Z",fill:"#B3C2C6"}),l.createElement("path",{d:"M10.1869 2.87137C10.1869 2.87137 10.1762 2.39812 9.88769 2.29287C9.73044 2.23537 8.71194 1.91162 8.71194 1.91162C8.71194 1.91162 8.64019 2.85137 10.1869 2.87137Z",fill:"#B3C2C6"}),l.createElement("path",{d:"M5.4936 2.46876C5.46235 2.38726 5.60835 2.36576 5.65435 2.40126C5.83685 2.54426 5.94085 2.61126 5.9746 2.61176C6.5781 2.62051 6.6231 2.53701 6.6646 2.63076C5.49885 3.06426 5.75285 3.13901 5.4936 2.46876Z",fill:"#6E8189"}),l.createElement("path",{d:"M10.506 2.46974C10.5372 2.38824 10.3912 2.36673 10.3457 2.40223C10.1632 2.54524 10.0592 2.61174 10.0249 2.61224C9.42145 2.62099 9.37645 2.53749 9.33545 2.63074C10.5012 3.06524 10.2472 3.13999 10.506 2.46974Z",fill:"#6E8189"}),l.createElement("path",{d:"M10.5055 2.8331C10.1408 2.7661 9.42651 2.6271 9.38551 2.6271C9.35476 2.6271 9.29901 2.57135 9.29901 2.5411C9.29901 2.34035 9.29901 1.92185 9.29901 1.75835C9.29901 1.65685 8.88501 1.48235 8.79376 1.3551C8.64926 1.15135 8.59401 0.600098 7.99951 0.600098C7.40526 0.600098 7.35001 1.15135 7.20501 1.3551C7.11426 1.48285 6.69976 1.65685 6.69976 1.75835C6.69976 1.92185 6.69976 2.34035 6.69976 2.5411C6.69976 2.57135 6.64401 2.6271 6.61376 2.6271C6.57226 2.6271 5.85851 2.76685 5.49326 2.8331C5.10801 2.90435 4.99951 3.6001 4.99951 3.6001H7.99951H10.9993C10.9993 3.6001 10.8908 2.90435 10.5055 2.8331ZM7.99951 1.5421C7.79251 1.5421 7.62451 1.3746 7.62451 1.1671C7.62451 0.959598 7.79251 0.792098 7.99951 0.792098C8.20701 0.792098 8.37451 0.959598 8.37451 1.1671C8.37451 1.3746 8.20701 1.5421 7.99951 1.5421Z",fill:`url(#paint1_linear_${this._idSuffix})`}),l.createElement("path",{d:"M7.99961 0.766602C7.77836 0.766602 7.59961 0.946352 7.59961 1.1671C7.59961 1.38785 7.77836 1.5676 7.99961 1.5676C8.22086 1.5676 8.39961 1.38785 8.39961 1.1671C8.39961 0.946352 8.22086 0.766602 7.99961 0.766602ZM7.99961 1.4531C7.84136 1.4531 7.71336 1.3251 7.71336 1.1666C7.71336 1.00885 7.84136 0.880352 7.99961 0.880352C8.15836 0.880352 8.28611 1.00885 8.28611 1.1666C8.28636 1.3251 8.15836 1.4531 7.99961 1.4531Z",fill:`url(#paint2_linear_${this._idSuffix})`}),l.createElement("path",{d:"M5.875 4.7251V5.9751H4.625V4.7251H5.875ZM6 4.6001H4.5V6.1001H6V4.6001Z",fill:"#6E8189"}),l.createElement("path",{d:"M5.875 7.2251V8.4751H4.625V7.2251H5.875ZM6 7.1001H4.5V8.6001H6V7.1001Z",fill:"#6E8189"}),l.createElement("path",{d:"M5.875 9.7251V10.9751H4.625V9.7251H5.875ZM6 9.6001H4.5V11.1001H6V9.6001Z",fill:"#6E8189"}),l.createElement("path",{d:"M5.875 12.2251V13.4751H4.625V12.2251H5.875ZM6 12.1001H4.5V13.6001H6V12.1001Z",fill:"#6E8189"}),l.createElement("path",{d:"M6.30128 4.66504C6.04928 4.74229 5.55128 4.98329 5.29353 5.55529C5.29353 5.55529 5.08803 5.28229 4.90578 5.20904C4.85403 5.20704 4.72278 5.21879 4.63428 5.31604C4.63428 5.31604 4.89353 5.39029 5.27978 5.97729C5.37303 5.91429 5.53128 5.81529 5.53128 5.81529C5.74378 5.14479 6.14403 4.83329 6.34328 4.70779C6.32953 4.69279 6.31603 4.67829 6.30128 4.66504Z",fill:"#E81C27"})),l.createElement("defs",null,l.createElement("linearGradient",{id:"paint0_linear_"+this._idSuffix,x1:"8.25008",y1:"15.35",x2:"8.25008",y2:"6.31419",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#1A1626",stopOpacity:"0.05"}),l.createElement("stop",{offset:"0.0917",stopColor:"#1A1626",stopOpacity:"0.0706"}),l.createElement("stop",{offset:"0.6667",stopColor:"#1A1626",stopOpacity:"0.2"})),l.createElement("linearGradient",{id:"paint1_linear_"+this._idSuffix,x1:"7.99939",y1:"3.6001",x2:"7.99939",y2:"0.600098",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#7E8A8F"}),l.createElement("stop",{offset:"0.0221",stopColor:"#9CA7AC"}),l.createElement("stop",{offset:"0.0502",stopColor:"#BBC6CB"}),l.createElement("stop",{offset:"0.0777",stopColor:"#D1DBE0"}),l.createElement("stop",{offset:"0.1038",stopColor:"#DEE9EE"}),l.createElement("stop",{offset:"0.1273",stopColor:"#E3EDF2"}),l.createElement("stop",{offset:"0.2545",stopColor:"#CFD8DD"}),l.createElement("stop",{offset:"0.4655",stopColor:"#CCD5DA"}),l.createElement("stop",{offset:"0.6185",stopColor:"#C3CCD1"}),l.createElement("stop",{offset:"0.7531",stopColor:"#B3BDC2"}),l.createElement("stop",{offset:"0.8766",stopColor:"#9DA8AD"}),l.createElement("stop",{offset:"0.9924",stopColor:"#808C91"}),l.createElement("stop",{offset:"1",stopColor:"#7E8A8F"})),l.createElement("linearGradient",{id:"paint2_linear_"+this._idSuffix,x1:"7.99961",y1:"1.56738",x2:"7.99961",y2:"0.766602",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#D9E3E8"}),l.createElement("stop",{offset:"0.1606",stopColor:"#D5DFE3"}),l.createElement("stop",{offset:"0.3396",stopColor:"#C7D1D6"}),l.createElement("stop",{offset:"0.5274",stopColor:"#B2BBC0"}),l.createElement("stop",{offset:"0.7214",stopColor:"#939DA1"}),l.createElement("stop",{offset:"0.9182",stopColor:"#6C7679"}),l.createElement("stop",{offset:"1",stopColor:"#5A6366"})),l.createElement("clipPath",{id:"clip0_"+this._idSuffix},l.createElement("rect",{width:"16",height:"16",fill:"white",transform:"translate(0 0.100098)"}))))}}qa._nextIdSuffix=0;var Ga=i(60430),za=i(8479);const Ka=({viewModel:e})=>{const t=e.height.pipe(g.U(Ie.fold(Ue.constUndefined,(()=>za.animateChecklistHeightChanges))));return l.createElement(F.F.div,Object.assign({},(0,F.Sh)(za.checklistAnimationWrapper,t),{style:{height:e.height.pipe(g.U(Ie.getOrElse(Ue.constUndefined)))}}),T.UI.mount($a,function(e){return Qe.Z.animatingFlow(e,((e,t)=>Ie.isNone(e)?Ie.none:e.value.kind===t.kind?Ie.some(ys.Hk("fadeOutContentChange","fadeInContentChange")):"expanded"===t.kind?Ie.some(ys.Hk("fadeOut","expand")):Ie.some(ys.Hk("collapse","fadeIn"))))}((i=e,Qe.Z.fromSideEffect((({action:e})=>{switch(e.kind){case"expand":i.expand();break;case"height":i.changeHeight(e.height);break;default:(0,ce.vE)(e)}}),i.state.pipe(g.U((e=>({kind:e.collapsed?"collapsed":"expanded",items:e.items})))))))));var i},Wa=T.UI.Node.make((({view:e,notify:t})=>{const i=e("items").pipe(g.U((e=>e.filter((e=>e.checked))))),s=e("items").pipe(g.U((e=>e.filter((e=>!e.checked))))),a=new J.t;return Ga.P.useSubscriptionTo(a.pipe(u.w((e=>_e.YC(e).pipe(g.U((()=>e.offsetHeight)),h.O(e.offsetHeight)))),v.b((e=>t({kind:"height",height:e})())))),l.createElement("div",{className:za.checklistExpanded,ref:e=>{null!==e&&a.next(e)},"data-grammarly-part":"attention-checklist-expanded"},l.createElement(F.F.Fragment,null,s.pipe(g.U((e=>l.createElement(l.Fragment,null,e.length>0&&l.createElement("div",{className:za.checklistGroupHeader},"Room for improvement"),e.map((({message:e},t)=>l.createElement(ja,{checked:!1,key:t,message:e})))))))),l.createElement(F.F.Fragment,null,i.pipe(g.U((e=>l.createElement(l.Fragment,null,e.length>0&&l.createElement("div",{className:za.checklistGroupHeader},"What's good"),e.map((({message:e},t)=>l.createElement(ja,{checked:!0,key:t,message:e})))))))))})),ja=({message:e,checked:t})=>l.createElement("div",{className:za.checklistItem},l.createElement("div",{className:za.itemBullet},t?l.createElement(Ba.x,{width:12,height:12}):l.createElement(Za,null)),l.createElement("div",Object.assign({},(0,F.Sh)(za.itemText,t&&za.checked)),e)),Xa=T.UI.Node.make((({view:e,notify:t})=>{const i=e("items").pipe(g.U((0,Ue.flow)((e=>Ie.fromNullable(e.filter((e=>!e.checked)).concat(e.filter((e=>e.checked)))[0])),Ie.map((e=>e.message))))),s=new J.t;return Ga.P.useSubscriptionTo(s.pipe(u.w((e=>_e.YC(e).pipe(g.U((()=>e.offsetHeight)),h.O(e.offsetHeight)))),v.b((e=>t({kind:"height",height:e})())))),l.createElement("div",{className:za.checklistCollapsed,ref:e=>{null!==e&&s.next(e)},"data-grammarly-part":"attention-checklist-collapsed"},l.createElement(R.M,{clickHandler:t({kind:"expand"}),style:{display:"block"}},l.createElement("div",{className:za.checklistHeader},l.createElement(qa,null),l.createElement(F.F.div,{className:za.checklistTitle},e("items").pipe(g.U((e=>`Checklist: ${e.filter((e=>e.checked)).length} of ${e.length} completed`))))),l.createElement(F.F.div,{className:za.checklistFirstItemPreview},i.pipe(g.U(Ie.getOrElse((()=>"")))))))})),Ya=T.UI.Union.make("kind",{collapsed:Xa,expanded:Wa}),Qa=T.UI.Transition.make({fadeIn:za.fadeIn,fadeInContentChange:za.fadeInContentChange,expand:za.expand},{fadeOut:za.fadeOut,fadeOutContentChange:za.fadeOutContentChange,collapse:za.collapse}),$a=T.UI.Animated.make(Qa,Ya);var Ja=i(82318);const en=l.forwardRef((({viewModels:e,readersAttentionVM:t},i)=>l.createElement(Ct,{dataPartName:"readers-attention-view-overlay",layoutVM:e.assistantLayoutViewModel,panelClassName:Ja.readersAttentionViewOverlayPanel},l.createElement(zs,{key:"takeawaysPredictionCardList",ref:i,viewModels:e,header:l.createElement(tn,{readersAttentionVM:t,layoutVM:e.assistantLayoutViewModel}),footer:l.createElement(Ia,{feedbackVM:e.assistantFeedbackViewModel})})))),tn=({readersAttentionVM:e,layoutVM:t})=>l.createElement(l.Fragment,null,l.createElement("div",{className:Et.defaultViewOverlayHeader},l.createElement("div",{className:Ja.readersAttentionViewOverlayHeader},"Reader′s attention",l.createElement(ds,{browser:t.browser,className:Ja.readersAttentionViewOverlayHeaderBetaBadge}))),l.createElement(Ua,{message:e.headerMessage}),l.createElement("div",{className:Xs.relatedSuggestionsTitle},"SUGGESTIONS"),l.createElement(Ka,{viewModel:e.checklistViewModel}));var sn=i(19106),an=i(26485),nn=i(17324),rn=i(68089);const on=({children:e,blocked:t,wrapperClassName:i})=>t?l.createElement(fs.u,{message:"Sign in to use this feature",position:"top"},l.createElement("div",{className:i},l.createElement("div",{className:rn.hover_blocker,onClick:ce.EI,onDoubleClick:ce.EI},e))):l.createElement(l.Fragment,null,e);class ln extends l.Component{constructor(){super(...arguments),this.handleChange=e=>{(this.props.skipTrustedCheck||e.isTrusted)&&this.props.onChange(e)}}render(){return l.createElement("div",Object.assign({},(0,F.Sh)(this.props.extraClassName,an.setting_item,this.props.disabled&&an.disabled)),l.createElement("label",{className:an.select_checkbox,"data-grammarly-part":this.props.dataGrammarlyPart},l.createElement("div",null,this.props.children,this.props.beta&&l.createElement("span",{className:(0,js.G6)()?an.new:an.beta})),l.createElement(on,{wrapperClassName:an.checkbox_control_wrapper,blocked:this.props.disabled}),l.createElement("input",{className:an.checkbox,onChange:this.props.disabled?ce.EI:this.handleChange,checked:this.props.checked,type:"checkbox"}),l.createElement("div",Object.assign({},(0,F.Sh)(an.checkbox_check,this.props.grayOut&&an.grayOut,this.props.checked?an.on:an.off)),l.createElement("div",Object.assign({},(0,F.Sh)(an.on_off)),this.props.checked?"ON":"OFF"),l.createElement("div",{className:an.checkbox_check_round}))),l.createElement("div",{className:an.bottom_line}))}}var cn=i(72307),dn=i(47740);const pn=({showTitle:e,openGBLanding:t})=>l.createElement("div",{className:dn.container},l.createElement("div",{className:dn.contant},e&&l.createElement("div",{className:dn.title},"Grammarly for your team"),l.createElement("div",null,"Help your team make your business look great with top-notch writing."),l.createElement("div",{className:dn.spacer}),l.createElement(_a.z,{size:"medium",onClick:()=>{t((0,js.Um)().businessEHomepage),(0,cn.T)().gGbUpHookClick()}},"Explore Grammarly Business")));var un=i(12649);const hn=new Proxy({},{get:(e,t)=>(...e)=>un.emitBackground("gnar-track",{method:t,props:e})});class mn extends l.Component{constructor(){super(...arguments),this.onEnableDefsClick=e=>{const{toggleDefs:t}=this.props,i=e.target.checked;t(i),hn.definitionToggleClick(i?"on":"off"),(0,cn.T)().toggleExtensionDefs(i)}}render(){const{enabledDefs:e,disabled:t}=this.props;return l.createElement(ln,{onChange:this.onEnableDefsClick,checked:e,extraClassName:nn.def_switcher,dataGrammarlyPart:"definitionAndSynonymsSwitcher",disabled:t,skipTrustedCheck:this.props.skipTrustedCheck},"Show definitions and synonyms ",l.createElement("br",null),"via double clicks (all sites)")}}var gn=i(6304),fn=i(66402);const vn=()=>l.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M13.9207 15L15.5 17.2562L17.0793 15H13.9207Z",stroke:"#6D758D",strokeWidth:"2"}));var _n=i(71527);const wn={american:l.createElement((()=>l.createElement("div",{className:fn.american,role:"presentation"})),null),australian:l.createElement((()=>l.createElement("div",{className:fn.australian,role:"presentation"})),null),british:l.createElement((()=>l.createElement("div",{className:fn.british,role:"presentation"})),null),canadian:l.createElement((()=>l.createElement("div",{className:fn.canadian,role:"presentation"})),null)},yn=["british","american","australian","canadian"],En=e=>{return l.createElement(l.Fragment,null,wn[e.dialect],l.createElement("span",{"data-test-attr":"dialect_"+e.dialect,className:_n.label},(t=e.dialect).charAt(0).toUpperCase()+t.slice(1)+" English"));var t};class Cn extends l.Component{render(){const e=this.props.dropdownOnTop?{customPosition:{top:"-100px",left:"0"},vAlign:"top"}:{customPosition:{top:"36px",left:"0"}};return l.createElement(Mt.L,Object.assign({},e,{showDelay:0,closeDelay:150,appearanceBehavior:"mouseClick",name:"dialect",label:l.createElement(xt.zx.White,{name:"dialect.box",style:{padding:"0"}},l.createElement("div",{className:_n.selected},l.createElement(En,{dialect:this.props.dialect}),l.createElement(vn,null)))}),yn.filter((e=>e!==this.props.dialect)).map((e=>l.createElement(xt.zx.Flat,{name:e,onClick:()=>this.props.onSetDialect(e),key:e},l.createElement("div",{className:_n.option},l.createElement(En,{dialect:e}))))))}}class Sn extends l.Component{constructor(){super(...arguments),this.setDialect=e=>{const{changeStrongDialect:t,dialectWeak:i}=this.props;t(e);const s=e+"English";hn.languageSettingUpdate(s,"user",i&&e===i)}}render(){const e=this.props.dialectStrong||this.props.dialectWeak||"american";return l.createElement("div",Object.assign({},(0,F.Sh)(gn.line,this.props.disabled&&gn.disabled)),l.createElement("div",null,"I write in"),l.createElement(on,{blocked:this.props.disabled},l.createElement("div",{className:gn.dialectPicker},l.createElement(Cn,{dialect:e,onSetDialect:this.setDialect,dropdownOnTop:!!this.props.dropdownOnTop}))))}}const bn=({toggleHotkeys:e,enabledHotkeys:t})=>{const i=((0,js.ED)()?"Alt":"Ctrl")+" + g";return l.createElement(ln,{onChange:t=>{const i=t.target.checked;e(i),hn.hotkeyToggleClick(i?"on":"off")},checked:t,extraClassName:nn.hotkeys},l.createElement("span",{className:nn.shortcut_title},"Shortcut:")," Open Popup editor ",l.createElement("br",null),l.createElement("span",{className:nn.shortcut},i))},kn=e=>{var t;const i="docs.google.com"===e.domain,s=i?"Google Docs":e.domain,a=i&&(null===(t=e.experiments)||void 0===t?void 0:t.anonUserGDocsSidebar),{enabledInConfig:n,siteSwitcherChecked:r,favicon:o}=e,c=r.checked&&n,d=n?"Check for writing suggestions":"Checking is not supported";return l.createElement(ln,{grayOut:!n,onChange:e=>r.update(e.target.checked),checked:c,extraClassName:nn.site_switcher,dataGrammarlyPart:"siteSwitcher",skipTrustedCheck:e.skipTrustedCheck},l.createElement("div",{"data-test-attr":"siteControlsLabelText"},d,l.createElement("br",null)," ",l.createElement("span",{className:nn.domain},l.createElement("span",{className:nn.thin_text},"on")," ",o&&l.createElement("span",{className:nn.favicon},l.createElement("img",{width:"16px",height:"16px",src:o})),s,a&&l.createElement("span",{className:an.beta}))))};var xn=i(37896),Mn=i(23345);const An=l.createContext({}),Ln=e=>{const t=l.useContext(An),{registrationDate:i}=e.user,s=(0,xn.p6)(i);return l.createElement("div",{className:Mn.line},l.createElement("div",{className:Mn.content},s&&l.createElement("div",{"data-test-attr":"checked_since"},"Grammarly has been correcting your text since ",s,"."),l.createElement("div",{className:Mn.upgrade,onClick:()=>{e.openSubscriptionDialog({utmSource:"upHook",utmCampaign:"extensionSettingsToolbar"}),hn.getPremiumButtonClick("settingsToolbar"),(0,cn.T)().userUpgradeClick("settingsToolbar")},style:{fontSize:t.ctaFontSize}},"Go Premium to Enable Advanced Fixes")))},Rn=e=>l.createElement(ln,{onChange:t=>{e.toggle(t.target.checked)},checked:e.enabled,extraClassName:nn.def_switcher},"Correct spelling automatically"),In=e=>l.createElement("div",Object.assign({},(0,F.Sh)(an.setting_item,nn.userPanel,nn.def_switcher)),l.createElement("span",Object.assign({},(0,F.Sh)(nn.link,nn.blue)),l.createElement(R.M,{clickHandler:e.handleClick},"Turn extension back on in Chrome"))),Tn=e=>l.createElement(ln,{onChange:t=>{e.toggle(t.target.checked)},beta:!0,checked:e.enabled,extraClassName:nn.def_switcher},"Show phrasal predictions"),Vn=e=>{var t;const{actions:i,activeTab:s,config:a,settings:n,user:r,siteCategory:o,openSubscriptionDialog:c,openGBLanding:d,showGBUpHook:p,placement:u,showAutocorrectToggle:h,enableRenderingHack:m=!1}=e;m&&l.useEffect((()=>{(0,js.CB)()&&(window.screenLeft<0||window.screenTop<0||window.screenLeft>window.screen.width||window.screenTop>window.screen.height)&&chrome.runtime.getPlatformInfo((e=>{if("mac"===e.os){const e=new CSSStyleSheet;e.insertRule("\n            @keyframes redraw {\n              0% {\n                opacity: 1;\n              }\n              100% {\n                opacity: .99;\n              }\n            }\n          "),e.insertRule("\n            html {\n              animation: redraw 1s linear infinite;\n            }\n          "),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}}))}),[]);const{premium:g,experiments:f,anonymous:v}=r,_=p&&g&&!It.n5.doesUserBelongToInstitution(r),w=g||v,y=f&&f.hotkeysExperiment,E=e.siteSwitcherChecked||{checked:!!n.enabled,update:t=>{const{siteCategory:s}=e;i.toggleSite(t,a.domain),hn.checkingToggleClick("toolbar",s,t?"on":"off"),(0,cn.T)().toggleExtension(t,"toolbar")}};return l.createElement("div",null,n.isLlamaInstalled&&!n.isLlamaDisabled&&l.createElement(In,{handleClick:i.disableLlama}),l.createElement(kn,{domain:a.domain,enabledInConfig:a.enabled,siteSwitcherChecked:E,favicon:null==s?void 0:s.favIconUrl,siteCategory:o,experiments:f}),l.createElement(mn,{disabled:v,enabledDefs:n.enabledDefs,toggleDefs:i.toggleDefs}),y&&l.createElement(bn,{enabledHotkeys:n.enabledHotkeys||!1,toggleHotkeys:i.toggleHotkeys}),h&&l.createElement(Rn,{enabled:n.autocorrectEnabled||!1,toggle:e=>{i.toggleAutocorrect(e),hn.autocorrectToggleClick(e?"on":"off")}}),(null===(t=r.experiments)||void 0===t?void 0:t.autocompleteEnabled)&&l.createElement(Tn,{enabled:n.autocompleteEnabled||!1,toggle:e=>{i.toggleAutocomplete(e),hn.autocompleteFeatureToggleClick("popup",e?"on":"off")}}),l.createElement(Sn,{changeStrongDialect:i.changeStrongDialect,dialectStrong:n.dialectStrong,dialectWeak:n.dialectWeak,dropdownOnTop:w,disabled:v}),!w&&l.createElement(Ln,{user:r,openSubscriptionDialog:c}),_&&l.createElement(pn,{openGBLanding:d,showTitle:"popup"===u}))};var Fn=i(32138),Pn=i(82785),On=i(91574);const Hn=({viewModels:e})=>{const{domain:t,actions:i,state:s}=e.assistantSettingsViewModel,[a,n]=l.useState(!!s.view("commonSettings","enabled").get()),r={checked:a,update:n};return l.createElement(Ct,{dataPartName:"settings-view-overlay",layoutVM:e.assistantLayoutViewModel,panelClassName:Et.gradientViewOverlayPanel,footer:l.createElement(_a.z,{containerClassName:On.settingsDoneButton,kind:"success",type:"submit",onClick:()=>{i.toggleSite(a,t),sn.J.checkingToggleClick("assistant",Pn.y.other,a?"on":"off"),(0,cn.T)().toggleExtension(a,"assistant"),e.assistantLayoutViewModel.popActiveView()},style:{height:"32px"}},"Done")},l.createElement("div",{className:Et.gradientViewOverlayContent},l.createElement("div",{className:Et.defaultViewOverlayHeader},"Settings"),l.createElement(F.F.Fragment,null,s.view((({user:a,commonSettings:n})=>{var o;return l.createElement(An.Provider,{value:{ctaFontSize:13}},l.createElement(Vn,{actions:i,config:{enabled:!0,domain:t},settings:n,user:a,siteCategory:Pn.y.other,openSubscriptionDialog:()=>e.upgradeViewModel.openUpgradeUrl(Ne.Place.extensionSettingsAssistant),openGBLanding:e=>{const t=(0,Fn.Z4)(e,"gbExtensionSettingsAssistant");window.open(t)},showGBUpHook:(0,js.i7)(),placement:"assistant",showAutocorrectToggle:(0,js.i7)()||!!(null===(o=s.view("user","experiments").get())||void 0===o?void 0:o.autoCompleteCorrectAllBrowsers),siteSwitcherChecked:r}))}))),l.createElement(Ia,{feedbackVM:e.assistantFeedbackViewModel})))};var Nn,Un=i(77256),Dn=i(94503),Bn=i(57175);!function(e){let t;!function(e){e.isAppleSystem="isAppleSystem"}(t=e.SidebarFlag||(e.SidebarFlag={})),e.Flag={...t,...Dn.a.Flag},e.Context=l.createContext(Bn.S.invariantContent("Environment"))}(Nn||(Nn={}));class Zn{constructor(){this._flags=new Set,this.actions={openUrl:()=>{throw new Error("Not implemented")},openPopup:()=>{throw new Error("Not implemented")}};(0,Un.O)().config.systemInfo.os.isMac&&this._flags.add(Nn.Flag.isAppleSystem),this._flags.add(Nn.Flag.supportsSVGDominantBaseline),this._flags.add(Nn.Flag.onlyTrustedEvents)}has(e){return this._flags.has(e)}}const qn=({modalManager:e})=>l.createElement(F.F.Fragment,null,e.state.view((0,Ue.flow)(Ie.map((({component:e})=>e)),Ie.toNullable)));var Gn=i(93583);const zn=({children:e,remSize:t,setter:i})=>(Kn+=1,l.useEffect((()=>{const e=t.subscribe((e=>{Wn.next(Ie.some(e)),i(Ie.some(e))}));return()=>{e.unsubscribe(),Kn-=1,0===Kn&&(Wn.next(Ie.none),i(Ie.none))}}),[t]),l.createElement(Gn.u.Context.Provider,{value:Wn.pipe(ve.oA)},e));let Kn=0;const Wn=new ee.X(Ie.none);var jn=i(48189),Xn=i(79850);i(75259),i(67129);const Yn=({children:e})=>l.createElement(l.Fragment,null,l.createElement("div",{"data-grammarly-part":"gdocs-sidebar",className:Xn.wrapper},e),l.createElement(jn.p,{thin:!0,thinItalic:!0,regular:!0,italic:!0,bold:!0,boldItalic:!0,semiBold:!0}));var Qn=i(17161),$n=i(66831),Jn=i(17674),er=i(89068),tr=i(83305);const ir=l.memo((({close:e,viewModels:t,emogenieService:i,height:s,ready:a,OuterElementsPortalSource:n})=>{const r=new Zn;(0,Ke.iR)("viewModels",t);const c=l.useContext(ue).state.pipe($.j("dragging")),d=l.useContext(ue).state.pipe(w.h((e=>!e.dragging)),h.O(de)),p=l.useContext(Qn.Y),u=F.hg.create(Re.UL.empty),{initialPositionOffset:m}=t.positionViewModel;(0,Y.A)((0,te.aj)([d,p]).pipe(g.U((([e,t])=>({height:t.height,width:t.width,top:t.top+e.translate.y+m.top,left:t.left+e.translate.x+m.left,bottom:t.top+t.height+e.translate.y,right:t.left+t.width+e.translate.x}))),v.b(we.wW(u)))),(0,Y.A)(d.pipe(v.b((e=>t.positionViewModel.onDrag(e))))),(0,Y.A)(t.assistantLayoutViewModel.activeView.pipe(_.G(),v.b((([e,i])=>{e.type!==i.type&&i.type===rt.aH.Type.default&&t.cardsListScrollManager.paddingTop.set(0)}))));const f=l.useRef(null);return l.useEffect((()=>{t.assistantCardListViewModel.cardListContext.next(Ie.fromNullable(f.current));const e=f.current?_e.rl(f.current,{subtree:!0,childList:!0}):jt.C,i=u.view((e=>({top:e.top,left:e.left}))),s=(0,o.pipe)(e,er.V((0,pt.m9)(1)),tt.b(10),st.P()).subscribe((()=>a(i,c)),(()=>{a(i,c,!0)}));return()=>{s.unsubscribe()}}),[]),l.createElement(sr,{environment:r,viewport:p.pipe(g.U((e=>({height:e.height,width:e.width,top:e.top,left:e.left,bottom:e.top+e.height,right:e.left+e.width}))))},l.createElement(F.F.div,Object.assign({"data-grammarly-part":"assistant-popup-content"},(0,F.Sh)(Lt.assistant,c.pipe(h.O(!1),g.U((e=>e&&Lt.dragging)))),{style:{height:s,maxHeight:"90vh"}}),l.createElement(ma,{close:e,viewModels:t}),t.assistantLayoutViewModel.activeView.view((e=>e.type===rt.aH.Type.default?l.createElement(Zs,{viewModels:t,ref:f,key:"default-view"}):e.type===rt.aH.Type.emogenie?l.createElement(Ys,{emogenieService:i,viewModels:t,key:"emogenie-view",ref:f}):e.type===rt.aH.Type.readersAttention&&Ie.isSome(t.readersAttentionViewModel)?l.createElement(en,{viewModels:t,readersAttentionVM:t.readersAttentionViewModel.value,key:"readers-attention-view",ref:f}):e.type===rt.aH.Type.feedback?l.createElement(Js,{feedbackVM:t.assistantFeedbackViewModel,layoutVM:t.assistantLayoutViewModel,key:"feedback-view"}):e.type===rt.aH.Type.settings?l.createElement(Hn,{viewModels:t,key:"settings-view"}):e.type===rt.aH.Type.proofitRequest&&Ie.isSome(t.assistantProofitViewModel)?l.createElement(ka,{layoutVM:t.assistantLayoutViewModel,proofitVM:t.assistantProofitViewModel.value,key:"proofit-request-view"}):e.type===rt.aH.Type.proofitReview&&Ie.isSome(t.assistantProofitViewModel)?l.createElement(La,{layoutVM:t.assistantLayoutViewModel,proofitVM:t.assistantProofitViewModel.value,key:"proofit-review-view"}):e.type===rt.aH.Type.personalization?l.createElement(bt.View,{viewModels:t,key:"personalization-view"}):null))),l.createElement(n,null,l.createElement(Yn,null,l.createElement(qn,{modalManager:t.assistantModalManager}))),l.createElement(Jn.X,null))})),sr=({environment:e,viewport:t,children:i})=>{const s=l.useRef((0,is.I)(Fs.m.getConfig(e.has(Nn.Flag.isAppleSystem)?"mac":"windows")));return l.createElement(zn,{remSize:d.of(16),setter:e=>Gn.u.setRootCssVar(document.documentElement,e)},l.createElement(Nn.Context.Provider,{value:e},l.createElement(Dn.a.Context.Provider,{value:e},l.createElement(is.O.Context.Provider,{value:s.current.assistant},l.createElement(Fs.m.Context.Provider,{value:s.current.denali},l.createElement(tr.TG.ContextMock,null,l.createElement(Ls.l.RootVirtualContainer,{viewport:t,name:"draggable"},l.createElement($n.G.DefaultProvider,null,l.createElement(Yn,null,i)))))))))};var ar=i(53447);const nr=e=>{const{assistantLayout:t,textFieldRect:i,close:s,viewModels:a,emogenieService:n,ready:r,height:o,OuterElementsPortalSource:c}=e,{initialPositionOffset:d}=a.positionViewModel,p={...i.client,...i.size},u=(0,ar.C7)();return l.createElement(he,{bounds:u,hasDragHandle:!0},(({translate:e})=>l.createElement(Qn.s,{anchorRect:p,viewportRect:u,anchorOrigin:t.anchorOrigin,elementOrigin:t.assistantOrigin,anchorMargin:t.anchorMargin,repositioning:t.repositioningStrategy,stickToTarget:!1,viewportMargin:0,postRepositioningOffset:{horizontal:d.left+e.x,vertical:d.top+e.y}},(({top:t,left:i})=>l.createElement("div",{"data-grammarly-part":"assistant-popup",style:{position:"fixed",top:t-e.y,left:i-e.x,transform:`translate(${e.x}px, ${e.y}px)`,zIndex:ca.Eq}},l.createElement(ir,{viewModels:a,close:s,emogenieService:n,height:o,ready:r,OuterElementsPortalSource:c}))))))};var rr=i(57078),or=i(39485),lr=i(84966);(0,or.C)();class cr{constructor(e,t){this._params=e,this._felog=t,this._log=y.Y.create(cr.name),this._integration=null,this._viewModels=F.hg.create(null),this._assistantPopupIsReady=new c.xQ,this._initPerformance=void 0,this._openMeasure=void 0,this._height=F.hg.create(0),this.isOpen=F.hg.create(!1),this._subs=new et.w.Keeper,this.open=async(e,t,i)=>{var s,a,n;if(null!==this._viewModels.get()){const t=null===(s=this._viewModels.get())||void 0===s?void 0:s.assistantLayoutViewModel;return void(i===rr.R.emogenie?null==t||t.pushActiveView({type:rt.aH.Type.emogenie}):i===rr.R.proofitRequest?null==t||t.pushActiveView({type:rt.aH.Type.proofitRequest}):i===rr.R.proofitReview?null==t||t.pushActiveView({type:rt.aH.Type.proofitReview}):i===rr.R.takeawayCard&&e&&(null==t||t.pushActiveView({type:rt.aH.Type.readersAttention,caller:{type:rt.T5.Type.inlineCard,alertId:e}})))}this._openMeasure=this._felog.openTime.startMeasure();const r=this._felog.initTime.startMeasure(),l=this._params.assistantService,c=l.createIntegration();if(!c)return this._log.warn("tried to open assistant with checking service not initialized"),r.cancelMeasure(),void this._openMeasure.cancelMeasure();null===(n=(a=this._params).onOpen)||void 0===n||n.call(a,c),this._integration=c;const d=this._params.contentScriptState.view("user").view((e=>({isPremium:e.premium,isAnonymous:e.anonymous,experiments:e.experiments,customFields:e.customFields}))),p=ts(c.engine,c.denaliViewAdapter,c.document.settings.lens("selectedLens"),this._params.emogenieService,l.goalPrediction,Ie.fromNullable(this._params.readersAttentionFeature),Ie.fromNullable(this._params.proofitFeature),l.sidebarEvents,this._assistantPopupIsReady,(0,o.pipe)(Ie.fromNullable(e),Ie.map(lr.wQ.Id.create)),this._params.contentScriptState,this._params.contentScriptActions,this._params.gnar,this._params.domain,d,this._params.userActions.get(),this.close,this._params.assistantService.selectedHighlightsTracker,this._params.assistantService.isTextFieldEmpty,this._params.assistantService.positionModel,this._params.browser);i===rr.R.emogenie?p.assistantLayoutViewModel.pushActiveView({type:rt.aH.Type.emogenie}):i===rr.R.proofitRequest?p.assistantLayoutViewModel.pushActiveView({type:rt.aH.Type.proofitRequest}):i===rr.R.proofitReview?p.assistantLayoutViewModel.pushActiveView({type:rt.aH.Type.proofitReview}):i===rr.R.takeawayCard&&e&&p.assistantLayoutViewModel.pushActiveView({type:rt.aH.Type.readersAttention,caller:{type:rt.T5.Type.inlineCard,alertId:e}}),this._initPerformance=r.endMeasure(),this._viewModels.set(p)},this.close=()=>{var e,t,i,s;null!==this._viewModels.get()&&(null===(t=(e=this._params).onClose)||void 0===t||t.call(e),this.isOpen.set(!1),null===(i=this._integration)||void 0===i||i.dispose(),this._integration=null,null===(s=this._viewModels.get())||void 0===s||s.dispose(),this._viewModels.set(null),this._trackAssistantClose())},this._getReadyFn=()=>{const e=this._felog.renderTime.startMeasure();return(t,i,s)=>{const a=e.endMeasure();s&&this._openMeasure.cancelMeasure();const n=this._openMeasure.endMeasure();n&&n.duration>500&&this._log.warn("assistant popup took too long to open:",{init:this._initPerformance.duration,render:a.duration,total:n.duration}),setTimeout((()=>{this.isOpen.set(!0),this._assistantPopupIsReady.next(),this._trackAssistantOpen(t,null==n?void 0:n.duration),this._trackAssistantDrag(t,i)}),0)}},this._applyIframeOffset=e=>{var t,i;const s=null===(i=(t=this._params).getCustomOffset)||void 0===i?void 0:i.call(t);return s?{...e,size:{width:s.width,height:s.height},client:{...e.client,left:s.left+e.client.left,top:s.top+e.client.top},offset:{...e.offset,left:s.left+e.offset.left,top:s.top+e.offset.top},page:{...e.page,left:s.left+e.page.left,top:s.top+e.page.top}}:e}}get view(){return this._viewModels.pipe((0,u.w)((e=>null===e?(0,d.of)(null):(0,p.R)(window,"resize").pipe((0,h.O)(null),(0,m.M)(this._params.layout.textField.rect.behavior),(0,g.U)((([t,i])=>{const s=this._applyIframeOffset(i),a=((e,t)=>{const i=Oe(e.lensState,e.cardsListScrollManager),s=Math.max(600,t.size.height+E.O.headerHeight+E.O.panelHeight);return i.pipe((0,m.M)(e.predictionsPreviewViewModel.previewState),(0,g.U)((([e,t])=>{if(t.kind!==A.visible)return e;const i=[t.readersAttention,t.tone].filter(Ie.isSome).length;return i>0?e+E.O.predictionsPreviewHeaderHeight+E.O.predictionInsightHeight*i:e})),(0,h.O)(0),(0,g.U)((e=>Math.max(e+E.O.headerHeight,s))),(0,g.U)((e=>Math.min(e,750))))})(e,s).pipe((0,f.R)(this._assistantPopupIsReady.asObservable()),(0,v.b)(we.wW(this._height)));return l.createElement(nr,{textFieldRect:s,assistantLayout:this._params.layout.assistant,height:a,close:this.close,viewModels:e,emogenieService:this._params.emogenieService,ready:this._getReadyFn(),OuterElementsPortalSource:this._params.OuterElementsPortalSource})}))))))}get activeView(){return this._viewModels.pipe((0,u.w)((e=>{var t;return null!==(t=null==e?void 0:e.assistantLayoutViewModel.activeView)&&void 0!==t?t:(0,d.of)(null)})))}dispose(){this.close(),this._subs.dispose()}_trackAssistantOpen(e,t){const i=this._viewModels.get();if(null!=i){const{initialPositionOffset:s}=i.positionViewModel,{statisticsService:a}=this._params,n=a.alertCounts.get(),r=0===s.top&&0===s.left?"default"===this._params.layout.assistant.name?"smart":"hardcoded":"sticky";this._params.gnar.assistantPopupShow(this._height.get(),e.get().left,e.get().top,n.popupEditorSupported,n.freeClarity,n.critical,n.filter((e=>"priority"===e.assistantView)).popupEditorSupported,a.wordsCount.get(),r,t,a.generalScore.get())}}_trackAssistantClose(){const{statisticsService:e}=this._params,t=e.alertCounts.get();this._params.gnar.assistantPopupCloseButtonClick(t.popupEditorSupported,t.freeClarity,t.critical,t.filter((e=>"priority"===e.assistantView)).popupEditorSupported)}_trackAssistantDrag(e,t){const i=e.get();let s=i;this._subs.push(t.pipe((0,_.G)(),(0,w.h)((([e,t])=>e&&!t))).subscribe((()=>{const t=e.get();Ht.E9.l1Distance(t,s)<10||(this._params.gnar.assistantPopupDrag(t.left,t.top,this._height.get(),i.left,i.top),s=t)})))}}var dr=i(34311);class pr{constructor(e){this._originalHoverProvider=e,this._assistantHoverProviderSbj=new ee.X(null)}setAssistantHover(e){this._assistantHoverProviderSbj.next(e)}removeAssistantHover(){this._assistantHoverProviderSbj.next(null)}getHoveredStateBehavior(e){const t=this._originalHoverProvider.getHoveredStateBehavior(e);return this._assistantHoverProviderSbj.pipe((0,u.w)((i=>null==i?t:(0,te.aj)(t,i.getHoveredStateBehavior(e),((e,t)=>t!==dr.pc.none?t:e)))))}}var ur=i(77150),hr=i(40273),mr=i(36991);var gr=i(30067);class fr{constructor(){this._map=new Map,this._highlightDataChanged=new c.xQ}_getVisualization(e){const t=this._map.get(e);return t&&t.visualization}get(e){return this._map.get(e)}has(e){return this._map.has(e)}set(e,t){this._map.set(e,t),this._highlightDataChanged.next(e)}delete(e){this._map.delete(e),this._highlightDataChanged.next(e)}forEach(e){this._map.forEach(e)}getHighlightVisualization(e){return this._highlightDataChanged.pipe((0,w.h)((t=>t===e)),(0,g.U)((()=>this._getVisualization(e))),(0,h.O)(this._getVisualization(e)))}}class vr{constructor(e,t,i,s,a=(()=>Ht.E9.zero),n=y.Y.create(vr.name)){this._denaliHighlights=e,this._getFluidHighlights=t,this._getTextMap=i,this._getParentRect=s,this._getParentScroll=a,this._log=n}registerAlert(e,t,i,s){const a=e;if(null!==a){if(this._denaliHighlights.has(a))return this.update(e,t,i);{const e=new bi.Fd(a,t,this._getFluidHighlights(),this._getParentRect,this._getParentScroll),n={id:a,mark:e,visualization:i};this._denaliHighlights.set(a,n);const r=this._getTextMap().getPlainText();return this._getFluidHighlights().addHighlight(a,(0,gr.rX)((0,gr.mp)(e.range),r),{alertId:a,alertDisplayType:s}),n}}return null}remove(e){this._denaliHighlights.has(e)?(this._getFluidHighlights().removeHighlight(e),this._denaliHighlights.delete(e)):this._log.warn(`can't remove mark #${e}, doesn't exist`)}update(e,t,i,s){const a=this._denaliHighlights.get(e);if(a){this._denaliHighlights.set(e,{...a,visualization:i});const n=this._getTextMap().getPlainText();return this._getFluidHighlights().updateHighlight(e,(0,gr.rX)(t.meta.range(),n),{alertId:e,alertDisplayType:s}),a}return this._log.warn("cannot update not existing highlight",e),null}}var _r=i(55073),wr=i(25938),yr=i(64450),Er=i(24645);class Cr{constructor(e,t,i,s,a,n,r=y.Y.create(Cr.name),o,l){this._highlights=e,this._textObserver=t,this._replacementService=i,this._layout=s,this._scroller=a,this._selectedHighlightsTracker=n,this._log=r,this._requestAwaitService=o,this._formattingService=l,this._subs=new et.w.Keeper,this._disposed=!1,this._alertsData=new fr,this._highlightUpdater=new vr(this._alertsData,(()=>this._highlights),(()=>this._textObserver.getTextSource()),(()=>{const e=this._layout.textField.rect.getApproximate();return Va.Pf.create({...e.client,...e.size})}),(()=>this._layout.textField.scroll.getApproximate())),this.highlightHoverProvider={getHoveredStateBehavior:e=>this._alertsData.getHighlightVisualization(e).pipe((0,g.U)((e=>e&&e.type===bi.sO.Change.VisualState.Type.highlighted?{[bi.sO.Change.VisualState.Source.sidebar]:dr.pc.hovered_needs_attention,[bi.sO.Change.VisualState.Source.text]:dr.pc.hovered,[bi.sO.Change.VisualState.Source.api]:dr.pc.none}[e.source]:dr.pc.none)))},this._updateContentsBuffer=new c.xQ,this._flushUpdater=new c.xQ,this._echoChanges=new c.xQ,this.changes=Ee.T(this._echoChanges,this._textObserver.contentChanges.async.pipe((0,w.h)((e=>e.changes.length>0)),(0,g.U)((({deltaChange:e})=>e)))),this.getContents=(e,t)=>{if(this._log.trace(`getContents, ${e}, ${t}`),this._formattingService){const i=this._textObserver.getTextSource().getRichText();return wr.RI.unsafeRes(void 0!==e?i.slice(e,void 0!==t?e+t:void 0):i)}{const i=void 0!==e?this.getText().slice(e,void 0!==t?e+t:void 0):this.getText();return wr.RI.resFromText(i)}},this.activeMarks=new ee.X(Ie.none),this.contentUpdated=new c.xQ,this.hoveredMarks=new ee.X(Ie.none),this.textChangedAfterPaste=new c.xQ,this.activeWord=new ee.X(Ie.none),this.clickedWord=new ee.X(Ie.none),this.ongoingSelection=new ee.X(!1),this._log.info(Cr.name+" created"),this._subs.push(this._subscribeToContentUpdates(),this._subscribeToSelectedHighlight())}pushChanges(e,t){this._log.trace("pushChanges",{change:e,source:t}),wr.RI.isFlush(e)?this._flushUpdater.next():wr.RI.isReset(e)?mr.s.deltaEq.equals(e.delta,this.getContents().delta)?this._echoChanges.next(e):this._log.warn("Got unknown reset"):this._updateContents(e.delta,t)}getText(){return this._log.trace("getText"),this._formattingService?(0,_r.l)(this._textObserver.getTextSource().getRichText(),""):this._textObserver.getTextSource().getPlainText()}getTextLength(){return this._log.trace("getTextLength"),this.getText().length}flushChanges(){this._log.trace("flushChanges")}getCursor(){return this._log.trace("getCursor"),Kt.Y1.empty}setCursor(e,t,i){return this._log.trace("setCursor",{_index:e,_length:t,_source:i}),je.right(void 0)}getLastPossibleCursorPosition(){return this._log.trace("getLastPossibleCursorPosition"),0}_doMarkAction(e){const t=e.meta.capiAlertId;switch(e.action){case Er.v.Change.ActionType.create:const i=this._highlightUpdater.registerAlert(t,e,e.meta.visualState,e.meta.extensionDisplayType);return(null==i?void 0:i.mark)||null;case Er.v.Change.ActionType.update:const s=this._highlightUpdater.update(t,e,e.meta.visualState,e.meta.extensionDisplayType);return(null==s?void 0:s.mark)||null;case Er.v.Change.ActionType.remove:return this._highlightUpdater.remove(t),null;default:(0,_t.vE)(e)}}changeMarks(e){return this._disposed?(this._log.debug("changeMarks called after disposed, returning empty result"),Er.v.Change.Result.getEmpty()):(this._log.trace("changeMarks",{rawMarks:e}),e.reduce(((e,t)=>{switch(t.action){case Er.v.Change.ActionType.create:e.created.set(t.id,je.fromNullable(new Error("Cannot create mark"))(this._doMarkAction(t)));break;case Er.v.Change.ActionType.update:e.updated.set(t.id,je.fromNullable(new Error("Cannot update mark"))(this._doMarkAction(t)));break;case Er.v.Change.ActionType.remove:this._doMarkAction(t),e.removed.set(t.id,je.right(void 0))}return e}),Er.v.Change.Result.getEmpty()))}scrollToMark(e,t){return this._log.trace("scrollToMark",{mark:e,opts:t}),this._scroller.scrollToMark(e,t)}_subscribeToContentUpdates(){return this._updateContentsBuffer.pipe((0,ur.R)((()=>(0,Ee.T)((0,dt.H)((0,pt.Xd)(20)),this._flushUpdater).pipe((0,st.P)()))),(0,w.h)((e=>e.length>0)),(0,g.U)((e=>e.reduce(((e,t)=>e.compose(t)),new yr.i)))).subscribe((e=>{const t=this._replacementService.performBatchReplacements((i=e,i.reduce((({actions:e,index:t},i)=>{const s=e[0];return mr.s.isInsertString(i)?(e.unshift({pos:{start:t,end:t},value:i.insert}),{actions:e,index:t}):mr.s.isInsertEmbed(i)?{actions:e,index:t+1}:mr.s.isRetain(i)?{actions:e,index:t+i.retain}:mr.s.isDelete(i)?(s&&s.pos.start===s.pos.end&&s.pos.end===t?s.pos={...s.pos,end:s.pos.end+i.delete}:e.unshift({pos:{start:t,end:t+i.delete},value:""}),{actions:e,index:t+i.delete}):void(0,ce.vE)(i)}),{actions:[],index:0}).actions.reduce(((e,t)=>(e.length&&e[e.length-1].value&&e[e.length-1].pos.start===t.pos.start?e[e.length-1].value=`${t.value}${e[e.length-1].value}`:e.push(t),e)),[]))).then((()=>{const t=(e=>e.reduce((({formattings:e,index:t},i)=>hr.m.hasFormatting(i)?mr.s.isInsertString(i)?(e.push({range:{start:t,end:"\n"===i.insert?t:t+i.insert.length},formatting:i.attributes}),{formattings:e,index:t+i.insert.length}):mr.s.isInsertEmbed(i)?{formattings:e,index:t+1}:mr.s.isRetain(i)?(e.push({range:{start:t,end:t+i.retain},formatting:i.attributes}),{formattings:e,index:t+i.retain}):{formattings:e,index:t}:mr.s.isInsertString(i)?{formattings:e,index:t+i.insert.length}:mr.s.isInsertEmbed(i)?{formattings:e,index:t+1}:mr.s.isRetain(i)?{formattings:e,index:t+i.retain}:mr.s.isDelete(i)?{formattings:e,index:t}:void(0,ce.vE)(i)),{formattings:[],index:0}).formattings)(e);this._formattingService&&t.length&&(this._log.trace("Have formattings, applying",t),t.forEach((e=>{this._formattingService&&this._formattingService.apply(e.range,e.formatting)})))}),(()=>{this._log.warn("Failed to apply batch replacements")}));var i;this._requestAwaitService&&this._requestAwaitService.addRequest(t)}))}_subscribeToSelectedHighlight(){return this._selectedHighlightsTracker.pipe((0,g.U)((e=>(0,o.pipe)(Ie.some(e),Ie.map((e=>e.map((e=>{var t;return null===(t=this._alertsData.get(e))||void 0===t?void 0:t.mark})).filter((e=>Boolean(e))))))))).subscribe((e=>{this.activeMarks.next(e)}))}_updateContents(e,t){this._updateContentsBuffer.next((0,_r.AQ)(e))}getSelectionRect(){throw this._log.trace("getSelectionRect"),Error("not implemented")}setContents(e){this._log.trace("setContents",{_value:e})}getHTML(){return this._log.trace("getHTML"),""}getPossibleCursorPosition(e,t){return this._log.trace("getPossibleCursorPosition",{_x:e,_y:t}),We.vM((()=>{throw new Error("Not implemented")}))}dispose(){this._subs.dispose(),this._log.info(Cr.name+" disposed"),this._disposed=!0}}var Sr=i(64213),br=i(14568),kr=i(49524),xr=i(38365),Mr=i(51072);var Ar=i(80358),Lr=i(53487),Rr=i(24273),Ir=i(27901),Tr=i(5760),Vr=i(99516),Fr=i(44659),Pr=i(52485),Or=i(57736);const Hr=(e,t,i,s,a,n,r=Nr("permanentStorageSync",t.getContents()))=>{const l=new et.w.Keeper,c=function(e,t,i){const s=F.hg.create(Ie.none),a=F.hg.create(Ie.none);return{score:F.hg.create(Ie.none),textInfo:F.hg.create(Ie.none),checkingState:F.hg.create(e.checkingState),asyncChecksState:F.hg.create(e.asyncChecksState),context:i,contextCompleteness:i.view(xr.j.calculateCompleteness),updateContext:e=>{const t=!Oi.R$.equals(i.get(),e);return i.set(e),t},defaultContext:s,updateDefaultContext:e=>{const t=!(0,o.pipe)((0,Ue.tuple)([s.get(),e],wt.vB(Oi.R$.equals)));return s.set(e),t},documentText:t.getText(),documentLength:F.hg.create({full:t.getTextLength(),trimmed:t.getTextLength()}),counters:F.hg.create(xr.dM.group.empty),calculateStats:()=>Mr.Vi(e.requestDocStats).then((e=>(a.set(Ie.some(e)),e))),recentDocumentStats:a}}(e,t,i);l.push(e.events.pipe(v.b((t=>{var i;c.checkingState.set(e.checkingState),Ar.h.is("text_info")(t)?c.textInfo.set(Ie.some(t.data)):Ar.h.is("finish")(t)?c.score.set(t.score):Ar.h.is("feedback_ack")(t)?(0,o.pipe)(Ie.fromNullable(null===(i=t.outcomeScores)||void 0===i?void 0:i.GeneralScore),Ie.map((e=>Math.trunc(100*e))),Ie.map((e=>{c.score.modify((0,Ue.flow)(Ie.map((t=>({...t,rank:e})))))}))):Ar.h.is("session_started")(t)&&c.updateDefaultContext(t.defaultDocumentContext)}))).subscribe(),a.contentChanges.async.pipe(tt.b(300),g.U((e=>e.newText)),g.U((e=>({full:e.length-1,trimmed:e.trim().length}))),v.b(we.wW(c.documentLength))).subscribe()),(0,o.pipe)(n(),Ie.map((e=>{c.updateDefaultContext(Oi.R$.parseDefault(e.defaultDocumentContext))})));const d=new Or.Xr,p=new Tr.Ek,u=new Ir.S(d,p,(()=>t.getContents().delta),e.events,e,c.counters,kr.y,((e,t)=>qe.bZ.isDuplicatedBy(e,t)||qe.bZ.isTakeawayOverlap(e,t,.75))),h=Lr.e.create(u.state),m=new Rr.k(h,u._ops);return l.push(Fr.R.init(Pr.$.connectAsPrimarySourceWithoutDuplex(t),e.events,r,Vr.n.ignoreTEResult(e),Vr.n.ignoreResult(d),p,Vr.A.merge([u])).subscribe()),e.loadAlerts(s()),u.flushAlerts(),{alertsList:u,alertsReader:h,alertsService:m,positionManager:d,sessionModel:c,shutdown:()=>{u.dispose(),l.dispose()}}},Nr=(e,t)=>({pushChanges:Ke.ZT,changes:(new c.xQ).pipe(h.O(t))});class Ur{constructor(e,t,i,s,a,n,r,o,l,c,d){this.connectionState=e,this.pageState=t,this.actions=i,this.gnar=s,this.user=a,this._hoverProvider=n,this.document=r,this.formattingService=o,this.denaliViewAdapter=l,this.capiProxy=c,this.engine=d,n.setAssistantHover(l.highlightHoverProvider)}static create(e){var t;const i=new Cr(e.highlights,e.textObserver,e.replacementService.get(),e.layout,e.scroller,e.selectedHighlightsTracker,void 0,e.requestAwaitService,null===(t=e.formattingService)||void 0===t?void 0:t.get()),s=br.p.create(e.checkingService.get(),e.checkingServiceInitialState,e.alertsTransformer,e.alertProcessor,e.sidebarEvents),a=Hr(s,i,e.document.settings.lens("context"),(()=>{var t,i;return null!==(i=null===(t=e.getExistingAlerts)||void 0===t?void 0:t.call(e))&&void 0!==i?i:(0,Sr.q)(e.alertProcessor)}),e.textObserver,(()=>e.checkingServiceInitialState.value.lastStart));return new Ur(e.connectionState,e.pageState,e.actions,e.gnar,e.user,e.hoverProvider,e.document,e.formattingService,i,s,a)}dispose(){this.capiProxy.dispose(),this.denaliViewAdapter.dispose(),this.engine.shutdown(),this._hoverProvider.removeAssistantHover()}}var Dr=i(79462);class Br{constructor({layout:e}){this._scroller=function({scrollToMarkRect:e,scrollToRange:t}){return{scrollToMark:(i,s)=>new Dr.y((a=>(0,o.pipe)(bi.Fd.getMarkRect(i),We.L9((()=>(t((0,gr.mp)(i.range)),bi.Fd.getMarkRect(i)))),je.fold((()=>{a.error(new Error("Cannot get mark's rect: "+i.id))}),(t=>{a.next(void 0),e(t,s)})))))}}({scrollToMarkRect(t,i){const s=e.textField.visibleRect.getApproximate();let a=(i&&i.paddingTop||0)-s.client.top;(a<=0||a>=s.size.height)&&(a=s.size.height/2);const n=t.top-a-s.client.top,r=t.right-t.left,o=Math.max(0,(s.size.width-r)/2);t.left,s.client.left;requestAnimationFrame((()=>e.textField.scroller.scrollBy({top:n,left:void 0})))},scrollToRange(){}})}scrollToMark(e,t){return this._scroller.scrollToMark(e,t)}}var Zr=i(45288),qr=i(42187);function Gr(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function zr(e,t){return e<<t|e>>>32-t}const Kr=3432918353,Wr=461845907;class jr{getHash(e,t=0){const i=(new TextEncoder).encode(e),s=i.length%4,a=i.length-s;let n,r=t,o=0;for(n=0;n<a;n+=4)r=Gr(zr(r^Gr(zr(Gr(i[n]|i[n+1]<<8|i[n+2]<<16|i[n+3]<<24,Kr),15),Wr),13),5)+3864292196;switch(o=0,s){case 3:o^=i[n+2]<<16;case 2:o^=i[n+1]<<8;case 1:o^=i[n],r^=Gr(zr(Gr(o,Kr),15),Wr)}return l=Gr((l=r^i.length)^l>>>16,2246822507),((l=Gr(l^l>>>13,3266489909))^l>>>16)>>>0;var l}}var Xr;!function(e){e.preferred=jr}(Xr||(Xr={}));class Yr{constructor(e){this._params=e,this.sidebarEvents=new c.xQ,this.hoverProvider=new pr(this._params.hoverProvider),this.selectedHighlightsTracker=this._params.highlights.getSelectedHighlightsTracker({textField:this._params.originalTextField,selectionService:this._params.selectionService}),this.goalPrediction=new Zr.X(this._params.state.view("user","experiments").view((e=>{var t;return null!==(t=(null==e?void 0:e.goalPrediction)&&!(null==e?void 0:e.goalPredictionShadow))&&void 0!==t&&t})),((e,t)=>this._checkingService&&this._checkingService.lazyCheckingService.get().onIntentFeedback(e,t))),this.positionModel=((e,t,i)=>{const s=t.view("page","domain").get(),a=(0,qr.bk)(e,-1,(e=>e.nodeName)),n=`${s},${e.nodeName},${a.join()}`,r=(new Xr.preferred).getHash(n).toString(),o=t.view("page","assistantSettings").view((e=>{var t,i;return e&&null!==(i=null===(t=e[r])||void 0===t?void 0:t.initialPositionOffset)&&void 0!==i?i:Ht.E9.zero}));return{initialPositionOffset:o,updateInitialPositionOffset:e=>{Ht.E9.equal(e,o.get())||i.patchAssistantSettings({[r]:{initialPositionOffset:e}})}}})(this._params.originalTextField,this._params.state,this._params.actions),this.isTextFieldEmpty=this._params.textObserver.contentChanges.async.pipe(g.U((e=>""===e.newText.trim())),ie.x()),this._checkingService=null}setCheckingService(e){this._checkingService=e}getCheckingServiceState(){var e;return null===(e=this._checkingService)||void 0===e?void 0:e.state.value}createIntegration(){const{layout:e,highlights:t,textObserver:i,replacementService:s,alertProcessor:a,state:n,gnar:r,alertsTransformer:o,document:l,requestAwaitService:c,formattingService:d,actions:p,getCheckingServicePreviousState:u,createAssistantScroller:h=(()=>new Br({layout:e})),getExistingAlerts:m}=this._params;if(null==this._checkingService)return null;const g=null==u?void 0:u();g&&(this._checkingService.state.value=g);const f=h(),{user:v}=n.get();return Ur.create({layout:e,alertProcessor:a,connectionState:n.view((e=>e.connection)),pageState:n.view((e=>e.page)),actions:p,highlights:t,textObserver:i,replacementService:s,checkingService:this._checkingService.lazyCheckingService,checkingServiceInitialState:this._checkingService.state,gnar:r,user:{isPremium:v.premium,isAnonymous:v.anonymous,experiments:v.experiments,customFields:v.customFields},hoverProvider:this.hoverProvider,selectedHighlightsTracker:this.selectedHighlightsTracker,scroller:f,sidebarEvents:this.sidebarEvents,document:l,alertsTransformer:o,requestAwaitService:c,formattingService:d,getExistingAlerts:m})}dispose(){var e;null===(e=this._checkingService)||void 0===e||e.state.dispose()}}const Qr=e=>({setUserRole:e.setUserRole,setSoundFluentGoals:e.setSoundFluentGoals,setPrimaryLanguage:e.setPrimaryLanguage})},66020:(e,t,i)=>{var s=i(93476)((function(e){return e[1]}));s.push([e.id,"._3wyc7-badge{display:-ms-inline-flexbox;display:inline-flex;border-radius:3px;padding-left:4px;padding-right:4px;}._3wyc7-badge._3OZNg-badgePrimary{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#3659b5;font-size:10px;line-height:16px;letter-spacing:.04em;text-transform:uppercase;background:#dbebff}._3wyc7-badge._23H_e-badgeSuccess{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0d8065;font-size:10px;line-height:16px;letter-spacing:.04em;text-transform:uppercase;background:#d7f7f0}._3wyc7-badge._1IBfr-badgeGold{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#8c5404;font-size:10px;line-height:16px;letter-spacing:.04em;text-transform:uppercase;background:#ffdf80}",""]),s.locals={badge:"_3wyc7-badge",badgePrimary:"_3OZNg-badgePrimary",badgeSuccess:"_23H_e-badgeSuccess",badgeGold:"_1IBfr-badgeGold"},e.exports=s},66740:(e,t,i)=>{var s=i(93476),a=i(91678),n=i(80300),r=s((function(e){return e[1]})),o=a(n);r.push([e.id,"@keyframes _Yz4yI-spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}._UaSlh-proofitRequestFormBtnLoadingSpinner{width:32px;height:32px;background-size:32px 32px;background-image:url("+o+");background-repeat:no-repeat;animation:_Yz4yI-spin 1s linear infinite;margin:0 auto}",""]),r.locals={proofitRequestFormBtnLoadingSpinner:"_UaSlh-proofitRequestFormBtnLoadingSpinner",spin:"_Yz4yI-spin"},e.exports=r},55271:(e,t,i)=>{var s=i(93476),a=i(91678),n=i(58947),r=s((function(e){return e[1]})),o=a(n);r.push([e.id,"._AXhEk-proofitRequestForm{width:100%;height:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;}._AXhEk-proofitRequestForm ._1CZ3g-proofitRequestFormImg{width:256px;height:48px;background-size:256px 48px;background-image:url("+o+");background-repeat:no-repeat;margin-bottom:16px;-ms-flex-negative:0;flex-shrink:0}._AXhEk-proofitRequestForm ._2f8us-proofitRequestFormTitle{font-family:Inter,sans-serif;font-style:normal;font-weight:bold;color:#0e101a;font-size:16px;line-height:24px;margin-bottom:4px}._AXhEk-proofitRequestForm ._2t-MU-proofitRequestFormDescription{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:14px;line-height:21px;font-feature-settings:'ss03' on;margin-bottom:18px}._AXhEk-proofitRequestForm ._3bGTw-proofitRequestFormCostAndTime{display:-ms-grid;display:grid;-ms-grid-columns:1fr 1fr;grid-template-columns:1fr 1fr;margin-bottom:32px;}._AXhEk-proofitRequestForm ._3bGTw-proofitRequestFormCostAndTime ._3-OP_-proofitRequestFormTime{border-left:1px solid #c6cbde;padding-left:16px}._AXhEk-proofitRequestForm ._3bGTw-proofitRequestFormCostAndTime ._2R7q7-proofitRequestFormCostAndTimeTitle{font-family:Inter,sans-serif;font-style:normal;font-weight:bold;color:#0e101a;font-size:16px;line-height:24px}._AXhEk-proofitRequestForm ._3bGTw-proofitRequestFormCostAndTime ._3xdAw-proofitRequestFormCostAndTimeSubtitle{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:11px;line-height:16px}._AXhEk-proofitRequestForm ._vKrAd-proofitRequestFormRequestBtn{margin-bottom:7px}._AXhEk-proofitRequestForm ._CaeP7-proofitRequestFormUnavailableMsg{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#6d758d;font-size:12px;line-height:18px;text-align:center}._AXhEk-proofitRequestForm ._DyHk9-proofitRequestFormFreeTrialFootnote{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#6d758d;font-size:11px;line-height:16px;margin-top:32px;width:100%;-ms-flex-positive:1;flex-grow:1;-ms-flex-negative:0;flex-shrink:0;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center}._AXhEk-proofitRequestForm ._3-3Od-proofitRequestFormPrivacyInfoTitle{font-family:Inter,sans-serif;font-style:normal;font-weight:bold;color:#0e101a;font-size:16px;line-height:24px;margin-bottom:10px}._AXhEk-proofitRequestForm ._HQATa-proofitRequestFormPrivacyInfoDescription{margin-bottom:32px;}._AXhEk-proofitRequestForm ._HQATa-proofitRequestFormPrivacyInfoDescription ._1SxBs-proofitRequestFormPrivacyInfoDescriptionItem{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:14px;line-height:21px;font-feature-settings:'ss03' on;margin-bottom:10px;display:-ms-grid;display:grid;-ms-grid-columns:1fr auto;grid-template-columns:1fr auto;grid-column-gap:13px;-ms-flex-align:baseline;align-items:baseline;}._AXhEk-proofitRequestForm ._HQATa-proofitRequestFormPrivacyInfoDescription ._1SxBs-proofitRequestFormPrivacyInfoDescriptionItem ._wLxAr-proofitRequestFormPrivacyInfoDescriptionItemBulletPoint{width:6px;height:6px;background:#0e101a;border-radius:100%}",""]),r.locals={proofitRequestForm:"_AXhEk-proofitRequestForm",proofitRequestFormImg:"_1CZ3g-proofitRequestFormImg",proofitRequestFormTitle:"_2f8us-proofitRequestFormTitle",proofitRequestFormDescription:"_2t-MU-proofitRequestFormDescription",proofitRequestFormCostAndTime:"_3bGTw-proofitRequestFormCostAndTime",proofitRequestFormTime:"_3-OP_-proofitRequestFormTime",proofitRequestFormCostAndTimeTitle:"_2R7q7-proofitRequestFormCostAndTimeTitle",proofitRequestFormCostAndTimeSubtitle:"_3xdAw-proofitRequestFormCostAndTimeSubtitle",proofitRequestFormRequestBtn:"_vKrAd-proofitRequestFormRequestBtn",proofitRequestFormUnavailableMsg:"_CaeP7-proofitRequestFormUnavailableMsg",proofitRequestFormFreeTrialFootnote:"_DyHk9-proofitRequestFormFreeTrialFootnote",proofitRequestFormPrivacyInfoTitle:"_3-3Od-proofitRequestFormPrivacyInfoTitle",proofitRequestFormPrivacyInfoDescription:"_HQATa-proofitRequestFormPrivacyInfoDescription",proofitRequestFormPrivacyInfoDescriptionItem:"_1SxBs-proofitRequestFormPrivacyInfoDescriptionItem",proofitRequestFormPrivacyInfoDescriptionItemBulletPoint:"_wLxAr-proofitRequestFormPrivacyInfoDescriptionItemBulletPoint"},e.exports=r},20532:(e,t,i)=>{var s=i(93476),a=i(91678),n=i(16569),r=s((function(e){return e[1]})),o=a(n);r.push([e.id,"._fYSOQ-proofitReviewForm ._G0q6Z-proofitReviewFormImg{width:82px;height:80px;background-size:82px 80px;background-image:url("+o+");background-repeat:no-repeat;margin-bottom:16px;margin-left:auto;margin-right:auto}._fYSOQ-proofitReviewForm ._KZJJY-proofitReviewFormTitle{font-family:Inter,sans-serif;font-style:normal;font-weight:bold;color:#0e101a;font-size:16px;line-height:24px;margin-bottom:4px}._fYSOQ-proofitReviewForm ._3XcJO-proofitReviewFormDescription{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:14px;line-height:21px;font-feature-settings:'ss03' on;margin-bottom:32px}",""]),r.locals={proofitReviewForm:"_fYSOQ-proofitReviewForm",proofitReviewFormImg:"_G0q6Z-proofitReviewFormImg",proofitReviewFormTitle:"_KZJJY-proofitReviewFormTitle",proofitReviewFormDescription:"_3XcJO-proofitReviewFormDescription"},e.exports=r},33751:e=>{e.exports={cardList:"_1Eape",cardListFooterDynamic:"Inkbe",cardListFooterStatic:"_7OpWh",cardListFooterAnimate:"_29PbU",upgradeHookWrapper:"_9GpAY",footer_button:"_1Vj8X",assistant:"AnaVG",feedback_button:"ncuAb",personalization_button:"_3lVFJ",dragging:"_1XWvb",mainView:"_38aRY"}},78846:e=>{e.exports={actions_hovered:"Xf2Pk",header:"_3p6xo",draggableWrapper:"_2_Oau",draggable:"_1m9e2",headerActions:"_2asjJ",headerActionBtn:"_2u6D9",headerActionBtnProofitIcon:"_1GEsJ",logoscore_fadein:"xzxut",fadein:"_30rWn",logoscore_fadeout:"_1DBSi",fadeout:"_24pVK",logo_score:"_6nCpo",spin:"_2gcAi"}},19217:e=>{e.exports={insight:"_3o8h_",insight__icon:"_1xYf9",insight__inline_icon:"svSbC",insight__inline_text:"_3Uft0",insight__text:"_4HNa-",insight__title:"_3oxut",insight__level:"_3kcds"}},45666:e=>{e.exports={card:"_3zZUt",expand:"H6oxJ",thank:"_2vHPb",showWithFade:"_3VA9f",hide:"_3GQd2",hideWithFade:"_2EbFz",content:"_3xKyU",emojiAndTitle:"_3e-Dd",emoji:"_3yRHv",voteAndBetaBadge:"_2fnci",betaBadgeAndCloseButton:"R_dL3",betaBadge:"_1CQFV",closeButton:"Gsgji",expandedInfo:"VT1X4"}},75039:e=>{e.exports={panel:"_1_EJL",score_container:"_2K_dc",info_icon:"wbvN6",lens_switch:"_3zrPc"}},2023:e=>{e.exports={contentButton:"_2XBDL",continueButton:"MWGIQ",description:"_2_SLB",buttonContent:"_2pcq_",emojieIcon:"_2xlsw",successState:"_1lGN2",successStateIcon:"_22C-1",primaryLanguageText:"_1bNwG",primaryLanguageDescription:"_3cZkX",dropdownLabel:"_2Ntv_",iconArrow:"_2N796",dropdownOptionsContainer:"_1qZ6p",dropdownOption:"_376_f"}},98029:e=>{e.exports={predictions:"_3feHG",predictions__header:"_35Gcg",predictions__card:"_2xc9F",counterContainer:"_2co0s",predictions__zero_text:"_25oPK",predictions__emogenie_pulsing:"p-kia"}},40145:e=>{e.exports={relatedSuggestionsTitle:"_3lmjh"}},55364:e=>{e.exports={viewOverlay:"_3iGYO",content:"_2sw8A",footer:"_3kpn-",viewOverlayGoBack:"_2Z1Xu",defaultViewOverlayPanel:"jqEio",gradientViewOverlayPanel:"_3Qgxa",proofitViewOverlayPanel:"_9lDqb",defaultViewOverlayHeader:"_1GTGF",gradientViewOverlayContent:"_2hao0",proofitViewOverlayContent:"_2XeMU",logo:"xQSpk",proofitViewOverlayHeader:"_3dGrl",proofitViewOverlayHeaderBetaBadge:"_2wTGA"}},82318:e=>{e.exports={viewOverlay:"_24v8y",content:"_1GUCQ",footer:"_VXnz",viewOverlayGoBack:"_2vYal",defaultViewOverlayPanel:"_181-n",gradientViewOverlayPanel:"_30LCU",readersAttentionViewOverlayPanel:"_22JMC",defaultViewOverlayHeader:"_2YCIK",gradientViewOverlayContent:"_2hMw0",logo:"_1wpBP",readersAttentionViewOverlayHeader:"qxHZg",readersAttentionViewOverlayHeaderBetaBadge:"_2Wh5o"}},91574:e=>{e.exports={settingsDoneButton:"_3hYyu"}},35327:e=>{e.exports={summary_heading:"_28Zxw",summary_wrapper:"_3qF24",summary_fadein:"_1OTrB",fadein:"_1ETLE",summary_fadeout:"GJSzn",fadeout:"YHKQy"}},73008:e=>{e.exports={viewOverlay:"_8FYR8",content:"D8x8A",footer:"_1oEdF",viewOverlayGoBack:"_2IRn0",defaultViewOverlayPanel:"_3wpsL",gradientViewOverlayPanel:"_2zadI",defaultViewOverlayHeader:"_3Y5Ie",gradientViewOverlayContent:"_2WqSK",logo:"oiRsy"}},62513:e=>{e.exports={compactSuccessLens:"_1G56p",compactSuccessLensContainer:"_1cOu3"}},8479:e=>{e.exports={checklistAnimationWrapper:"zr34D",animateChecklistHeightChanges:"_3OEav",checklistCollapsed:"_39rI7",checklistHeader:"_2mlHX",checklistTitle:"_7RrRg",checklistFirstItemPreview:"_3vDew",checklistExpanded:"_32i5K",checklistGroupHeader:"_1BdI1",checklistItem:"_1oMsg",itemBullet:"qsz2h",itemText:"_3oEVM",checked:"_3Kb-y",fadeIn:"_1CVyR",fadeInFast:"_2nOJR",fadeOut:"_2Bd0P",fadeOutFast:"_1qgis",fadeInContentChange:"CZ5Wg",fadeOutContentChange:"_3kYHP",expand:"_3qV3Y",collapsedToExpanded:"_33ClV",collapse:"_24rZI",expandedToCollapsed:"_3LUdk"}},76539:e=>{e.exports={summaryWrapper:"_3pfyJ",message:"_2cB0Y",heatmap:"_3D1DM",secondLine:"AZYD1"}},47476:e=>{e.exports={cardWrapper:"_1RweD",bundleCardWrapper:"_11UJn"}},74880:e=>{e.exports={cardList:"_2bCPN"}},30509:e=>{e.exports={premiumLens:"_2XK23"}},879:e=>{e.exports={successLens:"_1mbLA"}},79850:e=>{e.exports={wrapper:"_2PLre"}},75259:e=>{e.exports={container:"_2D4XC",baseGrid:"_2pCwn",bottomLeft:"_3_LGs",bottomRight:"_2tHhO",top:"_2Qg0A",notificationWrapper:"_3waR1"}},67129:e=>{e.exports={sidebarContainer:"_1_f6i"}},71527:e=>{e.exports={selected:"_3Ibej",label:"EKNV1",option:"ygVjN"}},66402:e=>{e.exports={american:"pyFmV",australian:"_2WGo3",british:"_1nkJZ",canadian:"_35Lt7"}},68089:e=>{e.exports={hover_blocker:"_1b9OS"}},26485:e=>{e.exports={select_checkbox:"_3jXk9",beta:"_2D7H7",new:"_3Lqg-",checkbox:"_2nj-e",checkbox_check:"_28S0f",on:"UigB5",off:"_30ryz",checkbox_check_round:"_1PwEM",checkbox_control_wrapper:"_1KIp6",grayOut:"ZleQc",on_off:"_3mcZ6",disabled:"_1Sp_7",bottom_line:"NahjE",setting_item:"_3JLH2"}},6304:e=>{e.exports={line:"_2vgUt",disabled:"_3kA-F",dialectPicker:"_2v6OJ"}},47740:e=>{e.exports={container:"_1eoMt",contant:"_255K3",title:"_3hI6a",spacer:"_2uzpC"}},17324:e=>{e.exports={windows:"_2wKpF",setting_item:"_6eFop",fixing:"_3sQF9",thin_text:"_2m369",footer:"AIrzw",gr_popup_settings:"_18flg",footer_btn:"_16bxQ",short_border:"FqAkb",top:"_2N9kH",show_news:"_3gR-M",news:"_1cBf5",news_content:"_3szOJ",close_news:"_8vCda",upgraded:"_1D3x1",content:"_36NTm",since:"dfV8r",business:"Nb2Rp",my_grammarly:"_1NXBN",new_document:"bpEGW",unsupported_site:"iBAYN",unsupported_item:"_13zLn",unsupported_title:"_3rfYX",domain:"_1tlAE",domain_in_details:"_2z4_y",unsupported_temporary:"Xw4Jp",unsupported_permanently:"_27hK2",unsupported_grammarly:"_2xTYa",diamond:"p3X6p",userPanel:"_3cZ8t",email:"bBX3_",link:"_3ko8g",blue:"b4yKe",edc_stripe:"_1wkrp",line:"_2_8JS",not_supported:"kU9B_",site_switcher:"_2KZQq",upgrade:"_1zI1G",def_switcher:"_29_cp",on:"_2JO5i",off:"_3f4Zs",favicon:"sjSDn",hotkeys:"DWDpl",shortcut_title:"rI_db",shortcut:"ynWKZ",summary:"_1cNov",upgrade_title:"_3aOe6"}},23345:e=>{e.exports={line:"NMkwQ",content:"lWYTI",upgrade:"_2GRJe"}},16569:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});const s="chrome-extension://__MSG_@@extension_id__/src/images/d657c003000c65041a4ee3bdff85f8f6/proofreader-review.svg"},58947:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});const s="chrome-extension://__MSG_@@extension_id__/src/images/7d9261bd2b318187ad1c072a261520e4/proofreaders.svg"},80300:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});const s="chrome-extension://__MSG_@@extension_id__/src/images/4c9871d74987ca4155d3df470174f4e3/spinner.svg"}}]);