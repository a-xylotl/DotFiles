/*! For license information please see Grammarly-check.js.LICENSE.txt */
(()=>{var t={57238:(t,e,n)=>{var r=n(65747),o="chrome-extension://__MSG_@@extension_id__/",i="moz-extension://__MSG_@@extension_id__/",s=window.GR_RESOURCE_ROOT||o,c=window.GR_RESOURCE_ROOT||i;t.exports={__css:r.toString().replace(new RegExp(o,"g"),s).replace(new RegExp(i,"g"),c),...r.locals}},44390:(t,e)=>{"use strict";function n(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function r(t,e){return Object.prototype.hasOwnProperty.call(e,t)}function o(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var i,s,c,a,u=function(){var t=Object.prototype.toString;return"[object Arguments]"===t.call(arguments)?function(e){return"[object Arguments]"===t.call(e)}:function(t){return r("callee",t)}}(),l=(i=!{toString:null}.propertyIsEnumerable("toString"),s=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],c=function(){return arguments.propertyIsEnumerable("length")}(),a=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},"function"!=typeof Object.keys||c?function(t){if(Object(t)!==t)return[];var e,n,o=[],l=c&&u(t);for(e in t)!r(e,t)||l&&"length"===e||(o[o.length]=e);if(i)for(n=s.length-1;n>=0;)r(e=s[n],t)&&!a(o,e)&&(o[o.length]=e),n-=1;return o}:function(t){return Object(t)!==t?[]:Object.keys(t)});function h(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}},65747:(t,e,n)=>{var r=n(93476)((function(t){return t[1]}));r.push([t.id,"._3Spqv-animatedUnderline{visibility:hidden;position:fixed;}._3Spqv-animatedUnderline:after{content:'';position:absolute;visibility:visible;height:3px;bottom:0;border-radius:10px;background:#488cc8;animation:_15P6d-showUnderline 1.3s ease forwards}._3Spqv-animatedUnderline._1jDIx-completeAnimation:after{animation:_15P6d-showUnderline .2s ease forwards}@keyframes _15P6d-showUnderline{0%{width:0%}100%{width:100%}}._28F_K-checkAnimatedUnderline{animation:_15P6d-showUnderline 2s ease forwards;}._28F_K-checkAnimatedUnderline._1jDIx-completeAnimation{animation:_15P6d-showUnderline .2s ease forwards}",""]),r.locals={animatedUnderline:"_3Spqv-animatedUnderline",showUnderline:"_15P6d-showUnderline",completeAnimation:"_1jDIx-completeAnimation",checkAnimatedUnderline:"_28F_K-checkAnimatedUnderline"},t.exports=r},93476:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(o[s]=!0)}for(var c=0;c<t.length;c++){var a=[].concat(t[c]);r&&o[a[0]]||(n&&(a[2]?a[2]="".concat(n," and ").concat(a[2]):a[2]=n),e.push(a))}},e}},89268:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g},53594:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(89268);t=n.hmd(t);var o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&t&&!t.nodeType&&t,s=i&&i.exports===o&&r.Z.process;const c=function(){try{var t=i&&i.require&&i.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}()},94311:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(89268),o="object"==typeof self&&self&&self.Object===Object&&self;const i=r.Z||o||Function("return this")()},99138:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(94311);const o=function(){return!1};t=n.hmd(t);var i="object"==typeof exports&&exports&&!exports.nodeType&&exports,s=i&&t&&!t.nodeType&&t,c=s&&s.exports===i?r.Z.Buffer:void 0;const a=(c?c.isBuffer:void 0)||o},52961:t=>{t.exports={animatedUnderline:"_24bLp",showUnderline:"jF640",completeAnimation:"gNDOL"}},39335:(t,e,n)=>{n(3214);var r={superfasthash:n(11028),murmurhash3:n(13786)};t.exports={createHash:function(t){t=t.replace(/![a-zA-z0-9]/g,"").toLowerCase();try{return r[t]}catch(t){throw new Error(t)}}}},13786:(t,e,n)=>{"use strict";var r=n(81314);function o(t,e){return(65535&t)*e+(((t>>>16)*e&65535)<<16)}function i(t,e){return t<<e|t>>>32-e}function s(t){return t=o(t^=t>>>16,2246822507),t=o(t^=t>>>13,3266489909),t^=t>>>16}function c(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]+e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]+e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]+e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]+e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function a(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]*e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]*e[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=t[3]*e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]*e[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[2]*e[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[3]*e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]*e[3]+t[1]*e[2]+t[2]*e[1]+t[3]*e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function u(t,e){return 32===(e%=64)?[t[1],t[0]]:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e|t[0]>>>32-e]:(e-=32,[t[1]<<e|t[0]>>>32-e,t[0]<<e|t[1]>>>32-e])}function l(t,e){return 0===(e%=64)?t:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e]:[t[1]<<e-32,0]}function h(t,e){return[t[0]^e[0],t[1]^e[1]]}function f(t){return t=h(t,[0,t[0]>>>1]),t=h(t=a(t,[4283543511,3981806797]),[0,t[0]>>>1]),t=h(t=a(t,[3301882366,444984403]),[0,t[0]>>>1])}var d=function(t,e){t=""+t||"";var n=r.toU8IntArray(t);e=e||0;for(var o=(t={charCodeAt:function(t){return n[t]},length:n.length}).length%16,i=t.length-o,s=[0,e],d=[0,e],p=[0,0],b=[0,0],g=[2277735313,289559509],m=[1291169091,658871167],v=0;v<i;v+=16)p=[255&t.charCodeAt(v+4)|(255&t.charCodeAt(v+5))<<8|(255&t.charCodeAt(v+6))<<16|(255&t.charCodeAt(v+7))<<24,255&t.charCodeAt(v)|(255&t.charCodeAt(v+1))<<8|(255&t.charCodeAt(v+2))<<16|(255&t.charCodeAt(v+3))<<24],b=[255&t.charCodeAt(v+12)|(255&t.charCodeAt(v+13))<<8|(255&t.charCodeAt(v+14))<<16|(255&t.charCodeAt(v+15))<<24,255&t.charCodeAt(v+8)|(255&t.charCodeAt(v+9))<<8|(255&t.charCodeAt(v+10))<<16|(255&t.charCodeAt(v+11))<<24],p=u(p=a(p,g),31),s=c(s=u(s=h(s,p=a(p,m)),27),d),s=c(a(s,[0,5]),[0,1390208809]),b=u(b=a(b,m),33),d=c(d=u(d=h(d,b=a(b,g)),31),s),d=c(a(d,[0,5]),[0,944331445]);switch(p=[0,0],b=[0,0],o){case 15:b=h(b,l([0,t.charCodeAt(v+14)],48));case 14:b=h(b,l([0,t.charCodeAt(v+13)],40));case 13:b=h(b,l([0,t.charCodeAt(v+12)],32));case 12:b=h(b,l([0,t.charCodeAt(v+11)],24));case 11:b=h(b,l([0,t.charCodeAt(v+10)],16));case 10:b=h(b,l([0,t.charCodeAt(v+9)],8));case 9:b=a(b=h(b,[0,t.charCodeAt(v+8)]),m),d=h(d,b=a(b=u(b,33),g));case 8:p=h(p,l([0,t.charCodeAt(v+7)],56));case 7:p=h(p,l([0,t.charCodeAt(v+6)],48));case 6:p=h(p,l([0,t.charCodeAt(v+5)],40));case 5:p=h(p,l([0,t.charCodeAt(v+4)],32));case 4:p=h(p,l([0,t.charCodeAt(v+3)],24));case 3:p=h(p,l([0,t.charCodeAt(v+2)],16));case 2:p=h(p,l([0,t.charCodeAt(v+1)],8));case 1:p=a(p=h(p,[0,t.charCodeAt(v)]),g),s=h(s,p=a(p=u(p,31),m))}return s=c(s=h(s,[0,t.length]),d=h(d,[0,t.length])),d=c(d,s),s=c(s=f(s),d=f(d)),d=c(d,s),("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)+("00000000"+(d[0]>>>0).toString(16)).slice(-8)+("00000000"+(d[1]>>>0).toString(16)).slice(-8)};t.exports={x86Hash32:function(t,e){t=""+t||"";var n=r.toU8IntArray(t);e=e||0;for(var c=(t={charCodeAt:function(t){return n[t]},length:n.length}).length%4,a=t.length-c,u=e,l=0,h=3432918353,f=461845907,d=0;d<a;d+=4)l=o(l=255&t.charCodeAt(d)|(255&t.charCodeAt(d+1))<<8|(255&t.charCodeAt(d+2))<<16|(255&t.charCodeAt(d+3))<<24,h),l=o(l=i(l,15),f),u=o(u=i(u^=l,13),5)+3864292196;switch(l=0,c){case 3:l^=(255&t.charCodeAt(d+2))<<16;case 2:l^=(255&t.charCodeAt(d+1))<<8;case 1:l=o(l^=255&t.charCodeAt(d),h),u^=l=o(l=i(l,15),f)}return((u=s(u^=t.length))>>>0).toString(16)},x86Hash128:function(t,e){t=""+t||"";var n=r.toU8IntArray(t);e=e||0;for(var c=(t={charCodeAt:function(t){return n[t]},length:n.length}).length%16,a=t.length-c,u=e,l=e,h=e,f=e,d=0,p=0,b=0,g=0,m=597399067,v=2869860233,y=951274213,_=2716044179,w=0;w<a;w+=16)d=255&t.charCodeAt(w)|(255&t.charCodeAt(w+1))<<8|(255&t.charCodeAt(w+2))<<16|(255&t.charCodeAt(w+3))<<24,p=255&t.charCodeAt(w+4)|(255&t.charCodeAt(w+5))<<8|(255&t.charCodeAt(w+6))<<16|(255&t.charCodeAt(w+7))<<24,b=255&t.charCodeAt(w+8)|(255&t.charCodeAt(w+9))<<8|(255&t.charCodeAt(w+10))<<16|(255&t.charCodeAt(w+11))<<24,g=255&t.charCodeAt(w+12)|(255&t.charCodeAt(w+13))<<8|(255&t.charCodeAt(w+14))<<16|(255&t.charCodeAt(w+15))<<24,d=i(d=o(d,m),15),u=i(u^=d=o(d,v),19),u=o(u+=l,5)+1444728091,p=i(p=o(p,v),16),l=i(l^=p=o(p,y),17),l=o(l+=h,5)+197830471,b=i(b=o(b,y),17),h=i(h^=b=o(b,_),15),h=o(h+=f,5)+2530024501,g=i(g=o(g,_),18),f=i(f^=g=o(g,m),13),f=o(f+=u,5)+850148119;switch(d=0,p=0,b=0,g=0,c){case 15:g^=t.charCodeAt(w+14)<<16;case 14:g^=t.charCodeAt(w+13)<<8;case 13:g=o(g^=t.charCodeAt(w+12),_),f^=g=o(g=i(g,18),m);case 12:b^=t.charCodeAt(w+11)<<24;case 11:b^=t.charCodeAt(w+10)<<16;case 10:b^=t.charCodeAt(w+9)<<8;case 9:b=o(b^=t.charCodeAt(w+8),y),h^=b=o(b=i(b,17),_);case 8:p^=t.charCodeAt(w+7)<<24;case 7:p^=t.charCodeAt(w+6)<<16;case 6:p^=t.charCodeAt(w+5)<<8;case 5:p=o(p^=t.charCodeAt(w+4),v),l^=p=o(p=i(p,16),y);case 4:d^=t.charCodeAt(w+3)<<24;case 3:d^=t.charCodeAt(w+2)<<16;case 2:d^=t.charCodeAt(w+1)<<8;case 1:d=o(d^=t.charCodeAt(w),m),u^=d=o(d=i(d,15),v)}return u^=t.length,u+=l^=t.length,u+=h^=t.length,l+=u+=f^=t.length,h+=u,f+=u,u=s(u),u+=l=s(l),u+=h=s(h),l+=u+=f=s(f),h+=u,f+=u,("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)},x64Hash64:function(t,e){return d(t,e).slice(8)},x64Hash128:d,hash:function(t,e){return d(t,e)}}},11028:(t,e,n)=>{"use strict";var r=n(81314);function o(t,e){return t[e]<<8|t[e+1]}t.exports={hash:function(t){var e,n=r.toU8IntArray(t+""),i=0;if(!t)return i.toString(16);var s=n.length,c=0;e=3&s,s>>>=2;for(var a=0;a<s;a++)i=(i+=o(n,c))<<16^(o(n,c+2)<<11^i),c+=4,i+=i>>11;switch(e){case 3:i+=o(n,c),i^=i<<16,i^=n[c+2]<<18,i+=i>>11;break;case 2:i+=o(n,c),i^=i<<11,i+=i>>17;break;case 1:i+=n[c],i^=i<<10,i+=i>>1}return i^=i<<3,i+=i>>5,i^=i<<4,i+=i>>17,i^=i<<25,i+=i>>6,r.intToUnsignedHex(i)}}},81314:t=>{t.exports={toU8IntArray:function(t){for(var e=[],n=[],r=0;r<t.length;r++){var o,i=t.charCodeAt(r);for(n.length=0;(o=255&i)||i;)n.push(o),i>>>=8;e=e.concat(n.reverse())}return e},intToUnsignedHex:function(t){for(var e,n=[];(e=65535&t)||t;)e=e.toString(16),e="0000".slice(e.length)+e,n.push(e),t>>>=16;return n.reverse().join("")}}},3214:(t,e,n)=>{"use strict";var r=n(27061),o="win32"===r.platform,i=n(71323);function s(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():e&&n.push(".."):n.push(o))}return n}function c(t){for(var e=t.length-1,n=0;n<=e&&!t[n];n++);for(var r=e;r>=0&&!t[r];r--);return 0===n&&r===e?t:n>r?[]:t.slice(n,r+1)}var a=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,u=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,l={};function h(t){var e=a.exec(t),n=(e[1]||"")+(e[2]||""),r=e[3]||"",o=u.exec(r);return[n,o[1],o[2],o[3]]}function f(t){var e=a.exec(t),n=e[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!e[2],tail:e[3]}}function d(t){return"\\\\"+t.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}l.resolve=function(){for(var t="",e="",n=!1,o=arguments.length-1;o>=-1;o--){var c;if(o>=0?c=arguments[o]:t?(c=r.env["="+t])&&c.substr(0,3).toLowerCase()===t.toLowerCase()+"\\"||(c=t+"\\"):c=r.cwd(),!i.isString(c))throw new TypeError("Arguments to path.resolve must be strings");if(c){var a=f(c),u=a.device,l=a.isUnc,h=a.isAbsolute,p=a.tail;if((!u||!t||u.toLowerCase()===t.toLowerCase())&&(t||(t=u),n||(e=p+"\\"+e,n=h),t&&n))break}}return l&&(t=d(t)),t+(n?"\\":"")+(e=s(e.split(/[\\\/]+/),!n).join("\\"))||"."},l.normalize=function(t){var e=f(t),n=e.device,r=e.isUnc,o=e.isAbsolute,i=e.tail,c=/[\\\/]$/.test(i);return(i=s(i.split(/[\\\/]+/),!o).join("\\"))||o||(i="."),i&&c&&(i+="\\"),r&&(n=d(n)),n+(o?"\\":"")+i},l.isAbsolute=function(t){return f(t).isAbsolute},l.join=function(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&t.push(n)}var r=t.join("\\");return/^[\\\/]{2}[^\\\/]/.test(t[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),l.normalize(r)},l.relative=function(t,e){t=l.resolve(t),e=l.resolve(e);for(var n=t.toLowerCase(),r=e.toLowerCase(),o=c(e.split("\\")),i=c(n.split("\\")),s=c(r.split("\\")),a=Math.min(i.length,s.length),u=a,h=0;h<a;h++)if(i[h]!==s[h]){u=h;break}if(0==u)return e;var f=[];for(h=u;h<i.length;h++)f.push("..");return(f=f.concat(o.slice(u))).join("\\")},l._makeLong=function(t){if(!i.isString(t))return t;if(!t)return"";var e=l.resolve(t);return/^[a-zA-Z]\:\\/.test(e)?"\\\\?\\"+e:/^\\\\[^?.]/.test(e)?"\\\\?\\UNC\\"+e.substring(2):t},l.dirname=function(t){var e=h(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},l.basename=function(t,e){var n=h(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},l.extname=function(t){return h(t)[3]},l.format=function(t){if(!i.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!i.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);var n=t.dir,r=t.base||"";return n?n[n.length-1]===l.sep?n+r:n+l.sep+r:r},l.parse=function(t){if(!i.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=h(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},l.sep="\\",l.delimiter=";";var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,b={};function g(t){return p.exec(t).slice(1)}b.resolve=function(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var o=n>=0?arguments[n]:r.cwd();if(!i.isString(o))throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,e="/"===o[0])}return(e?"/":"")+(t=s(t.split("/"),!e).join("/"))||"."},b.normalize=function(t){var e=b.isAbsolute(t),n=t&&"/"===t[t.length-1];return(t=s(t.split("/"),!e).join("/"))||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},b.isAbsolute=function(t){return"/"===t.charAt(0)},b.join=function(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(t+=t?"/"+n:n)}return b.normalize(t)},b.relative=function(t,e){t=b.resolve(t).substr(1),e=b.resolve(e).substr(1);for(var n=c(t.split("/")),r=c(e.split("/")),o=Math.min(n.length,r.length),i=o,s=0;s<o;s++)if(n[s]!==r[s]){i=s;break}var a=[];for(s=i;s<n.length;s++)a.push("..");return(a=a.concat(r.slice(i))).join("/")},b._makeLong=function(t){return t},b.dirname=function(t){var e=g(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},b.basename=function(t,e){var n=g(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},b.extname=function(t){return g(t)[3]},b.format=function(t){if(!i.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!i.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);return(t.dir?t.dir+b.sep:"")+(t.base||"")},b.parse=function(t){if(!i.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=g(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return e[1]=e[1]||"",e[2]=e[2]||"",e[3]=e[3]||"",{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},b.sep="/",b.delimiter=":",t.exports=o?l:b,t.exports.posix=b,t.exports.win32=l},27061:t=>{var e,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(t){n=i}}();var c,a=[],u=!1,l=-1;function h(){u&&c&&(u=!1,c.length?a=c.concat(a):l=-1,a.length&&f())}function f(){if(!u){var t=s(h);u=!0;for(var e=a.length;e;){for(c=a,a=[];++l<e;)c&&c[l].run();l=-1,e=a.length}c=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new d(t,e)),1!==a.length||u||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},8746:t=>{"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},56579:t=>{t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},71323:(t,e,n)=>{var r=n(27061),o=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(c(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),a=r[n];n<i;a=r[++n])b(a)||!_(a)?s+=" "+a:s+=" "+c(a);return s},e.deprecate=function(t,o){if(v(n.g.process))return function(){return e.deprecate(t,o).apply(this,arguments)};if(!0===r.noDeprecation)return t;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return t.apply(this,arguments)}};var i,s={};function c(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=a),l(r,t,r.depth)}function a(t,e){var n=c.styles[e];return n?"["+c.colors[n][0]+"m"+t+"["+c.colors[n][1]+"m":t}function u(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return m(o)||(o=l(t,o,r)),o}var i=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(b(e))return t.stylize("null","null")}(t,n);if(i)return i;var s=Object.keys(n),c=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),x(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(E(n)){var a=n.name?": "+n.name:"";return t.stylize("[Function"+a+"]","special")}if(y(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(x(n))return h(n)}var u,_="",S=!1,A=["{","}"];(d(n)&&(S=!0,A=["[","]"]),E(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return y(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),x(n)&&(_=" "+h(n)),0!==s.length||S&&0!=n.length?r<0?y(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=S?function(t,e,n,r,o){for(var i=[],s=0,c=e.length;s<c;++s)O(e,String(s))?i.push(f(t,e,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(f(t,e,n,r,o,!0))})),i}(t,n,r,c,s):s.map((function(e){return f(t,n,r,c,e,S)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,_,A)):A[0]+_+A[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,o,i){var s,c,a;if((a=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?c=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(c=t.stylize("[Setter]","special")),O(r,o)||(s="["+o+"]"),c||(t.seen.indexOf(a.value)<0?(c=b(n)?l(t,a.value,null):l(t,a.value,n-1)).indexOf("\n")>-1&&(c=i?c.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+c.split("\n").map((function(t){return"   "+t})).join("\n")):c=t.stylize("[Circular]","special")),v(s)){if(i&&o.match(/^\d+$/))return c;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+c}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function b(t){return null===t}function g(t){return"number"==typeof t}function m(t){return"string"==typeof t}function v(t){return void 0===t}function y(t){return _(t)&&"[object RegExp]"===S(t)}function _(t){return"object"==typeof t&&null!==t}function w(t){return _(t)&&"[object Date]"===S(t)}function x(t){return _(t)&&("[object Error]"===S(t)||t instanceof Error)}function E(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function A(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(v(i)&&(i=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=b,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=y,e.isObject=_,e.isDate=w,e.isError=x,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(56579);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(){var t=new Date,e=[A(t.getHours()),A(t.getMinutes()),A(t.getSeconds())].join(":");return[t.getDate(),C[t.getMonth()],e].join(" ")}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",j(),e.format.apply(e,arguments))},e.inherits=n(8746),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}},e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r](o,o.exports,n),o.loaded=!0,o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{emitBackground:()=>ye,emitError:()=>le,emitFocusedTab:()=>ve,emitTabs:()=>be,emitTo:()=>ge,getTopFrameId:()=>me,init:()=>he,initMessage:()=>ie,off:()=>pe,on:()=>de,onBackgroundPortReconnect:()=>ue,one:()=>fe,promiseBackground:()=>_e});const e=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t};const r=function(t){return function(e,n,r){for(var o=-1,i=Object(e),s=r(e),c=s.length;c--;){var a=s[t?c:++o];if(!1===n(i[a],a,i))break}return e}}();const o=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var i=n(94311);const s=i.Z.Symbol;var c=Object.prototype,a=c.hasOwnProperty,u=c.toString,l=s?s.toStringTag:void 0;const h=function(t){var e=a.call(t,l),n=t[l];try{t[l]=void 0;var r=!0}catch(t){}var o=u.call(t);return r&&(e?t[l]=n:delete t[l]),o};var f=Object.prototype.toString;const d=function(t){return f.call(t)};var p=s?s.toStringTag:void 0;const b=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":p&&p in Object(t)?h(t):d(t)};const g=function(t){return null!=t&&"object"==typeof t};const m=function(t){return g(t)&&"[object Arguments]"==b(t)};var v=Object.prototype,y=v.hasOwnProperty,_=v.propertyIsEnumerable;const w=m(function(){return arguments}())?m:function(t){return g(t)&&y.call(t,"callee")&&!_.call(t,"callee")};const x=Array.isArray;var E=n(99138),S=/^(?:0|[1-9]\d*)$/;const A=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&S.test(t))&&t>-1&&t%1==0&&t<e};const C=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var j={};j["[object Float32Array]"]=j["[object Float64Array]"]=j["[object Int8Array]"]=j["[object Int16Array]"]=j["[object Int32Array]"]=j["[object Uint8Array]"]=j["[object Uint8ClampedArray]"]=j["[object Uint16Array]"]=j["[object Uint32Array]"]=!0,j["[object Arguments]"]=j["[object Array]"]=j["[object ArrayBuffer]"]=j["[object Boolean]"]=j["[object DataView]"]=j["[object Date]"]=j["[object Error]"]=j["[object Function]"]=j["[object Map]"]=j["[object Number]"]=j["[object Object]"]=j["[object RegExp]"]=j["[object Set]"]=j["[object String]"]=j["[object WeakMap]"]=!1;const O=function(t){return g(t)&&C(t.length)&&!!j[b(t)]};const k=function(t){return function(e){return t(e)}};var I=n(53594),T=I.Z&&I.Z.isTypedArray;const P=T?k(T):O;var M=Object.prototype.hasOwnProperty;const R=function(t,e){var n=x(t),r=!n&&w(t),i=!n&&!r&&(0,E.Z)(t),s=!n&&!r&&!i&&P(t),c=n||r||i||s,a=c?o(t.length,String):[],u=a.length;for(var l in t)!e&&!M.call(t,l)||c&&("length"==l||i&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||A(l,u))||a.push(l);return a};var N=Object.prototype;const L=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||N)};const U=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object);var F=Object.prototype.hasOwnProperty;const D=function(t){if(!L(t))return U(t);var e=[];for(var n in Object(t))F.call(t,n)&&"constructor"!=n&&e.push(n);return e};const z=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};const V=function(t){if(!z(t))return!1;var e=b(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};const $=function(t){return null!=t&&C(t.length)&&!V(t)};const B=function(t){return $(t)?R(t):D(t)};const H=function(t,e){return function(n,r){if(null==n)return n;if(!$(n))return t(n,r);for(var o=n.length,i=e?o:-1,s=Object(n);(e?i--:++i<o)&&!1!==r(s[i],i,s););return n}}((function(t,e){return t&&r(t,e,B)}));const G=function(t){return t};const q=function(t){return"function"==typeof t?t:G};const Z=function(t,n){return(x(t)?e:H)(t,q(n))};n(39335);function W(t,e){const n=W.items=W.items||{},r=n[t];if(r||e){if(r&&!e)return clearTimeout(r),void delete n[t];!function(){function r(){o(),t()}function o(){const o=setTimeout(r,e);n[t]=o}o()}()}}function K(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function Y(){return K()+K()+"-"+K()+"-"+K()+"-"+K()+"-"+K()+K()+K()}function J(t){return new Promise((e=>setTimeout(e,t)))}!function(t){t.items={}}(W||(W={}));new RegExp(String.fromCharCode(160),"g"),String.fromCharCode(160),new RegExp("\n"+String.fromCharCode(32),"g");const X=Y();function Q(t,e,n,r,o=!1){if(null==t)return;const i=t;if("string"!=typeof e)return Z(e,((t,e)=>{Q(i,e,t,r)}));{if(!n)return;const t=i[X]||[];return i[X]=t,r?(i[X]=t.filter((t=>!(t.event===e&&t.cb===n))),i.removeEventListener(e,n,o)):(t.push({event:e,cb:n}),i.addEventListener(e,n,o)),{el:i,event:e,cb:n,bubble:o}}}n(44390);function tt(t,e){return t.some((t=>t===e))?e:void 0}class et extends Error{constructor(t){super("Matching not exhaustive"+(t?": unexpected value "+t:""))}}function nt(t){throw new et(t)}function rt(t){const e=parseInt(t,10);return isNaN(e)?void 0:e}function ot(t,e){try{return t()}catch(t){return e(t)}}function it(){}var st;!function(t){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}t.create=function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}(st||(st={}));void 0!==window.requestIdleCallback&&window.requestIdleCallback;class ct extends Error{constructor(t){super("Assertion failed: "+(t?"string"==typeof t?t:t():"(unnamed)"))}}function at(t,e){if(!t)throw new ct(e)}function ut(t,e){if(null==t)throw new ct((()=>e?`Expected ${e} to be non-null`:"Expected non-null"));return t}var lt,ht,ft,dt,pt,bt,gt,mt;function vt(t,e){return t.filter((t=>!!t)).join(e)}!function(t){const e={chrome:"chromeExt",firefox:"firefoxExt",safari:"safariExt",edge:"chromiumEdgeExt"};t.create=function(t,n){return{appName:ut(e[t],"gnar app name"),url:"https://gnar."+n,domain:"."+n,sendEmailInfoTracking:!0,sendFluidExperimentData:!1}}}(lt||(lt={})),function(t){const e={chrome:"extensionChrome",firefox:"extensionFirefox",safari:"extensionSafari",edge:"extensionEdge"};t.create=function(t,n){return{appName:ut(e[t],"felog app name"),sendUsageMetrics:!0,sendPerfMetricsType:"dev"===n?"local":Math.random()<=.01?"send":"off"}}}(ht||(ht={})),function(t){const e={chrome:"extensionChrome",firefox:"extensionFirefox",safari:"extensionSafari",edge:"extensionEdge"};t.create=function(t){return{appName:ut(e[t],"sumologic app name")}}}(ft||(ft={})),function(t){t.create=function(){return{}}}(dt||(dt={})),function(t){t.create=function(t){return{urls:{fetchMessages:t+"/api/v1/messages",acknowledgeMessage:"",dismissMessage:""}}}}(pt||(pt={})),function(t){t.create=function(t,e,n,r,o,i){const s="safari"===t?"disableAppsPromotion=true":"";function c(t){const n=`https://${t}.${e}`;return(t="",e="")=>{const r=vt([s,e],"&");return vt([n+t,r],"?")}}const a=c("www"),u=c("app"),l=c("account"),h=c("redirect"),f="https://data."+e,d=`https://auth.${e}/v3`,p=`wss://capi.${e}/freews`;return{accountSubscription:l("/subscription"),accountSubscriptionChangePlan:l("/subscription","popup=switchToAnnualOffer"),adminAccountSubscription:l("/admin/subscription"),app:u(),appPersonalDictionary:l("/customize"),capi:p,capiGDocs:`wss://capi.${e}/gdocs`,dapiMimic:f+"/api/mimic",dapiProps:f+"/api/props/v2",dapiFindProps:f+"/api/props/v2/find",editorDictionary:u("/profile/dictionary"),dictionary:`https://capi.${e}/api/defs`,docs:u("/docs"),docsApi:`https://dox.${e}/documents`,newDoc:u("/docs/new"),userOrAnonymous:d+"/user/oranonymous",userData:d+"/user/userdata",authSignin:d+"/api/login",authSignup:d+"/api/signup",authExchange:d+"/api/unified-login/code/exchange",authLogout:d+"/logout",signin:a("/signin"),signup:a("/signup"),fbSignin:a("/signin","fromExtensionFb=true"),fbSignup:a("/signup","fromExtensionFb=true"),googleSignin:a("/signin","fromExtensionGoogle=true"),googleSignup:a("/signup","fromExtensionGoogle=true"),resetPassword:a("/resetpassword"),newFelog:n,sumoLogic:r,welcomeC:a("/extension-success"),afterInstall:a("/after_install_page/"),upgrade:a("/upgrade"),planComparison:a("/plans"),businessEHomepage:a("/business/e"),businessPricing:a("/business/pricing"),uninstall:a("/extension-uninstall"),terms:a("/terms"),policy:a("/privacy-policy"),extensionSuccess:a("/extension-success"),firefoxPrivatePolicy:"https://addons.mozilla.org/en-US/firefox/addon/grammarly-1/privacy/",dynamicConfigUrl:"https://d27xxe7juh1us6.cloudfront.net/dynamicConfig.json",pageConfigUrl:"https://d27xxe7juh1us6.cloudfront.net/browserplugin/config.json",edgePopupUrl:o,emptyScriptUrl:i,grammarlyDomain:e,grammarlyProtocol:"https:",redirect:h("/redirect")}}}(bt||(bt={})),function(t){t.create=function(t){return{gdocsSupported:"chrome"===t||"edge"===t||"firefox"===t||"safari"===t,denaliEditorSupported:"chrome"===t}}}(gt||(gt={})),function(t){const e="grammarly.com",n="qagr.io";t.create=function(t,r,o,i){const s=(t,e,n)=>"prod"===r?t:"qa"===r?e:"dev"===r?n:nt(r),c="https://127.0.0.1:8000",a=s("https://f-log-extension.grammarly.io",c,c),u=s("https://endpoint2.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV1OF-4ic11yqpre0casnyvs_ZoaCHciEYdRyBkrfwP6DMlsWt8tSVU76RPqgGvAGjXGQk_UNuxPx-pYbToJapM_Fr0CUcgKaA8_IVl-lhSr5Q==",c,c),l=s(e,n,n),h=s("chipmunk.grammarly.com",c,c);return{url:bt.create(t,"grammarly.com",a,u,o,i),gnar:lt.create(t,l),felog:ht.create(t,r),capi:dt.create(),chipmunk:pt.create(h),extensionId:"87677a2c52b84ad3a151a4a72f5bd3c4",newsVersion:0,features:gt.create(t)}}}(mt||(mt={}));const yt=ot((()=>browser),(()=>window.browser));window.chrome=window.chrome;var _t,wt,xt,Et,St,At,Ct,jt;!function(t){t.create=function(t,e,n,r,o,i,s){const c=void 0!==i&&void 0!==s?i:"UNVERSIONED",a=`${t}.${e}.${n}`;return{version:a,fullVersion:`${a}-${[r,["prod"!==o?o:null,c!==r?c:null].filter((t=>!!t)).join(".")].filter((t=>""!==t)).join("/")}`,commitHash:s,gitBranch:i}},t.getManifestVersion=function(t,e,n){switch(t){case"safari":switch(e){case"bg":case"popup":return n.safari.extension.displayVersion;default:return}case"chrome":case"edge":return n.chrome.runtime.getManifest().version;case"firefox":return yt.runtime.getManifest().version;default:return nt(t)}}}(_t||(_t={})),function(t){t.create=function(t){return tt(["chrome","safari","firefox","edge"],t)},t.isValidTargetBrowser=function(t){return["chrome","safari","firefox","edge"].includes(t)},t.detect=function(t){return t.chrome&&/google/i.test(t.navigator.vendor)?t.navigator.appVersion.indexOf("Edg")>-1?"edge":"chrome":-1!==t.navigator.userAgent.indexOf("Firefox")?"firefox":/^((?!chrome).)*safari/i.test(t.navigator.userAgent)?"safari":void 0}}(wt||(wt={})),function(t){t.create=function(t){return tt(["dev","prod","qa"],t)}}(xt||(xt={})),function(t){t.create=function(t){return tt(["bg","cs","popup"],t)},t.detect=function(t,e){const n=!!t.IS_BG,r="safari"===e?function(){try{return t.safari.extension.globalPage.contentWindow!==t}catch(t){return!1}}():!!t.IS_POPUP;return n?"bg":r?"popup":"cs"}}(Et||(Et={})),function(t){t.create=function(t,e,n){return{browser:t,env:e,context:n}}}(St||(St={})),function(t){t.create=function(t){return{type:wt.detect(t)||"other"}}}(At||(At={})),function(t){t.create=function(t){return{isWindows:-1!==t.navigator.appVersion.indexOf("Win"),isMac:-1!==t.navigator.appVersion.indexOf("Mac"),isChromeOS:-1!==t.navigator.appVersion.indexOf("CrOS")}}}(Ct||(Ct={})),function(t){t.create=function(t){return{browser:At.create(t),os:Ct.create(t)}}}(jt||(jt={}));var Ot,kt,It=n(27061);!function(t){function e(t,e,n,r,o,i,s,c){return{env:t,major_number:e,build_number:n,release_number:r,git_branch:o,git_commit:i,edge_popup_url:s,empty_script_url:c}}t.create=e,t.fromBrowserify=function(){return e("prod","14","993","0","UNVERSIONED","UNVERSIONED",It.env.EDGE_POPUP_URL,It.env.EDGE_EMPTY_SCRIPT_URL)}}(Ot||(Ot={})),function(t){t.getTargetEnv=function(t){if(!t.env)throw new Error("processEnv.env is null or undefined");const e=xt.create(t.env);if(!e)throw new Error("Invalid processEnv.env: "+t.env);return e},t.create=function(t,e,n,r){const o=[n.major_number,n.build_number,n.release_number].map(rt);let i;if(3===o.length&&o.every((t=>void 0!==t)))i=o;else{let n;try{n=_t.getManifestVersion(t,e,window)}catch(t){}const r=(n||"").split(".").map(rt);i=3===r.length&&r.every((t=>void 0!==t))?r:[0,0,0]}const[s,c,a]=i;return{buildInfo:_t.create(s,c,a,t,r,n.git_branch,n.git_commit),bundleInfo:St.create(t,r,e),appConfig:mt.create(t,r,n.edge_popup_url,n.empty_script_url),systemInfo:jt.create(window)}}}(kt||(kt={}));const Tt=new class{constructor(t){this._getFallbackValue=t}init(t){if(void 0!==this._value)throw new Error("Global value already initialized.");this._value=t}get(){if(void 0===this._value){if(void 0===this._getFallbackValue)throw new Error("Global value not initialized and no fallback value provided.");this._value=this._getFallbackValue()}return this._value}}((()=>{throw new Error("Global config not initialized")}));function Pt(){return Tt.get()}function Mt(){return"edge"===Pt().bundleInfo.browser}function Rt(){return"bg"===Pt().bundleInfo.context}const Nt=function(){return i.Z.Date.now()};const Lt=function(t){return"symbol"==typeof t||g(t)&&"[object Symbol]"==b(t)};var Ut=/^\s+|\s+$/g,Ft=/^[-+]0x[0-9a-f]+$/i,Dt=/^0b[01]+$/i,zt=/^0o[0-7]+$/i,Vt=parseInt;const $t=function(t){if("number"==typeof t)return t;if(Lt(t))return NaN;if(z(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=z(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Ut,"");var n=Dt.test(t);return n||zt.test(t)?Vt(t.slice(2),n?2:8):Ft.test(t)?NaN:+t};var Bt=Math.max,Ht=Math.min;const Gt=function(t,e,n){var r,o,i,s,c,a,u=0,l=!1,h=!1,f=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(e){var n=r,i=o;return r=o=void 0,u=e,s=t.apply(i,n)}function p(t){return u=t,c=setTimeout(g,e),l?d(t):s}function b(t){var n=t-a;return void 0===a||n>=e||n<0||h&&t-u>=i}function g(){var t=Nt();if(b(t))return m(t);c=setTimeout(g,function(t){var n=e-(t-a);return h?Ht(n,i-(t-u)):n}(t))}function m(t){return c=void 0,f&&r?d(t):(r=o=void 0,s)}function v(){var t=Nt(),n=b(t);if(r=arguments,o=this,a=t,n){if(void 0===c)return p(a);if(h)return clearTimeout(c),c=setTimeout(g,e),d(a)}return void 0===c&&(c=setTimeout(g,e)),s}return e=$t(e)||0,z(n)&&(l=!!n.leading,i=(h="maxWait"in n)?Bt($t(n.maxWait)||0,e):i,f="trailing"in n?!!n.trailing:f),v.cancel=function(){void 0!==c&&clearTimeout(c),u=0,r=a=o=c=void 0},v.flush=function(){return void 0===c?s:m(Nt())},v};const qt=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return z(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Gt(t,e,{leading:r,maxWait:e,trailing:o})};var Zt;!function(t){t.TRACE="TRACE",t.DEBUG="DEBUG",t.INFO="INFO",t.WARN="WARN",t.ERROR="ERROR",t.FATAL="FATAL"}(Zt||(Zt={}));const Wt={[Zt.TRACE]:1,[Zt.DEBUG]:2,[Zt.INFO]:3,[Zt.WARN]:4,[Zt.ERROR]:5,[Zt.FATAL]:6};function Kt(t){return Wt[t]||0}class Yt{constructor(t,e){this.name=t,this._createLogger=e}trace(t,e,n){void 0===this._logger&&(this._logger=this._createLogger(this.name)),this._logger.trace(t,e,n)}debug(t,e,n){void 0===this._logger&&(this._logger=this._createLogger(this.name)),this._logger.debug(t,e,n)}info(t,e,n){void 0===this._logger&&(this._logger=this._createLogger(this.name)),this._logger.info(t,e,n)}warn(t,e,n){void 0===this._logger&&(this._logger=this._createLogger(this.name)),this._logger.warn(t,e,n)}error(t,e,n){void 0===this._logger&&(this._logger=this._createLogger(this.name)),this._logger.error(t,e,n)}fatal(t,e,n){void 0===this._logger&&(this._logger=this._createLogger(this.name)),this._logger.fatal(t,e,n)}}class Jt extends class{constructor(t){this.name=t,this._isError=t=>{const e=t;return e&&(void 0!==e.message&&void 0!==e.name||void 0!==e.stack)}}trace(t,e,n){this._logMessage(Zt.TRACE,t,e,n)}debug(t,e,n){this._logMessage(Zt.DEBUG,t,e,n)}info(t,e,n){this._logMessage(Zt.INFO,t,e,n)}warn(t,e,n){this._logMessage(Zt.WARN,t,e,n)}error(t,e,n){this._logMessage(Zt.ERROR,t,e,n)}fatal(t,e,n){this._logMessage(Zt.FATAL,t,e,n)}_logMessage(t,e,n,r){const o={level:t,loggerName:this.name,message:e,timestamp:new Date};n&&(this._isError(n)?o.exception=n:o.data=n),o.data=o.data||r,this.handleEvent(o)}}{constructor(t,e){super(t),this._config=e}handleEvent(t){this._config.filterFn(t)&&this._config.writer.write(t)}}function Xt(t){return new Proxy({},{get(e,n){const r=t[n];return r&&"function"==typeof r?r.bind(t):void 0}})}class Qt{constructor(){this._writeFunc=Qt._commonWriteFunc}write(t){try{const e=[`grm ${t.level} 【${t.loggerName}】░░ ${t.message}`];t.data&&e.push(t.data),t.exception&&e.push(t.exception),this._writeFunc[t.level].apply(null,e)}catch(t){}}}Qt._commonWriteFunc=function(){const{log:t,info:e,warn:n,error:r}=Xt(console);return{[Zt.TRACE]:t,[Zt.DEBUG]:t,[Zt.INFO]:e,[Zt.WARN]:n,[Zt.ERROR]:r,[Zt.FATAL]:r}}();class te{constructor(t){const e=t.testArgs,n=e&&e.processEnv?e.processEnv:Ot.fromBrowserify(),r=kt.getTargetEnv(n),o="prod"!==r||"cs"!==t.context,i={create(t){return new Jt(t,{writer:new Qt,filterFn:o?t=>!0:(e=Zt.ERROR,t=>Kt(t.level)>=Kt(e))});var e}},s=function(t,e,n,r){const o=kt.create(t,e,n,r);return Tt.init(o),window.GR_CFG=Tt.get(),o}(t.browser,t.context,n,r);this.config=s,this.logger=i}static getInstance(){if(void 0===this._instanceShared)throw new Error("Env not inited yet");return this._instanceShared}static initShared(t){if(void 0!==this._instanceShared)throw new Error("Env already inited");this._instanceShared=t}}var ee;!function(t){t.create=function(t){return new Yt(t,(()=>te.getInstance().logger.create(t)))}}(ee||(ee={}));const ne=ee.create("extension-api");var re=n(27061);let oe;function ie(t){if(oe)return oe;const e=(re&&re.env,t);return oe=e,e}function se(){return oe||ie((Rt()?ut(window.extensionBackgroundPageApi,"background page extension api was not initialized"):ut(window.extensionContentScriptApi,"content script extension api was not initialized")).message)}const ce=function(t){const e={},n=t||{};return n.emit=function(t,n){t=r(t);const o=e[t];if(!o)return;const i=o.concat();for(let t=0;t<i.length;t++)i[t](n)},n.emitArgs=function(t){t=r(t);const n=e[t],o=[].slice.call(arguments,1);if(!n)return;const i=n.concat();for(let t=0;t<i.length;t++)i[t].apply(null,o)},n.on=function(t,o){return t=r(t),e[t]=e[t]||[],e[t].push(o),{un:function(){n.un(t,o)}}},n.off=n.un=function(t,n){t=r(t);const o=e[t];if(!o)return;const i=o.indexOf(n);i>-1&&(o.splice(i,1),o.length>0||delete e[t])},n.one=function(t,e){const r=n.on(t,((...t)=>{r.un(),e.apply(null,t)}))},n.delegate=function(t,e,o){e=r(e),n.on(e,(function(n){t.emit(o||e,n)}))},n;function r(t){return"string"!=typeof t?t.join(" "):t}}({}),ae={};function ue(t){const e=se();"content-script-message-api"===e.kind&&e.onBackgroundPortReconnect&&e.onBackgroundPortReconnect(t)}const le=qt((t=>ce.emit("__bgerror",t)),1e3);function he(t){ie(t),Q(document,"grammarly:offline",(()=>le("proxy dead")),void 0)}function fe(t,e){de(t,(function n(...r){pe(t,n),e.apply(this,r)}))}function de(t,e){if("__bgerror"===t)return void ce.on("__bgerror",e);const n=ae[t]=ae[t]||[];if(n.push(e),1===n.length)try{se().listen(t,((...t)=>{for(const e of n)e(...t)}))}catch(t){le(t)}}function pe(t,e){if("__bgerror"===t)return void ce.off("__bgerror",e);const n=ae[t];if(!n)return;const r=n.indexOf(e);-1!==r&&n.splice(r,1),0===n.length&&delete ae[t]}function be(t){try{const e=se();switch(e.kind){case"background-message-api":e.broadcast(t,{});break;default:throw new Error("emitTabs can be used only on background")}}catch(t){le(t)}}function ge(t,e,n={},r=it,o=it,i){try{if(!t)throw TypeError("emitTo can't be used without destination point");const s=se();switch(s.kind){case"background-message-api":s.sendTo(t,e,n,r,o,i);break;default:throw new Error("emitTo can be used only on background")}}catch(t){le(t)}}function me(){const t=se();if("background-message-api"===t.kind)return t.topFrameId;throw new Error("topFrameId can only be retreived on background")}function ve(t,e){try{se().toFocused(t,e)}catch(t){le(t)}}function ye(t,e,n,r){try{const o=se();switch(o.kind){case"content-script-message-api":o.broadcastBackground(t,e,n,r);break;default:throw new Error("emitBackground can be used only in content script")}}catch(t){le(t)}}function _e(t,e={},n=1e4){const r=new Promise(((n,r)=>{try{const o=se();switch(o.kind){case"content-script-message-api":o.broadcastBackground(t,e,n,r);break;default:throw new Error("promiseBackground can be used only on client scripts")}}catch(t){r(t),le(t)}}));return Promise.race([r,J(n).then((()=>{throw new Error(`Request to bg page (${oe}) rejected by timeout`)}))])}var we=function(t,e){return(we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function xe(t,e){function n(){this.constructor=t}we(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Ee(t){return"function"==typeof t}var Se=!1,Ae={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;Se=t},get useDeprecatedSynchronousErrorHandling(){return Se}};function Ce(t){setTimeout((function(){throw t}),0)}var je={closed:!0,next:function(t){},error:function(t){if(Ae.useDeprecatedSynchronousErrorHandling)throw t;Ce(t)},complete:function(){}},Oe=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function ke(t){return null!==t&&"object"==typeof t}var Ie=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),Te=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this,r=n._parentOrParents,o=n._unsubscribe,i=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var s=0;s<r.length;++s){r[s].remove(this)}if(Ee(o))try{o.call(this)}catch(t){e=t instanceof Ie?Pe(t.errors):[t]}if(Oe(i)){s=-1;for(var c=i.length;++s<c;){var a=i[s];if(ke(a))try{a.unsubscribe()}catch(t){e=e||[],t instanceof Ie?e=e.concat(Pe(t.errors)):e.push(t)}}}if(e)throw new Ie(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof t){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function Pe(t){return t.reduce((function(t,e){return t.concat(e instanceof Ie?e.errors:e)}),[])}var Me=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Re=function(t){function e(n,r,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=je;break;case 1:if(!n){i.destination=je;break}if("object"==typeof n){n instanceof e?(i.syncErrorThrowable=n.syncErrorThrowable,i.destination=n,n.add(i)):(i.syncErrorThrowable=!0,i.destination=new Ne(i,n));break}default:i.syncErrorThrowable=!0,i.destination=new Ne(i,n,r,o)}return i}return xe(e,t),e.prototype[Me]=function(){return this},e.create=function(t,n,r){var o=new e(t,n,r);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(Te),Ne=function(t){function e(e,n,r,o){var i,s=t.call(this)||this;s._parentSubscriber=e;var c=s;return Ee(n)?i=n:n&&(i=n.next,r=n.error,o=n.complete,n!==je&&(Ee((c=Object.create(n)).unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(s))),s._context=c,s._next=i,s._error=r,s._complete=o,s}return xe(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;Ae.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=Ae.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):Ce(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;Ce(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};Ae.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),Ae.useDeprecatedSynchronousErrorHandling)throw t;Ce(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!Ae.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return Ae.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(Ce(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(Re);var Le=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Ue(){}function Fe(t){return t?1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}:Ue}var De=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,o=function(t,e,n){if(t){if(t instanceof Re)return t;if(t[Me])return t[Me]()}return t||e||n?new Re(t,e,n):new Re(je)}(t,e,n);if(r?o.add(r.call(o,this.source)):o.add(this.source||Ae.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),Ae.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){Ae.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,n=e.closed,r=e.destination,o=e.isStopped;if(n||o)return!1;t=r&&r instanceof Re?r:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=ze(e))((function(e,r){var o;o=n.subscribe((function(e){try{t(e)}catch(t){r(t),o&&o.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[Le]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:Fe(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=ze(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function ze(t){if(t||(t=Ae.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function Ve(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new $e(t,e))}}var $e=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Be(t,this.project,this.thisArg))},t}(),Be=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.project=n,o.count=0,o.thisArg=r||o,o}return xe(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Re);function He(t,e,n,r){return Ee(n)&&(r=n,n=void 0),r?He(t,e,n).pipe(Ve((function(t){return Oe(t)?r.apply(void 0,t):r(t)}))):new De((function(r){Ge(t,e,(function(t){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(t)}),r,n)}))}function Ge(t,e,n,r,o){var i;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var s=t;t.addEventListener(e,n,o),i=function(){return s.removeEventListener(e,n,o)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var c=t;t.on(e,n),i=function(){return c.off(e,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var a=t;t.addListener(e,n),i=function(){return a.removeListener(e,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var u=0,l=t.length;u<l;u++)Ge(t[u],e,n,r,o)}r.add(i)}var qe=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return xe(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,n){return t.call(this)||this}return xe(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(Te)),Ze=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}(),We=function(t){function e(n,r){void 0===r&&(r=Ze.now);var o=t.call(this,n,(function(){return e.delegate&&e.delegate!==o?e.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return xe(e,t),e.prototype.schedule=function(n,r,o){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,o):t.prototype.schedule.call(this,n,r,o)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(Ze),Ke=new We(qe);function Ye(t,e){var n;return void 0===t&&(t=0),void 0===e&&(e=Ke),(Oe(n=t)||!(n-parseFloat(n)+1>=0)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=Ke),new De((function(n){return n.add(e.schedule(Je,t,{subscriber:n,counter:0,period:t})),n}))}function Je(t){var e=t.subscriber,n=t.counter,r=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:r},r)}function Xe(t){return t&&"function"==typeof t.schedule}var Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xe(e,t),e.prototype.notifyNext=function(t,e,n,r,o){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(Re),tn=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parent=e,o.outerValue=n,o.outerIndex=r,o.index=0,o}return xe(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(Re),en=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}};function nn(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var rn=nn(),on=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function sn(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var cn=function(t){if(t&&"function"==typeof t[Le])return r=t,function(t){var e=r[Le]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(on(t))return en(t);if(sn(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Ce),t};if(t&&"function"==typeof t[rn])return e=t,function(t){for(var n=e[rn]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,r,o=ke(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function an(t,e,n,r,o){if(void 0===o&&(o=new tn(t,n,r)),!o.closed)return e instanceof De?e.subscribe(o):cn(e)(o)}function un(t,e){return new De((function(n){var r=new Te,o=0;return r.add(e.schedule((function(){o!==t.length?(n.next(t[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function ln(t,e){return e?un(t,e):new De(en(t))}var hn={};var fn=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new dn(t,this.resultSelector))},t}(),dn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return xe(e,t),e.prototype._next=function(t){this.values.push(hn),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(an(this,r,r,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,o){var i=this.values,s=i[n],c=this.toRespond?s===hn?--this.toRespond:this.toRespond:0;i[n]=e,0===c&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Qe),pn=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}();function bn(t,e){return function(n){return n.lift(new gn(t,e))}}var gn=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new mn(t,this.predicate,this.thisArg))},t}(),mn=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.predicate=n,o.thisArg=r,o.count=0,o}return xe(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(Re),vn=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),yn=new De((function(t){return t.complete()}));function _n(t){return t?function(t){return new De((function(e){return t.schedule((function(){return e.complete()}))}))}(t):yn}function wn(t){return function(e){return 0===t?_n():e.lift(new xn(t))}}var xn=function(){function t(t){if(this.total=t,this.total<0)throw new vn}return t.prototype.call=function(t,e){return e.subscribe(new En(t,this.total))},t}(),En=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return xe(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(Re);function Sn(t){return void 0===t&&(t=null),function(e){return e.lift(new An(t))}}var An=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new Cn(t,this.defaultValue))},t}(),Cn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.defaultValue=n,r.isEmpty=!0,r}return xe(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(Re);function jn(t){return void 0===t&&(t=In),function(e){return e.lift(new On(t))}}var On=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new kn(t,this.errorFactory))},t}(),kn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.errorFactory=n,r.hasValue=!1,r}return xe(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(Re);function In(){return new pn}function Tn(t){return t}var Pn=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new Mn(t,this.value))},t}(),Mn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.value=n,r}return xe(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(Re);function Rn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return Xe(n)?(t.pop(),un(t,n)):ln(t)}function Nn(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[Le]}(t))return function(t,e){return new De((function(n){var r=new Te;return r.add(e.schedule((function(){var o=t[Le]();r.add(o.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if(sn(t))return function(t,e){return new De((function(n){var r=new Te;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if(on(t))return un(t,e);if(function(t){return t&&"function"==typeof t[rn]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new De((function(n){var r,o=new Te;return o.add((function(){r&&"function"==typeof r.return&&r.return()})),o.add(e.schedule((function(){r=t[rn](),o.add(e.schedule((function(){if(!n.closed){var t,e;try{var o=r.next();t=o.value,e=o.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),o}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function Ln(t,e){return e?Nn(t,e):t instanceof De?t:new De(cn(t))}function Un(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(r){return r.pipe(Un((function(n,r){return Ln(t(n,r)).pipe(Ve((function(t,o){return e(n,t,r,o)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new Fn(t,n))})}var Fn=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new Dn(t,this.project,this.concurrent))},t}(),Dn=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=n,o.concurrent=r,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return xe(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=new tn(this,void 0,void 0);this.destination.add(r),an(this,t,e,n,r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,o){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(Qe);function zn(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),Un(Tn,t)}function Vn(){return zn(1)}function $n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Vn()(Rn.apply(void 0,t))}function Bn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return Xe(n)?(t.pop(),function(e){return $n(t,e,n)}):function(e){return $n(t,e)}}function Hn(t,e){return function(n){return n.lift(new Gn(t,e))}}var Gn=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new qn(t,this.compare,this.keySelector))},t}(),qn=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.keySelector=r,o.hasKey=!1,"function"==typeof n&&(o.compare=n),o}return xe(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(t){return this.destination.error(t)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;r||(this.key=e,this.destination.next(t))},e}(Re);class Zn{constructor(){this._storage=this._storage||{}}get _storage(){return window.__CS_SHARE_STORAGE__}set _storage(t){window.__CS_SHARE_STORAGE__=t}clean(){this._storage={}}set(t,e){this._storage[t]=e}get(t){return this._storage[t]}getOnce(t){const e=this._storage[t];return this.remove(t),e}remove(t){delete this._storage[t]}}var Wn;function Kn(t){return new Promise(((e,n)=>Promise.resolve(t).then(n,e)))}!function(t){function e(t){return new Promise(t)}t.create=e,t.createCompletionSource=function(){let t,e;return{promise:new Promise(((n,r)=>{t=n,e=r})),resolve(e){t(e)},reject(t){e(t)}}},t.sync=function(t){return e(((e,n)=>e(t())))},t.delay=function(e){return t.create((t=>{setTimeout((()=>{t()}),e)}))}}(Wn||(Wn={}));Error;class Yn{constructor(t,e=ee.create(Yn.name)){this._transport=t,this._log=e,this._calls=new Map,this._sub=this._transport.inbound.subscribe((t=>{const e=this._calls.get(t.id);if(e)try{"err"in t?e.reject(t.err):e.resolve(t.res)}finally{this._calls.delete(t.id)}else this._log.warn("received rpc call response for unregistered call "+t.id)})),this.api=new Proxy({},{get:(t,e)=>"then"===e?void 0:(...t)=>this._handleCall(e,t)})}_handleCall(t,e){let n=st.create();for(;this._calls.has(n);)n=st.create();const r=Wn.createCompletionSource();return this._calls.set(n,r),this._transport.outbound({id:n,method:t,args:e}),r.promise}dispose(){this._sub.unsubscribe()}}class Jn{constructor(t,e,n=st.create(),r=t){this._rpcMessageName=t,this._message=e,this._clientId=n,this._inboundMessageName=r,this.inbound=new De((t=>{const e=e=>{e.clientId===this._clientId&&t.next(e.data)};return this._message.on(this._inboundMessageName,e),()=>this._message.off(this._inboundMessageName,e)})),this.outbound=t=>{this._message.emitBackground(this._rpcMessageName,{clientId:this._clientId,data:t})}}}class Xn extends Yn{constructor(t){super(new Jn("cs-to-bg-rpc-1557421403805",t))}}function Qn(t){return"tunnel"!==t.tag}var tr;!function(t){t.isSubscribe=t=>"action"in t.data&&"subscribe"===t.data.action,t.isUnsubscribe=t=>"action"in t.data&&"unsubscribe"===t.data.action,t.isDispose=t=>"action"in t.data&&"dispose"===t.data.action,t.isPong=t=>"pong"in t.data,t.isPing=t=>"ping"in t.data,t.isObservableResult=t=>"subscribableId"in t}(tr||(tr={}));const er=Symbol();class nr{constructor(t,e,n=ee.create(nr.name),r){this._transport=t,this._observableTransport=e,this._log=n,this._serverId=r,this._calls=new Map,this._subscribeRelatedCalls=new Map,this._observables=new Map,this._subscribers=new Map,this._transportSubscription=this._transport.inbound.pipe(bn(Qn)).subscribe((t=>{this._processResponse(t)})),this._observableTransportSubscription=this._observableTransport.inbound.pipe(bn(Qn)).subscribe((t=>{this._processObservableMessage(t)})),this.api=new Proxy({},{get:(t,e)=>"then"===e?void 0:(...t)=>this._handleCall(e,t)})}_processResponse(t){const e=this._calls.get(t.id);if(e)try{if("err"in t)e.reject(t.err);else if(tr.isObservableResult(t))try{const n=new De((e=>this._createSubscribeHandler(t.subscribableId,e)));this._observables.set(t.subscribableId,n),e.resolve(n)}catch(e){this._observables.delete(t.subscribableId)}else e.resolve(this.transformResult(t.res))}finally{this._calls.delete(t.id)}else this._log.warn("received rpc call response for unregistered call "+t.id)}transformResult(t){return t}_processObservableMessage(t){if("subscribed"in t){const e=this._subscribeRelatedCalls.get(t.id);if(e)try{e.resolve()}finally{this._subscribeRelatedCalls.delete(t.id)}else this._log.warn("received rpc call subscribed response for unregistered subscribe call "+t.id)}else if("unsubscribed"in t){const e=this._subscribeRelatedCalls.get(t.id);if(e)try{e.resolve()}finally{this._subscribeRelatedCalls.delete(t.id),this._subscribers.delete(t.id)}else this._log.warn("received rpc call unsubscribed response for unregistered unsubscribe call "+t.id)}else if("next"in t)try{const e=this._subscribers.get(t.subscriptionId);e?e.subscriber.next(t.next):this._log.warn("received observable next message for unregistered subscription "+t.subscriptionId)}catch(e){this._subscribers.delete(t.subscriptionId)}else if("complete"in t)try{const e=this._subscribers.get(t.subscriptionId);e?(e.subscriber.complete(),this._subscribers.delete(t.subscriptionId)):this._log.warn("received observable complete for unregistered subscription "+t.subscriptionId)}catch(e){this._subscribers.delete(t.subscriptionId)}else if("err"in t)try{const e=this._subscribers.get(t.subscriptionId);e?e.subscriber.error(t.err):this._log.warn("received observable error for unregistered subscription  "+t.subscriptionId)}finally{this._subscribers.delete(t.subscriptionId)}else if("subErr"in t){const e=this._subscribeRelatedCalls.get(t.id);try{const n=this._subscribers.get(t.id);n?n.subscriber.error(t.subErr):this._log.warn("received subscription error response for unregistered call "+t.id)}finally{e&&(e.reject(t.subErr),this._subscribeRelatedCalls.delete(t.id)),this._observables.delete(t.subscribableId),this._subscribers.delete(t.id)}}else if("ping"in t)try{this._observables.get(t.ping)?this._observableTransport.outbound({pong:t.ping}):this._log.warn("received ping for unregistered observable "+t.ping)}finally{}}_handleCall(t,e){let n=st.create();for(;this._calls.has(n);)n=st.create();const r=Wn.createCompletionSource();this._calls.set(n,r);const o=e.map((t=>{return e=t,Boolean(e)&&e._tag===er?t.toJSON():t;var e}));return this._transport.outbound({id:n,method:t,args:o,serverId:this._serverId}),r.promise}_createSubscribeHandler(t,e){let n=st.create();for(;this._subscribeRelatedCalls.has(n);)n=st.create();const r=Wn.createCompletionSource();return this._subscribeRelatedCalls.set(n,r),this._observableTransport.outbound({id:n,subscribableId:t,action:"subscribe"}),this._subscribers.set(n,{subscribableId:t,subscriber:e}),()=>{this._handleUnsubscribe(n,t)}}_handleUnsubscribe(t,e){let n=st.create();for(;this._subscribeRelatedCalls.has(n);)n=st.create();const r=Wn.createCompletionSource();return this._subscribeRelatedCalls.set(n,r),this._observableTransport.outbound({id:n,subscriptionId:t,subscribableId:e,action:"unsubscribe"}),this._subscribers.delete(t),r.promise}dispose(){for(const t of this._observables.keys())this._observableTransport.outbound({id:st.create(),subscribableId:t,action:"dispose"});this._observables.clear(),this._transportSubscription.unsubscribe(),this._observableTransportSubscription.unsubscribe(),this._calls.clear(),this._subscribeRelatedCalls.clear()}}class rr extends nr{constructor(t){super(new Jn("cs-to-bg-rpc-1587687052565",t),new Jn("cs-to-bg-observable-rpc-1587687052565",t))}}class or extends te{constructor(e){var n;super({browser:e.browser,context:"cs"}),this.browserApi=e.browserApi,he(e.browserApi.message),e.skipInitExtensionApi||(n=e.browserApi,window.extensionContentScriptApi&&ne.warn("Content Script Extension Api init called more than once"),window.extensionContentScriptApi=window.extensionContentScriptApi||n),this.bgRpc=new Xn(t),this.csShareStorage=new Zn,this.capiBgRpc=new rr(t)}static getInstance(){if(void 0===this._instance)throw new Error("Env not inited yet");return this._instance}static init(t){if(void 0!==this._instance)throw new Error("Env already inited");const e=new or(t);return this._instance=e,te.initShared(e),e.browserApi.message.start&&e.browserApi.message.start(),e}}const ir=2147483642;var sr;!function(t){function e(t,e){try{for(const n of Object.keys(e))if(e[n]&&e[n](t))return n;return null}catch(t){return null}}t.isSpecific={draftJs:t=>!(!t.hasAttribute("contenteditable")||!t.querySelector('[data-contents="true"] > [data-editor], [data-block]')),quill:t=>t.classList.contains("ql-editor")||t.classList.contains("ql-container"),redactor:t=>t.className.indexOf("redactor")>-1,prosemirror:t=>t.hasAttribute("pm-container")||t.classList.contains("ProseMirror"),scribe:t=>t.className.indexOf("scribe")>-1,trix:t=>t.className.indexOf("trix")>-1,"medium-editor":t=>t.className.indexOf("medium-editor")>-1,tinymce:t=>{if("IFRAME"!==t.tagName)return!1;const e=t;return e.id.indexOf("mce")>-1||!!(e.contentDocument&&e.contentDocument.querySelectorAll("#tinymce, .mce-content-body").length>0)},ckeditor4:t=>t.matches("iframe.cke_wysiwyg_frame")||t.classList.contains("cke_editable"),ckeditor5:t=>t.classList.contains("ck-editor__editable"),slate:t=>"true"===t.getAttribute("data-slate-editor"),mobiledoc:t=>t.classList.contains("__mobiledoc-editor")},t.isGeneric={contenteditable:t=>{const e=t.attributes.getNamedItem("contenteditable");return!(!e||"true"!==e.value&&""!==e.value&&"plaintext-only"!==e.value)},textarea:t=>"TEXTAREA"===t.tagName,iframe:e=>{if("IFRAME"===e.tagName){const n=e;return!!(n.contentDocument&&n.contentDocument.body&&t.isGeneric.contenteditable(n.contentDocument.body))}return!1},iframeHost:e=>{if("IFRAME"===e.tagName){const n=e;return!(n.contentDocument&&n.contentDocument.body&&t.isGeneric.contenteditable(n.contentDocument.body))}return!1}},t.get=function(n){return{generic:e(n,t.isGeneric),specific:e(n,t.isSpecific)}}}(sr||(sr={}));var cr=1,ar={};var ur,lr=function(t){var e=cr++;return ar[e]=t,Promise.resolve().then((function(){return function(t){var e=ar[t];e&&e()}(e)})),e},hr=function(t){delete ar[t]},fr=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return xe(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=lr(e.flush.bind(e,null))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(hr(n),e.scheduled=void 0)},e}(qe),dr=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xe(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,o=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<o&&(t=n.shift()));if(this.active=!1,e){for(;++r<o&&(t=n.shift());)t.unsubscribe();throw e}},e}(We))(fr);function pr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,r=null,o=t[t.length-1];return Xe(o)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof o&&(n=t.pop()),null===r&&1===t.length&&t[0]instanceof De?t[0]:zn(n)(ln(t,r))}function br(t,e,n){return n?br(t,e).pipe(Ve((function(t){return Oe(t)?n.apply(void 0,t):n(t)}))):new De((function(n){var r,o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.next(1===t.length?t[0]:t)};try{r=t(o)}catch(t){return void n.error(t)}if(Ee(e))return function(){return e(o,r)}}))}function gr(t){var e=t.error;t.subscriber.error(e)}ur||(ur={});var mr=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){var t,e;switch(this.kind){case"N":return Rn(this.value);case"E":return t=this.error,new De(e?function(n){return e.schedule(gr,0,{error:t,subscriber:n})}:function(e){return e.error(t)});case"C":return _n()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();function vr(t,e){return void 0===e&&(e=0),function(n){return n.lift(new yr(t,e))}}var yr=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new _r(t,this.scheduler,this.delay))},t}(),_r=function(t){function e(e,n,r){void 0===r&&(r=0);var o=t.call(this,e)||this;return o.scheduler=n,o.delay=r,o}return xe(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new wr(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(mr.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(mr.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(mr.createComplete()),this.unsubscribe()},e}(Re),wr=function(){return function(t,e){this.notification=t,this.destination=e}}();function xr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call($n.apply(void 0,[e].concat(t)))}}function Er(t,e){return Un(t,e,1)}const Sr=1e3;var Ar;!function(t){const e=ee.create("universal.cs.integration.observables"),n=t=>He(t,"focus",!0);function r(t,e){return{document:t,frame:e}}t.createFocusObservable=function(t,o,i=n){return function(t,n){const o=r(t),i=Ln(t.getElementsByTagName("iframe")),s=n.pipe(Er((t=>Array.from(t.addedNodes))),bn((t=>"IFRAME"===t.nodeName)));return i.pipe(xr(s),bn((n=>function(t,n){try{const e=t.src;if(e&&"about:blank"!==e&&!e.startsWith("javascript")){return new URL(e,n.baseURI).origin===n.location.origin}return!0}catch(t){return e.warn("Error converting iframe's src to url",t),!0}}(n,t))),Un((t=>{try{return function(t){const e=t.contentDocument;return e&&"complete"===e.readyState}(t)?Rn(t):br((e=>t.addEventListener("load",e,!0)),(e=>t.removeEventListener("load",e)),(()=>t)).pipe(wn(1))}catch(t){return e.warn("failed to receive iframes document",t),Rn(null)}})),Ve((t=>{try{if(null!==t&&null!==t.contentDocument)return r(t.contentDocument,t)}catch(t){e.warn("failed to receive iframes document",t)}return null})),bn((t=>null!==t))).pipe(Bn(o))}(t,o).pipe(Un((t=>function(t,e,n){const r=t.document,o=Ye(Sr),i=t.frame?_n():(u=()=>Rn(r.activeElement).pipe(bn((t=>t&&r.defaultView&&r.defaultView.HTMLElement&&t instanceof r.defaultView.HTMLElement))),new De((function(t){var e;try{e=u()}catch(e){return void t.error(e)}return(e?Ln(e):_n()).subscribe(t)}))),s=e(r).pipe(Ve((t=>t.target))),c=t.frame?_n():pr(o,n).pipe(bn((t=>!!r.defaultView&&"visible"===r.visibilityState&&!!r.activeElement)),Ve((t=>r.activeElement)),Hn()),a=pr(c,s).pipe(bn((t=>r.defaultView&&r.defaultView.HTMLElement&&t instanceof r.defaultView.HTMLElement)),Ve((t=>t)));var u;return i.pipe(xr(a),Hn())}(t,i,o).pipe(Ve((e=>({element:e,owner:t})))))),Hn(),vr(dr))}}(Ar||(Ar={}));var Cr=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),jr=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return xe(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(Te),Or=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return xe(e,t),e}(Re),kr=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return xe(e,t),e.prototype[Me]=function(){return new Or(this)},e.prototype.lift=function(t){var e=new Ir(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new Cr;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new Cr;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new Cr;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new Cr;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new Cr;return this.hasError?(t.error(this.thrownError),Te.EMPTY):this.isStopped?(t.complete(),Te.EMPTY):(this.observers.push(t),new jr(this,t))},e.prototype.asObservable=function(){var t=new De;return t.source=this,t},e.create=function(t,e){return new Ir(t,e)},e}(De),Ir=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return xe(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):Te.EMPTY},e}(kr);function Tr(){return function(t){return t.lift(new Pr(t))}}var Pr=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new Mr(t,n),o=e.subscribe(r);return r.closed||(r.connection=n.connect()),o},t}(),Mr=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return xe(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(Re),Rr=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return xe(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new Te).add(this.source.subscribe(new Lr(this.getSubject(),this))),t.closed&&(this._connection=null,t=Te.EMPTY)),t},e.prototype.refCount=function(){return Tr()(this)},e}(De),Nr=function(){var t=Rr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),Lr=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return xe(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(Or);var Ur,Fr=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),o=n(r).subscribe(t);return o.add(e.subscribe(r)),o},t}();function Dr(){return new kr}function zr(){return function(t){return Tr()((e=Dr,function(t){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof n)return t.lift(new Fr(r,n));var o=Object.create(t,Nr);return o.source=t,o.subjectFactory=r,o})(t));var e,n}}!function(t){function e(t,e){return n(t,e).pipe(zr(),vr(dr))}function n(t,e){return new De((n=>{const r=new MutationObserver((t=>n.next(t)));return r.observe(t,e),()=>r.disconnect()}))}t.create=e,t.createUnsafe=n,t.createFlattenHot=function(t,e){return n(t,e).pipe(Er((t=>t)),zr())},t.observeAttribute=function(t,n){return e(t,{attributes:!0,attributeFilter:[n],subtree:!1,childList:!1}).pipe(Ve((e=>t.getAttribute(n))))},t.observeStyle=function(t){return e(t,{attributes:!0,attributeFilter:["style"],subtree:!1,childList:!1}).pipe(Ve((e=>t.style)))},t.observeChildList=function(t){return e(t,{attributes:!1,subtree:!1,childList:!0}).pipe(Ve((e=>t.childNodes)))}}(Ur||(Ur={}));var Vr=n(52961);const $r="data-enable-grammarly";["id","email","firstName","anonymous","type","subscriptionFree","experiments","isTest","premium","settings","registrationDate","mimic","groups","extensionInstallDate","fixed_errors","edc","institutionInfo"].push("token");const Br=["data-gramm_editor","data-gramm","data-gramm_id","gramm_editor","readonly","disabled"],Hr=["pm-container",{name:"class",value:"ProseMirror"},"data-synchrony",{name:"data-gramm",value:"false"},{name:$r,value:"false"},{name:"aria-label",value:"Search Facebook"}],Gr=["changed-user","changed-plan","changed-dialect","cleanup","editor-fix"];function qr(t,e){let n=t.parentNode;for(;null!==n;){if(Wr(n,e))return n;n=n.parentNode}return!1}function Zr(t){return"true"===t.contentEditable||"plaintext-only"===t.contentEditable}function Wr(t,e){if(!t)return!1;const n=t.matches||t.msMatchesSelector||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector;return!!n&&n.apply(t,[e])}function Kr(t,e=null,n){return this.addEventListener(t,e,n),{off:()=>Yr.apply(this,[t,e,n])}}function Yr(t,e,n){this.removeEventListener(t,e||null,n)}const Jr=ee.create("lib.external");function Xr(t){const e=document.createElement("script");e.innerHTML=t,document.head.appendChild(e),e.parentNode&&e.parentNode.removeChild(e)}function Qr(){Xr(`window.GR_EXTENSION_ID='${Pt().appConfig.extensionId}'`),Xr("\n    window.GR_EXTENSION_SEND = function(key, data) {\n      if (!key) throw new TypeError('cant be called without message')\n      var e = document.createEvent('CustomEvent')\n      e.initCustomEvent('external:' + key, true, true, data)\n      document.dispatchEvent(e)\n    }\n  ");const t=Gr.map((t=>{const e="external:"+t;return Kr.call(document,e,(({detail:t})=>{Jr.trace("external event",{event:e,detail:t}),ye(e,t)}))}));return{dispose:()=>{Xr("\n        delete window.GR_EXTENSION_ID\n        delete window.GR_EXTENSION_SEND\n      "),t.forEach((t=>t.off()))}}}function to(t,e){const n=t.anchorNode;if(!n)return!1;const r=Br.map((t=>Array.isArray(t)?`[${t[0]}="${t[1]}"]`:`[${t}]`)).join(","),o=e.activeElement,i=t.toString().trim(),s="TEXTAREA"!==n.tagName&&"INPUT"!==n.tagName,c=!o||"INPUT"!==o.tagName&&"TEXTAREA"!==o.tagName,a=!Zr(n),u=!qr(n,r)&&!Wr(n,r),l=!qr(n,"[contenteditable=true],[contenteditable=plaintext-only]")&&!function(t){let e=t.parentNode;for(;null!==e;){if(Zr(e))return e;e=e.parentNode}return!1}(n);return!!(i&&s&&c&&a&&u&&l)}var eo=n(57238);const no="grExtInstalled",ro="grExtDisabled";function oo(t){null===t&&"next"===document.body.dataset[ro]||(null===t?delete document.body.dataset[ro]:document.body.dataset[ro]=t)}class io{constructor(t,e){this._bgRpc=t,this._csShareStorage=e,this._pageEnable=!0,this._enabledDefs=!1,this._isAnonymous=!0,this._wasLoaded=!1,this._mutations=Ur.createFlattenHot(window.document,{childList:!0,subtree:!0}),this._textFieldsObservable=Ar.createFocusObservable(window.document,this._mutations),this._subs=[this._textFieldsObservable.subscribe((t=>{const e=t.owner.frame||t.element,n=sr.get(e);this._pageEnable&&(n.generic||n.specific)&&this.load()})),io.clickObserver.subscribe((t=>{2===t.detail&&this._enabledDefs&&this._pageEnable&&!this._isAnonymous&&co.isValid()&&(this._csShareStorage.set("extensionDictionaryEvent",t),this._subs.push(co.animation()),this.load())}))],(t=>{if(window.location.href.includes("grammarly.com/extension-success")){const e=document.getElementById("click-to-run");e&&(e.onclick=()=>{var e,n;confirm("Always allow Grammarly to run on every website")?(t.api.enableClickToRunOnAllWebsites(),null===(e=document.getElementById("click-to-run-success"))||void 0===e||e.click()):null===(n=document.getElementById("click-to-run-fail"))||void 0===n||n.click()})}})(t)}load(){this._wasLoaded||(this._wasLoaded=!0,ao.callExecuteContentScript(),this.dispose(),this._bgRpc.api.loadContentScript())}dispose(){this._subs.forEach((t=>t.unsubscribe()))}updateState(t,e,n){!this._pageEnable&&e&&this.load(),this._isAnonymous=t,this._pageEnable=e,this._enabledDefs=n,oo(this._pageEnable?null:"forever")}}var so,co,ao;function uo(t,e){return{key:t,value:e}}function lo(t,e){return uo(t,e)}function ho(t){return t.map((t=>[t.key,t.value].map(encodeURIComponent).join("="))).join("&")}function fo(t,e){if(0===e.length)return t;const n=t.includes("?");return[t,ho(e)].join(n?"&":"?")}function po(t){const e=[];return void 0!==t.medium&&e.push(lo("utm_medium",t.medium)),void 0!==t.source&&e.push(lo("utm_source",t.source)),void 0!==t.campaign&&e.push(lo("utm_campaign",t.campaign)),t.clickToRun&&e.push(lo("click_to_run","true")),e}function bo(t){return po(t)}!function(t){t.clickObserver=He(window.document,"click",!0),t.start=function(e){ao.checkScriptInitStart();const n=or.init({...e,skipInitExtensionApi:!0}),r=new t(n.bgRpc,n.csShareStorage),o=so.init(n.config);de("state",(t=>{r.updateState(t.user.anonymous,t.page.enabled,t.page.enabledDefs)})),fe("contentScript-disconnected",(()=>{r.dispose(),o.dispose(),n.csShareStorage.clean()})),ao.checkScriptInitEnd(n.bgRpc)}}(io||(io={})),function(t){t.init=function(t){const e=function(){const t=document.location||document.defaultView.location;return t?t.hostname.replace("www.",""):""}(),n=[];return document.body.dataset.newGrCSCheckLoaded=t.buildInfo.version,document.body.dataset[no]="",window.location.protocol===t.appConfig.url.grammarlyProtocol&&e.match(`^([a-z\\-0-9]+\\.)*${t.appConfig.url.grammarlyDomain}$`)&&n.push(Qr()),{dispose:()=>{n.forEach((t=>t.dispose()))}}}}(so||(so={})),function(t){const e="important";function n(t){return t+"px"}t.isValid=function(){const t=window.document.getSelection();return!(!t||t.toString().match(/[0-9_±!@#$%^&*:"|<>?~().,:}{’='-/ /]/))&&to(t,window.document)},t.animation=function(){const t=document.createElement("div"),r=t.attachShadow({mode:"open"}),o=document.createElement("style");o.innerHTML=eo.__css,r.appendChild(o);const i=window.document.getSelection().getRangeAt(0).getBoundingClientRect(),s=document.createElement("div");s.style.setProperty("top",n(i.top),e),s.style.setProperty("left",n(i.left),e),s.style.setProperty("height",n(i.height),e),s.style.setProperty("max-width",n(i.width),e),s.style.setProperty("z-index",ir.toString(),e),s.classList.add(eo.animatedUnderline,eo.checkAnimatedUnderline),r.appendChild(s),document.body.appendChild(t);const c=Ye(10),a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null,r=null;return Xe(t[t.length-1])&&(r=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&Oe(t[0])&&(t=t[0]),ln(t,r).lift(new fn(n))}(io.clickObserver.pipe(function(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?bn((function(e,n){return t(e,n,r)})):Tn,wn(1),n?Sn(e):jn((function(){return new pn})))}}(),(u=!1,function(t){return t.lift(new Pn(u))}),Bn(!0),Hn()),c.pipe(Ve((()=>{const t="."+Vr.completeAnimation;if(document.querySelector(t))return!0;const e=Array.from(document.querySelectorAll("grammarly-extension"));for(const n of e)if(n.shadowRoot&&n.shadowRoot.querySelector(t))return!0;return!1})),Bn(!1),Hn())).pipe(bn((([t,e])=>!t||e)),Hn()).subscribe(l);var u;return{unsubscribe:l};function l(){a.unsubscribe(),t.remove()}}}(co||(co={})),function(t){const e=Date.now(),n=t=>window.performance.mark("@grammarly-extension:"+t);t.callExecuteContentScript=()=>n("callExecuteContentScript"),t.checkScriptInitEnd=t=>{const r=Math.random()<.01;if(n("checkScriptInitEnd"),t.api.feMetricsLogRate("checkScriptInitialized"),r){const t=Date.now();ye("tracking-call",{msg:"tracking/RPC",data:["sendFelogEvent",{ex_csInitPerf:{domain:window.location.host,initTime:t-e,pageLoadTime:t-window.performance.timing.responseEnd},hideUserInfo:!0,level:"INFO",logger:"checkScript.initialized"}]})}},t.checkScriptInitStart=()=>n("checkScriptInitStart")}(ao||(ao={}));uo("fromExtension",""+!0);po({medium:"internal"})[0];function go(t,e){return fo(Pt().appConfig.url.upgrade,bo({medium:"internal",source:t,campaign:e}))}function mo(t){const e=t.reduce(((t,e)=>{const n=t.get(e.category);return n?n.count++:t.set(e.category,{group:e.group,categoryHuman:e.categoryHuman,count:1}),t}),new Map);return Array.from(e.values()).sort(((t,e)=>e.count-t.count))}function vo(t){const e=new Map;for(const{isFree:n,cardLayout:{group:r}}of t){e.has(r)||e.set(r,{lensName:r,free:0,premium:0});const t=e.get(r);t&&(t[n?"free":"premium"]+=1)}return Array.from(e.values()).sort(((t,e)=>e.premium-t.premium))}function yo(t){return btoa(JSON.stringify(t))}class _o extends class{constructor(){this._log=ee.create("extension-api.alarms.stub"),this._warning="Method is not implemented"}create(t,e){return this._log.warn(this._warning),{dispose:it}}}{create(t,e){let n=null;const r=setTimeout((()=>{e.period&&(n=setInterval(t,e.period)),t()}),e.delay);return{dispose:()=>{clearTimeout(r),null!==n&&clearInterval(n)}}}}function wo(t,e){chrome.runtime.lastError?e(chrome.runtime.lastError):t()}class xo{constructor(){this._log=ee.create("extension-api.managed-storage.validator")}validate(t,e){switch(t){case"GrammarlyEnrollmentToken":return"string"==typeof e&&e.length>0&&/^[a-z0-9_-]+$/i.test(e);default:return this._log.warn("Unknown key: "+t),!1}}}class Eo{constructor(){this._log=ee.create("extension-api.managed-storage.chrome"),this._validator=new xo}get(t){return new Promise(((e,n)=>{chrome.storage.managed.get(t,(r=>{wo((()=>{const n=r[t];void 0===n||this._validator.validate(t,n)?e(n):(this._log.warn(`Invalid value for "${t}": ${JSON.stringify(r[t])}`),e(void 0))}),(e=>{this._log.error(`Could not get "${t}"`,e),n(e)}))}))}))}}const So="bridge",Ao="message:to-priv",Co="message:to-non-priv";var jo;!function(t){t[t.success=0]="success",t[t.successWithEmpty=1]="successWithEmpty",t[t.alreadyMigrated=2]="alreadyMigrated"}(jo||(jo={}));const Oo=ee.create("extension-api.message"),ko=()=>{};class Io{constructor(){this._listeners={},this._queue={},this.fire=(t,e,n=ko,r)=>{const o=this._listeners[t]||[];o.length?o.forEach((t=>t(e,n,r))):(this._queue[t]=this._queue[t]||[],this._queue[t].push({content:e,callback:n,sender:r}))},this.unlisten=(t,e)=>{const n=this._listeners[t]||[],r=n.indexOf(e);-1!==r&&(1===n.length?delete this._listeners[t]:n.splice(r,1))},this.listenOnce=(t,e)=>{const n=(r,o,i)=>{this.unlisten(t,n),e&&e(r,o,i)};this.listen(t,n)},this.listen=(t,e)=>{this._listeners[t]=this._listeners[t]||[],-1===this._listeners[t].indexOf(e)&&this._listeners[t].push(e);const n=this._queue[t]||[];if(n.length){for(const t of n)try{e(t.content,t.callback,t.sender)}catch(t){Oo.error("exception during proccesing buffered messages",t)}delete this._queue[t]}}}}const To=ee.create("extension-api.message.bg"),Po="popup";function Mo(t){if(!t)return!1;const{browser:e}=Pt().bundleInfo,n="firefox"===e?/^moz-extension:\/\/.*\/src\/popup.html$/:"chrome"===e||"edge"===e?chrome&&chrome.runtime&&chrome.runtime.id?new RegExp(chrome.runtime.id+"/src/popup.html"):void 0:nt(e);return void 0!==n&&n.test(t)}class Ro{constructor(t,e,n){this._getActiveTab=e,this._getAllTabs=n,this.kind="background-message-api",this.topFrameId="0",this._callbacks={},this._tabPorts={popup:[]},this._messageHelper=new Io,this._sendMessageToPorts=(t,e)=>{const n=this._tabPorts[t];n&&n.forEach((t=>t.postMessage(e)))},this.toFocused=(t,e)=>this._getActiveTab().then((({id:n,url:r}={})=>{if(n)return Mo(r)?To.warn("toFocussed not allowed for popup when it open like regular tab "+t,e):void this._sendMessageToPorts(n.toString(),{type:t,content:e,callid:Y()})})),this.broadcast=(t,e)=>{if(!e)return;const n=({id:n,url:r})=>{n&&r&&-1===r.indexOf("chrome-extension:")&&this._sendMessageToPorts(n.toString(),{type:t,callid:Y(),content:e})};this._getAllTabs().then((t=>t.forEach(n))),this._tabPorts.popup&&this._tabPorts.popup.length&&this._getActiveTab().then((({url:t}={})=>{n({id:Po,url:t})}))},this._initPortListener=t=>{if(t.name===So)t.onMessage((t=>{"message.toFocussed"===t.method&&this.toFocused(t.params&&t.params.type,t.params&&t.params.content)}));else if(t.name===Co)t.onMessage((t=>this.broadcast(t.type,t.content)));else if(t.name===Ao){const{sender:e}=t;if(e){if(e.tab){const{id:n,url:r}=e.tab;if(n){let e=this._tabPorts[n];void 0===e&&(e=this._tabPorts[n]=[]),e.push(t)}r&&0===r.indexOf("http")&&this._messageHelper.fire("tab-connected",{tab:n,url:r}),t.onDisconnect((()=>{if(!n)return;const e=this._tabPorts[n];e&&e.splice(e.indexOf(t),1)}))}const n=e.url?e.url:e.tab?e.tab.url:"";if(n&&Mo(n)){const e=Po;this._tabPorts[e]=this._tabPorts[e]||[],this._tabPorts[e].push(t),t.onDisconnect((()=>{const n=this._tabPorts[e];n.splice(n.indexOf(t),1)}))}}t.onMessage((n=>{const r=({callid:n,content:r,type:o})=>{this._callbacks[n]&&(this._callbacks[n](r),delete this._callbacks[n]);this._messageHelper.fire(o,r,(e=>t.postMessage({content:e,callid:n})),e&&e.tab?{tabId:String(e.tab.id),frameId:void 0===e.frameId?void 0:String(e.frameId)}:-1)};"tab-connected"===n.type?this._getActiveTab().then((({url:t}={})=>{n.content={tab:Po,url:t},r(n)})):r(n)}))}},t(this._initPortListener)}getPortExists(t){return!!this._tabPorts[t]}sendTo(t,e,n,r,o,i){var s;const{tabId:c,frameId:a=null}="object"==typeof t?t:{tabId:String(t)},u=null===(s=this._tabPorts[c])||void 0===s?void 0:s.filter((t=>null===a||void 0!==t.sender.frameId&&String(t.sender.frameId)===a));if(!u||!u.length)return void(o&&o({message:"no ports on specified destination"}));const l=i?u.filter((t=>i(t.sender&&t.sender.url))):u;if(!l.length)return void(o&&o({message:"no ports on specified tabFilter"}));const h={type:e,content:n};r&&"function"==typeof r&&(h.callid=Y(),this._callbacks[h.callid]=r),l.forEach((t=>t.postMessage(h)))}listen(t,e){this._messageHelper.listen(t,e)}}const No=ee.create("Messaging.extension-api.content");class Lo{constructor(t){this.kind="content-script-message-api",this._callbacks={},this._messageHelper=new Io,this._disconnected=!1,this.broadcastBackground=(...t)=>this._emit(this.backgroundPort,"bg").apply(null,t),this.broadcast=(...t)=>this._emit(this.broadcastPort,"tabs").apply(null,t),this._onPortMessage=t=>{No.trace("portMessage",t)},this._emit=(t,e)=>(n,r,o,i)=>{const s=Y();o&&"function"==typeof o&&(this._callbacks[s]=o);try{if(!t)throw new Error("lost connection to "+e+" port");t.postMessage({type:n,callid:s,content:r})}catch(t){if(!i)throw t;i(t)}},this._onBgPortMessage=({callid:t,content:e,type:n})=>{this._callbacks[t]?(this._callbacks[t](e),delete this._callbacks[t]):this._messageHelper.fire(n,e,(e=>{if(!this.backgroundPort)throw new Error("fail reply to bg page - connection lost");this.backgroundPort.postMessage({content:e,callid:t})}))},this.port=t(So),this.port.onMessage(this._onPortMessage),this.port.onDisconnect((()=>{this.port=null,this._onDisconnect()})),this.backgroundPort=t(Ao),this.backgroundPort.onMessage(this._onBgPortMessage),this.backgroundPort.onDisconnect((()=>{this.backgroundPort=null,this._onDisconnect()})),this.broadcastPort=t(Co),this.broadcastPort.onDisconnect((()=>{this.broadcastPort=null,this._onDisconnect()}))}onBackgroundPortReconnect(t){this.backgroundPort&&this.backgroundPort.onReconnect&&this.backgroundPort.onReconnect(t)}listen(t,e){this._messageHelper.listen(t,e)}toFocused(t,e){return Wn.create((n=>{if(!this.port)throw new Error("lost connection to bg page");this.port.postMessage({method:"message.toFocussed",params:{type:t,content:e}}),n()}))}_onDisconnect(){this._disconnected||(this._disconnected=!0,No.trace("Content script messaging went disconnected."),this._messageHelper.fire("contentScript-disconnected",null))}}class Uo{constructor(){this.kind="web-extension",this.executeScript=(t,e,n)=>Wn.create((r=>{chrome.tabs.executeScript(Number(e),{file:t,matchAboutBlank:!0,...n?{frameId:Number(n)}:{}}),r()}))}open(t,e){return Wn.create(((n,r)=>{chrome.tabs.create({url:t,active:e},(t=>{wo((()=>n(t)),r)}))}))}updateCurrent(t){return Wn.create(((e,n)=>{chrome.tabs.update({url:t},(t=>{wo((()=>e(t)),n)}))}))}getActiveTab(){return Wn.create(((t,e)=>{const n=chrome.tabs;n.query({active:!0,lastFocusedWindow:!0},(r=>{wo((()=>{r&&r.length?t(r[0]):n.query({active:!0},(n=>{wo((()=>{t(n[0])}),e)}))}),e)}))}))}getAllTabs(){return Wn.create(((t,e)=>chrome.tabs.query({},(n=>wo((()=>t(n)),e)))))}getActiveTabUrl(){return Wn.create(((t,e)=>this.getActiveTab().then((n=>wo((()=>t(n&&n.url)),e)))))}onActiveTabChange(t,e){const n=n=>{wo((()=>{n&&t(n)}),e)};chrome.tabs.onActivated.addListener((t=>chrome.tabs.get(t.tabId,(t=>n(t))))),chrome.tabs.onUpdated.addListener(((t,e)=>{this.getActiveTab().then((r=>{r&&r.id===t&&(e.url||e.favIconUrl||"complete"===e.status)&&chrome.tabs.get(t,(t=>n(t)))}))})),chrome.windows.onFocusChanged.addListener((t=>chrome.tabs.query({active:!0,windowId:t,lastFocusedWindow:!0},(t=>n(t[0]))))),this.getActiveTab().then((t=>n(t)))}tabUrlChange(){return new De((t=>{const e=(e,n,r)=>{"complete"===n.status&&t.next({id:e,url:r.url})};return chrome.tabs.onUpdated.addListener(e),()=>chrome.tabs.onUpdated.removeListener(e)}))}reload(t){return Wn.create(((e,n)=>{const r=()=>wo((()=>e()),n);t?chrome.tabs.reload(t,{},r):chrome.tabs.reload(r)}))}}const Fo=function(){this.__data__=[],this.size=0};const Do=function(t,e){return t===e||t!=t&&e!=e};const zo=function(t,e){for(var n=t.length;n--;)if(Do(t[n][0],e))return n;return-1};var Vo=Array.prototype.splice;const $o=function(t){var e=this.__data__,n=zo(e,t);return!(n<0)&&(n==e.length-1?e.pop():Vo.call(e,n,1),--this.size,!0)};const Bo=function(t){var e=this.__data__,n=zo(e,t);return n<0?void 0:e[n][1]};const Ho=function(t){return zo(this.__data__,t)>-1};const Go=function(t,e){var n=this.__data__,r=zo(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function qo(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}qo.prototype.clear=Fo,qo.prototype.delete=$o,qo.prototype.get=Bo,qo.prototype.has=Ho,qo.prototype.set=Go;const Zo=qo;const Wo=function(){this.__data__=new Zo,this.size=0};const Ko=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};const Yo=function(t){return this.__data__.get(t)};const Jo=function(t){return this.__data__.has(t)};const Xo=i.Z["__core-js_shared__"];var Qo,ti=(Qo=/[^.]+$/.exec(Xo&&Xo.keys&&Xo.keys.IE_PROTO||""))?"Symbol(src)_1."+Qo:"";const ei=function(t){return!!ti&&ti in t};var ni=Function.prototype.toString;const ri=function(t){if(null!=t){try{return ni.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var oi=/^\[object .+?Constructor\]$/,ii=Function.prototype,si=Object.prototype,ci=ii.toString,ai=si.hasOwnProperty,ui=RegExp("^"+ci.call(ai).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const li=function(t){return!(!z(t)||ei(t))&&(V(t)?ui:oi).test(ri(t))};const hi=function(t,e){return null==t?void 0:t[e]};const fi=function(t,e){var n=hi(t,e);return li(n)?n:void 0};const di=fi(i.Z,"Map");const pi=fi(Object,"create");const bi=function(){this.__data__=pi?pi(null):{},this.size=0};const gi=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e};var mi=Object.prototype.hasOwnProperty;const vi=function(t){var e=this.__data__;if(pi){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return mi.call(e,t)?e[t]:void 0};var yi=Object.prototype.hasOwnProperty;const _i=function(t){var e=this.__data__;return pi?void 0!==e[t]:yi.call(e,t)};const wi=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=pi&&void 0===e?"__lodash_hash_undefined__":e,this};function xi(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}xi.prototype.clear=bi,xi.prototype.delete=gi,xi.prototype.get=vi,xi.prototype.has=_i,xi.prototype.set=wi;const Ei=xi;const Si=function(){this.size=0,this.__data__={hash:new Ei,map:new(di||Zo),string:new Ei}};const Ai=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};const Ci=function(t,e){var n=t.__data__;return Ai(e)?n["string"==typeof e?"string":"hash"]:n.map};const ji=function(t){var e=Ci(this,t).delete(t);return this.size-=e?1:0,e};const Oi=function(t){return Ci(this,t).get(t)};const ki=function(t){return Ci(this,t).has(t)};const Ii=function(t,e){var n=Ci(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function Ti(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ti.prototype.clear=Si,Ti.prototype.delete=ji,Ti.prototype.get=Oi,Ti.prototype.has=ki,Ti.prototype.set=Ii;const Pi=Ti;const Mi=function(t,e){var n=this.__data__;if(n instanceof Zo){var r=n.__data__;if(!di||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Pi(r)}return n.set(t,e),this.size=n.size,this};function Ri(t){var e=this.__data__=new Zo(t);this.size=e.size}Ri.prototype.clear=Wo,Ri.prototype.delete=Ko,Ri.prototype.get=Yo,Ri.prototype.has=Jo,Ri.prototype.set=Mi;const Ni=Ri;const Li=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};const Ui=function(t){return this.__data__.has(t)};function Fi(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Pi;++e<n;)this.add(t[e])}Fi.prototype.add=Fi.prototype.push=Li,Fi.prototype.has=Ui;const Di=Fi;const zi=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1};const Vi=function(t,e){return t.has(e)};const $i=function(t,e,n,r,o,i){var s=1&n,c=t.length,a=e.length;if(c!=a&&!(s&&a>c))return!1;var u=i.get(t);if(u&&i.get(e))return u==e;var l=-1,h=!0,f=2&n?new Di:void 0;for(i.set(t,e),i.set(e,t);++l<c;){var d=t[l],p=e[l];if(r)var b=s?r(p,d,l,e,t,i):r(d,p,l,t,e,i);if(void 0!==b){if(b)continue;h=!1;break}if(f){if(!zi(e,(function(t,e){if(!Vi(f,e)&&(d===t||o(d,t,n,r,i)))return f.push(e)}))){h=!1;break}}else if(d!==p&&!o(d,p,n,r,i)){h=!1;break}}return i.delete(t),i.delete(e),h};const Bi=i.Z.Uint8Array;const Hi=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n};const Gi=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n};var qi=s?s.prototype:void 0,Zi=qi?qi.valueOf:void 0;const Wi=function(t,e,n,r,o,i,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new Bi(t),new Bi(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Do(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=Hi;case"[object Set]":var a=1&r;if(c||(c=Gi),t.size!=e.size&&!a)return!1;var u=s.get(t);if(u)return u==e;r|=2,s.set(t,e);var l=$i(c(t),c(e),r,o,i,s);return s.delete(t),l;case"[object Symbol]":if(Zi)return Zi.call(t)==Zi.call(e)}return!1};const Ki=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t};const Yi=function(t,e,n){var r=e(t);return x(t)?r:Ki(r,n(t))};const Ji=function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i};const Xi=function(){return[]};var Qi=Object.prototype.propertyIsEnumerable,ts=Object.getOwnPropertySymbols;const es=ts?function(t){return null==t?[]:(t=Object(t),Ji(ts(t),(function(e){return Qi.call(t,e)})))}:Xi;const ns=function(t){return Yi(t,B,es)};var rs=Object.prototype.hasOwnProperty;const os=function(t,e,n,r,o,i){var s=1&n,c=ns(t),a=c.length;if(a!=ns(e).length&&!s)return!1;for(var u=a;u--;){var l=c[u];if(!(s?l in e:rs.call(e,l)))return!1}var h=i.get(t);if(h&&i.get(e))return h==e;var f=!0;i.set(t,e),i.set(e,t);for(var d=s;++u<a;){var p=t[l=c[u]],b=e[l];if(r)var g=s?r(b,p,l,e,t,i):r(p,b,l,t,e,i);if(!(void 0===g?p===b||o(p,b,n,r,i):g)){f=!1;break}d||(d="constructor"==l)}if(f&&!d){var m=t.constructor,v=e.constructor;m==v||!("constructor"in t)||!("constructor"in e)||"function"==typeof m&&m instanceof m&&"function"==typeof v&&v instanceof v||(f=!1)}return i.delete(t),i.delete(e),f};const is=fi(i.Z,"DataView");const ss=fi(i.Z,"Promise");const cs=fi(i.Z,"Set");const as=fi(i.Z,"WeakMap");var us="[object Map]",ls="[object Promise]",hs="[object Set]",fs="[object WeakMap]",ds="[object DataView]",ps=ri(is),bs=ri(di),gs=ri(ss),ms=ri(cs),vs=ri(as),ys=b;(is&&ys(new is(new ArrayBuffer(1)))!=ds||di&&ys(new di)!=us||ss&&ys(ss.resolve())!=ls||cs&&ys(new cs)!=hs||as&&ys(new as)!=fs)&&(ys=function(t){var e=b(t),n="[object Object]"==e?t.constructor:void 0,r=n?ri(n):"";if(r)switch(r){case ps:return ds;case bs:return us;case gs:return ls;case ms:return hs;case vs:return fs}return e});const _s=ys;var ws="[object Arguments]",xs="[object Array]",Es="[object Object]",Ss=Object.prototype.hasOwnProperty;const As=function(t,e,n,r,o,i){var s=x(t),c=x(e),a=s?xs:_s(t),u=c?xs:_s(e),l=(a=a==ws?Es:a)==Es,h=(u=u==ws?Es:u)==Es,f=a==u;if(f&&(0,E.Z)(t)){if(!(0,E.Z)(e))return!1;s=!0,l=!1}if(f&&!l)return i||(i=new Ni),s||P(t)?$i(t,e,n,r,o,i):Wi(t,e,a,n,r,o,i);if(!(1&n)){var d=l&&Ss.call(t,"__wrapped__"),p=h&&Ss.call(e,"__wrapped__");if(d||p){var b=d?t.value():t,g=p?e.value():e;return i||(i=new Ni),o(b,g,n,r,i)}}return!!f&&(i||(i=new Ni),os(t,e,n,r,o,i))};const Cs=function t(e,n,r,o,i){return e===n||(null==e||null==n||!g(e)&&!g(n)?e!=e&&n!=n:As(e,n,r,o,t,i))};const js=function(t,e){return Cs(t,e)};var Os,ks;!function(t){t[t.nonEmptyMigration=0]="nonEmptyMigration",t[t.emptyMigration=1]="emptyMigration"}(Os||(Os={}));class Is{constructor(t,e,n,r=[]){this._name=t,this._source=e,this._destination=n,this._destValuesToKeep=r,this._migrationFlagSuccessfulValue="ok",this._migrationFlagUniqueKey="104ccd8c-9919-9ae4-931f-782fb197486c",this._migrationFlagKey=`__migration-${this._migrationFlagUniqueKey}:(${this._name})`,this._migrationInProgress=!1,this.migrationAwareDestination=function(t,e){const{get:n,set:r,getAll:o,remove:i}=Xt(t);return{get:n,set:r,getAll:o,remove:i,async removeAll(){const n=await t.getAll();await t.removeAll(),await Promise.all(Object.keys(n).filter(e).map((e=>t.set(e,n[e]))))}}}(this._destination,(t=>t===this._migrationFlagKey))}_getMigrated(){return this._destination.get(this._migrationFlagKey).then((t=>t===this._migrationFlagSuccessfulValue))}async _setMigrated(){await this._destination.set(this._migrationFlagKey,this._migrationFlagSuccessfulValue);const t=await this._destination.get(this._migrationFlagKey);if(t!==this._migrationFlagSuccessfulValue)throw new Error("Could not verify status write, actual value: "+t)}async _runMigration(){at(!this._migrationInProgress,"migration already in progress"),this._migrationInProgress=!0;try{const t=await this._source.getAll(),e=0===Object.keys(t).length;if(await Promise.all(this._destValuesToKeep.map((e=>this._destination.get(e).then((n=>{null!=n&&(t[e]=n)}))))),await this._destination.removeAll(),await Promise.all(Object.keys(t).filter((e=>null!=t[e])).map((e=>this._destination.set(e,t[e])))),!js(t,await this._destination.getAll()))throw new Error("Could not verify write");return this._migrationInProgress=!1,e?Os.emptyMigration:Os.nonEmptyMigration}catch(t){throw this._migrationInProgress=!1,t}}async ensureMigrationCompleted(){if(await this._getMigrated())return jo.alreadyMigrated;{const t=await this._runMigration();switch(await this._setMigrated(),t){case Os.nonEmptyMigration:return jo.success;case Os.emptyMigration:return jo.successWithEmpty;default:throw new Error("Match not exhaustive: "+t)}}}}!function(t){t.windowLocalStorage={get:t=>Wn.sync((()=>window.localStorage.getItem(t))),set:(t,e)=>Wn.sync((()=>window.localStorage.setItem(t,e))),getAll:()=>Wn.sync((()=>{const t={};return Object.keys(window.localStorage).forEach((e=>{t[e]=window.localStorage.getItem(e)})),t})),remove:t=>Wn.sync((()=>window.localStorage.removeItem(t))),removeAll:()=>Wn.sync((()=>window.localStorage.clear()))};t.MigrationAwarePreferencesApiImpl=class{constructor(e){this._firefox=e,this._migrationCompleted=Promise.resolve(!1),this._ensureMigrationCompletedCalled=!1,this.get=this._getMigrationAwareMethod("get"),this.set=this._getMigrationAwareMethod("set"),this.getAll=this._getMigrationAwareMethod("getAll"),this.remove=this._getMigrationAwareMethod("remove"),this.removeAll=this._getMigrationAwareMethod("removeAll"),this.browserStorageLocal={get:async t=>{const e=await this._firefox.storage.local.get(t);return e.hasOwnProperty(t)?e[t]:null},set:(t,e)=>this._firefox.storage.local.set({[t]:e}),getAll:()=>this._firefox.storage.local.get(null),remove:t=>this._firefox.storage.local.remove(t),removeAll:async()=>{await this._firefox.storage.local.clear()}},this._migration=new Is("firefoxLocalStorageToExtApi",t.windowLocalStorage,this.browserStorageLocal,["version"])}ensureMigrationCompleted(){this._ensureMigrationCompletedCalled=!0;const t=Wn.createCompletionSource();return this._migrationCompleted=t.promise,this._migration.ensureMigrationCompleted().then((e=>(t.resolve(!0),Promise.resolve(e))),(e=>(t.resolve(!1),Promise.reject(e))))}_getMigrationAwareMethod(e){return(...n)=>(at(!0===this._ensureMigrationCompletedCalled,"supposed to run data migration before accessing prefs with web-extensions API"),this._migrationCompleted.then((r=>(r?this._migration.migrationAwareDestination:t.windowLocalStorage)[e](...n))))}}}(ks||(ks={}));class Ts{constructor(t){this.port=chrome.runtime.connect({name:t})}onMessage(t){this.port.onMessage.addListener(t)}onDisconnect(t){this.port.onDisconnect.addListener(t)}postMessage(t){this.port.postMessage(t)}}class Ps{constructor(t){this._port=t,this.sender={};const{sender:e,name:n}=t;this.name=n,e&&(this.sender.url=e.url,this.sender.frameId=e.frameId,e.tab&&e.tab.url&&e.tab.id&&(this.sender.tab={url:e.tab.url,id:e.tab.id}))}onMessage(t){this._port.onMessage.addListener(t)}onDisconnect(t){this._port.onDisconnect.addListener(t)}postMessage(t){this._port.postMessage(t)}}class Ms{constructor(t){this.alarms=new _o,this.managedStorage=new Eo,this.tabs=new Uo,this.thirdPartyExtensionsInstalled={},this.notification={kind:"web-extension",create:t=>Wn.create(((e,n)=>{const r=chrome.notifications,o=Y();r.create(o,Object.assign({type:"basic"},t),(()=>{wo((()=>{const t=new De((t=>{const e=e=>e===o&&t.next(e);return r.onClicked.addListener(e),()=>r.onClicked.removeListener(e)})),n=new De((t=>{const e=(e,n)=>e===o&&t.next({id:e,buttonIndex:n});return r.onButtonClicked.addListener(e),()=>r.onButtonClicked.removeListener(e)})),i=new De((t=>{const e=(e,n)=>e===o&&t.next({id:e,byUser:n});return r.onClosed.addListener(e),()=>r.onClosed.removeListener(e)}));e({id:o,click:t,buttonClick:n,close:i})}),n)}))})),clear:t=>Wn.create(((e,n)=>{chrome.notifications.clear(t,(t=>{wo((()=>e(t)),n)}))}))},this.cookies={kind:"web-extension",get:t=>Wn.create(((e,n)=>chrome.cookies.get(t,(t=>wo((()=>e(t)),n))))),remove:t=>new Promise(((e,n)=>chrome.cookies.remove(t,(()=>wo((()=>e(null)),n))))),getAll:t=>Wn.create(((e,n)=>chrome.cookies.getAll(t,(t=>wo((()=>e(t)),n))))),set:t=>Wn.create(((e,n)=>chrome.cookies.set(t,(t=>wo((()=>e(t)),n))))),watch(t,e){chrome.cookies.onChanged.addListener((n=>{const{cookie:r,cause:o}=n;!r||!r.name||t.path&&t.path!==r.path||t.name!==r.name||t.domain&&-1===r.domain.indexOf(t.domain)||("explicit"===o&&e(r),"expired_overwrite"===o&&e())}))}},this.preferences=ks.windowLocalStorage,this.button={kind:"web-extension",setBadge(t){chrome.browserAction.setBadgeText({text:t})},setIconByName(t){const e="./src/icon/icon",n=t?"-"+t:"";chrome.browserAction.setIcon({path:{16:`${e}16${n}.png`,32:`${e}32${n}.png`}})},setBadgeBackgroundColor(t){chrome.browserAction.setBadgeBackgroundColor({color:t})}},this.management={uninstallSelf(){chrome.management.uninstallSelf()}},this._baseUrl=ot((()=>chrome.runtime.getURL("")),(t=>null)),this.permissions={watchAdded:t=>{chrome.permissions.onAdded.addListener(t)},watchRemoved:t=>{chrome.permissions.onRemoved.addListener(t)},getAll:t=>{chrome.permissions.getAll(t)}},this.fetchBlocklistConfig=()=>fetch(Pt().appConfig.url.pageConfigUrl,{credentials:"include"}).then((t=>t.ok?t.json():t.text().then((e=>{throw{name:"RequestError",body:e,statusCode:t.status,message:t.statusText}})))).then((t=>{if("string"!=typeof t&&t&&t.error)throw new Error(t.error);return t})),this.getUrl=t=>this._baseUrl?this._baseUrl+t:chrome.runtime.getURL(t),this.fetchInternalResource=(t,e)=>fetch(this.getUrl(t)).then((t=>"json"===e?t.json():t.arrayBuffer())),this.openUrl=t=>this.tabs.open(t,!0),this.openPopupSubscriptionDialog=t=>this.openUrl(go(t.utmSource,t.utmCampaign)),this.openSubscriptionDialog=t=>function(t){const e=Pt().appConfig.url,n=t.showPlanComparison?e.planComparison:e.upgrade;window.open(fo(n,[...t.isFromEmail?[uo("isFromEmail","1")]:[],uo("alerts",yo(mo(t.currentAlerts))),uo("lensedAlerts",yo(vo(t.currentAlerts))),uo("app_type","popup"),uo("browser",Pt().bundleInfo.browser),...bo({medium:"internal",source:t.isAnonymousUser?"signupHook":"upHook",campaign:t.forceUtmCampaign?t.forceUtmCampaign:t.isAnonymousUser?"extensionPremiumCta":"extensionGButton"})]))}(t),this.isExtensionUrl=(t,e)=>this.getUrl(t)===e,this.reload=()=>chrome.runtime.reload(),this.i18n={detectLanguage:t=>Wn.create(((e,n)=>chrome.i18n.detectLanguage(t,(t=>wo((()=>e(t)),n))))),getUILanguage:()=>chrome.i18n.getUILanguage(),getAcceptLanguages:()=>Wn.create(((t,e)=>chrome.i18n.getAcceptLanguages((n=>wo((()=>t(n)),e)))))},this.initCodeSplittingListener=()=>{return chrome.runtime.onMessage.addListener((t=this.tabs.executeScript,async(e,n,r)=>{e&&"CODE_SPLITTING_INJECT"===e.type&&e.file&&n&&n.tab&&null!=n.tab.id&&(await t(e.file,n.tab.id,n.tab.frameId),r())}));var t},this.isExtensionInstalled=async(t,e=!1)=>{if(!e&&void 0!==this.thirdPartyExtensionsInstalled[t])return this.thirdPartyExtensionsInstalled[t];if("undefined"==typeof fetch)return!1;const n=Ms.thirdPartyExtensionsData[t].publicResources.reduce(((e,n)=>(Mt()&&e.push(`chrome-extension://${Ms.thirdPartyExtensionsData[t].MSStoreId}${n}`),e.concat(`chrome-extension://${Ms.thirdPartyExtensionsData[t].id}${n}`))),[]);return(r=n.map((t=>fetch(t))),Kn(Promise.all([...r].map(Kn)))).then((t=>!0)).catch((t=>!1));var r},this.message=t?new Ro((t=>chrome.runtime.onConnect.addListener((e=>t(new Ps(e))))),Xt(this.tabs).getActiveTab,Xt(this.tabs).getAllTabs):new Lo((t=>new Ts(t)))}get baseUri(){var t;return null!==(t=this._baseUrl)&&void 0!==t?t:chrome.runtime.getURL("")}}Ms.thirdPartyExtensionsData={mseditor:{id:"gpaiobkfhnonedkhhfjpmhdalgeoebfa",MSStoreId:"hokifickgkhplphjiodbggjmoafhignh",publicResources:["/fonts/fabric-icons.css"]},office:{id:"ndjpnladcallmjemlbaebfadecfhkepb",MSStoreId:"gggmmkjegpiggikcnhidnjjhmicpibll",publicResources:["/fonts/fabric-icons.css"]}},io.start({browser:"chrome",browserApi:function(t){return new Ms(t)}(!1)})})()})();